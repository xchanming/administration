{"version":3,"file":"index-CkhzR-1m.js","sources":["../../../app/administration/src/app/component/modal/sw-image-preview-modal/sw-image-preview-modal.html.twig","../../../app/administration/src/app/component/modal/sw-image-preview-modal/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_image_preview_modal %}\n<transition\n    name=\"sw-image-preview-modal-fade\"\n    appear\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_image_preview_modal_element %}\n    <div class=\"sw-image-preview-modal\">\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_image_preview_modal_action %}\n        <div class=\"sw-image-preview-modal__action\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_image_preview_modal_button_zoom_out %}\n            <button\n                ref=\"btnZoomOut\"\n                class=\"sw-image-preview-modal__button-action\"\n                :class=\"buttonClass(isDisabledZoomOut)\"\n                :disabled=\"isDisabledZoomOut\"\n                @click=\"onClickZoomOut\"\n            >\n                <sw-icon name=\"regular-minus-circle\" />\n            </button>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_image_preview_modal_button_zoom_reset %}\n            <button\n                ref=\"btnReset\"\n                class=\"sw-image-preview-modal__button-action\"\n                :class=\"buttonClass(isDisabledReset)\"\n                :disabled=\"isDisabledReset\"\n                @click=\"onClickReset\"\n            >\n                <sw-icon name=\"regular-compress-arrows\" />\n            </button>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_image_preview_modal_button_zoom_in %}\n            <button\n                ref=\"btnZoomIn\"\n                class=\"sw-image-preview-modal__button-action\"\n                :class=\"buttonClass(isDisabledZoomIn)\"\n                :disabled=\"isDisabledZoomIn\"\n                @click=\"onClickZoomIn\"\n            >\n                <sw-icon name=\"regular-plus-circle\" />\n            </button>\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_image_preview_modal_button_close %}\n        <div\n            class=\"sw-image-preview-modal__button-close\"\n            role=\"button\"\n            tabindex=\"0\"\n            @click=\"onClickClose\"\n            @keydown.enter=\"onClickClose\"\n        >\n            <sw-icon name=\"regular-times\" />\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_image_preview_modal_image_slider %}\n        <sw-image-slider\n            class=\"sw-image-preview-modal__image-slider\"\n            overflow=\"hidden\"\n            navigation-type=\"arrow\"\n            arrow-style=\"outside\"\n            display-mode=\"contain\"\n            rewind\n            :images=\"images\"\n            :bordered=\"false\"\n            :rounded=\"false\"\n            :initial-index=\"activeItemIndex\"\n            @image-change=\"onImageSliderChange\"\n            @vue:mounted=\"afterComponentsMounted\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_image_preview_modal_divider %}\n        <hr\n            v-if=\"images.length > 1\"\n            class=\"sw-image-preview-modal__divider\"\n        >\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_image_preview_modal_thumbnail_slider %}\n        <sw-image-slider\n            v-if=\"images.length > 1\"\n            class=\"sw-image-preview-modal__thumbnail-slider\"\n            overflow=\"hidden\"\n            navigation-type=\"arrow\"\n            arrow-style=\"outside\"\n            display-mode=\"contain\"\n            rewind\n            :auto-width=\"images.length < itemPerPage\"\n            :bordered=\"false\"\n            :rounded=\"false\"\n            :initial-index=\"activeItemIndex\"\n            :images=\"images\"\n            :canvas-height=\"100\"\n            :item-per-page=\"itemPerPage\"\n            :element-padding=\"6\"\n            @image-change=\"onThumbnailSliderChange\"\n            @vue:mounted=\"afterComponentsMounted\"\n        />\n        {% endblock %}\n    </div>\n    {% endblock %}\n</transition>\n{% endblock %}\n","import template from './sw-image-preview-modal.html.twig';\nimport './sw-image-preview-modal.scss';\n\nconst { Component } = Cicada;\n/**\n * @package admin\n *\n * @private\n * @status ready\n * @example-type static\n * @component-example\n * <sw-image-preview-modal\n *     v-if=\"showImagePreviewModal\"\n *     :mediaItems=\"mediaItems\"\n *     :activeItem=\"activeItemIdId\"\n *     @modal-close=\"onCloseModal\">\n * </sw-image-preview-modal>\n */\nComponent.register('sw-image-preview-modal', {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    emits: ['modal-close'],\n\n    props: {\n        mediaItems: {\n            type: Array,\n            required: true,\n        },\n\n        activeItemId: {\n            type: String,\n            required: false,\n            default: '',\n        },\n\n        zoomSteps: {\n            type: Number,\n            required: false,\n            default: 5,\n        },\n\n        itemPerPage: {\n            type: Number,\n            required: false,\n            default: 10,\n        },\n    },\n\n    data() {\n        return {\n            activeItemIndex: 0,\n            image: null,\n            scale: 1,\n            isDisabledReset: true,\n            isDisabledZoomIn: true,\n            isDisabledZoomOut: true,\n            imageSliderMounted: false,\n        };\n    },\n\n    computed: {\n        images() {\n            return this.mediaItems.map((item) => {\n                if (item?.media?.url) {\n                    return {\n                        ...item.media,\n                        src: item.media.url,\n                    };\n                }\n\n                return item;\n            });\n        },\n\n        maxZoomValue() {\n            if (this.image) {\n                const { offsetWidth, offsetHeight, naturalWidth, naturalHeight } = this.image;\n                const value = Math.max(naturalWidth / offsetWidth, naturalHeight / offsetHeight);\n                return Number.isNaN(value) ? 1 : value;\n            }\n\n            return 1;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    updated() {\n        this.updatedComponent();\n    },\n\n    unmounted() {\n        this.destroyedComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            if (this.activeItemId) {\n                this.activeItemIndex = this.mediaItems.findIndex((item) => item.id === this.activeItemId);\n            }\n        },\n\n        afterComponentsMounted() {\n            if (this.imageSliderMounted) {\n                return;\n            }\n            this.imageSliderMounted = true;\n\n            document.querySelector('body').appendChild(this.$el);\n\n            this.$el.addEventListener('wheel', this.onMouseWheel);\n\n            this.getActiveImage().then(() => {\n                this.setActionButtonState();\n            });\n        },\n\n        updatedComponent() {\n            this.getActiveImage().then(() => {\n                this.setActionButtonState();\n            });\n        },\n\n        beforeDestroyComponent() {\n            if (this.$parent?.$el !== this.$el) {\n                // move DOM element back to vDOM parent so that Vue can remove the DOM entry on changes\n                this.$parent.$el.appendChild(this.$el);\n            } else {\n                this.$el.remove();\n            }\n        },\n\n        destroyedComponent() {\n            this.$el.removeEventListener('wheel', this.onMouseWheel);\n        },\n\n        buttonClass(isDisabled) {\n            return {\n                'is--disabled': isDisabled,\n            };\n        },\n\n        async getActiveImage() {\n            this.image = this.$el.querySelector(\n                '.sw-image-preview-modal__image-slider .sw-image-slider__element-image.is--active',\n            );\n\n            if (!this.image.complete) {\n                this.image = await this.loadImage(this.image);\n            }\n        },\n\n        loadImage(element) {\n            return new Promise((resolve, reject) => {\n                element.onload = () => resolve(element);\n                element.onerror = reject;\n            });\n        },\n\n        onClickClose() {\n            this.$emit('modal-close');\n        },\n\n        onClickZoomIn() {\n            const zoomAmount = this.maxZoomValue / this.zoomSteps;\n\n            this.scale = this.scale + zoomAmount > this.maxZoomValue ? this.maxZoomValue : this.scale + zoomAmount;\n            this.setTransition();\n            this.updateTransform();\n        },\n\n        onClickZoomOut() {\n            const zoomAmount = this.maxZoomValue / this.zoomSteps;\n\n            this.scale = this.scale - zoomAmount < 1 ? 1 : this.scale - zoomAmount;\n            this.setTransition();\n            this.updateTransform();\n        },\n\n        onClickReset() {\n            this.scale = 1;\n            this.updateTransform();\n        },\n\n        onImageSliderChange(index) {\n            this.activeItemIndex = index;\n            this.scale = 1;\n        },\n\n        onThumbnailSliderChange(index) {\n            this.activeItemIndex = index;\n            this.scale = 1;\n        },\n\n        setTransition() {\n            const transition = 'all 350ms ease 0s';\n            this.image.style.transition = transition;\n            this.image.style.WebkitTransition = transition;\n            this.image.style.msTransition = transition;\n        },\n\n        updateTransform() {\n            this.setActionButtonState();\n\n            const transform = `scale(${this.scale})`;\n            this.image.style.transform = transform;\n            this.image.style.WebkitTransform = transform;\n            this.image.style.msTransform = transform;\n        },\n\n        setActionButtonState() {\n            if (this.scale === 1 && this.maxZoomValue === 1) {\n                this.isDisabledReset = true;\n                this.isDisabledZoomIn = true;\n                this.isDisabledZoomOut = true;\n            } else if (this.maxZoomValue <= this.scale) {\n                this.isDisabledReset = false;\n                this.isDisabledZoomIn = true;\n                this.isDisabledZoomOut = false;\n            } else if (this.scale === 1) {\n                this.isDisabledReset = true;\n                this.isDisabledZoomIn = false;\n                this.isDisabledZoomOut = true;\n            } else {\n                this.isDisabledReset = false;\n                this.isDisabledZoomIn = false;\n                this.isDisabledZoomOut = false;\n            }\n        },\n\n        onMouseWheel(event) {\n            const zoomAmount = event.wheelDelta / 960;\n\n            if (this.scale + zoomAmount > this.maxZoomValue) {\n                this.scale = this.maxZoomValue;\n            } else if (this.scale + zoomAmount < 1) {\n                this.scale = 1;\n            } else {\n                this.scale += zoomAmount;\n            }\n\n            this.setTransition();\n            this.updateTransform();\n        },\n    },\n});\n"],"names":["template","Component","item","_a","offsetWidth","offsetHeight","naturalWidth","naturalHeight","value","isDisabled","element","resolve","reject","zoomAmount","index","transition","transform","event"],"mappings":"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"}