{"version":3,"file":"index-BRIJZK3j.js","sources":["../../../app/administration/src/module/sw-mail-template/component/sw-mail-header-footer-list/sw-mail-header-footer-list.html.twig","../../../app/administration/src/module/sw-mail-template/component/sw-mail-header-footer-list/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_mail_header_footer_list_grid %}\n<sw-card\n    :title=\"$tc('sw-mail-header-footer.list.textMailHeaderFooterOverview')\"\n    position-identifier=\"sw-mail-header-footer-list\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_mail_header_footer_list_grid_empty_state %}\n    <sw-empty-state\n        v-if=\"!isLoading && !showListing\"\n        :title=\"$tc('sw-mail-header-footer.list.emptyStateTitle')\"\n        :subline=\"$tc('sw-mail-header-footer.list.emptyStateSubTitle')\"\n        :absolute=\"false\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_mail_header_footer_list_grid_empty_state_icon %}\n        <template #icon>\n            <img\n                :src=\"assetFilter('/administration/static/img/empty-states/settings-empty-state.svg')\"\n                :alt=\"$tc('sw-mail-header-footer.list.emptyStateTitle')\"\n            >\n        </template>\n        {% endblock %}\n\n    </sw-empty-state>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_mail_template_list_grid %}\n    <template #grid>\n        <sw-entity-listing\n            v-if=\"isLoading || showListing\"\n            id=\"mailHeaderFooterGrid\"\n            ref=\"listing\"\n            class=\"sw-mail-templates-list-grid\"\n            detail-route=\"sw.mail.template.detail_head_foot\"\n            identifier=\"sw-mail-header-footer-list\"\n            :items=\"mailHeaderFooters\"\n            :columns=\"getListColumns()\"\n            :repository=\"mailHeaderFooterRepository\"\n            :full-page=\"false\"\n            :is-loading=\"isLoading\"\n            :allow-view=\"acl.can('mail_templates.viewer')\"\n            :allow-edit=\"acl.can('mail_templates.editor')\"\n            :allow-delete=\"acl.can('mail_templates.deleter')\"\n            :show-selection=\"acl.can('mail_templates.deleter') || undefined\"\n            :skeleton-item-amount=\"skeletonItemAmount\"\n            @update-records=\"updateRecords\"\n        >\n            <template #column-salesChannels.name=\"{ item }\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_mail_template_list_columns_sales_channels_label %}\n                {{ getSalesChannelsString(item) }}\n                {% endblock %}\n            </template>\n\n            <template #bulk-modal-delete-items>\n                <sw-button\n                    variant=\"danger\"\n                    size=\"small\"\n                    @click=\"onMultipleDelete\"\n                >\n                    {{ $tc('global.default.delete') }}\n                </sw-button>\n            </template>\n\n            <template #delete-modal-delete-item=\"{ item }\">\n                <sw-button\n                    variant=\"danger\"\n                    size=\"small\"\n                    @click=\"onDelete(item)\"\n                >\n                    {{ $tc('global.default.delete') }}\n                </sw-button>\n            </template>\n\n            <template #more-actions=\"{ item }\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_mail_header_footer_list_grid_columns_actions_duplicate %}\n                <sw-context-menu-item\n                    class=\"sw-mail-header-footer-list-grid__duplicate-action\"\n                    :disabled=\"!acl.can('mail_templates.creator') || undefined\"\n                    @click=\"onDuplicate(item.id)\"\n                >\n                    {{ $tc('sw-mail-header-footer.list.contextMenuDuplicate') }}\n                </sw-context-menu-item>\n                {% endblock %}\n            </template>\n        </sw-entity-listing>\n    </template>\n    {% endblock %}\n\n</sw-card>\n{% endblock %}\n","import template from './sw-mail-header-footer-list.html.twig';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @package buyers-experience\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('listing'),\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        searchTerm: {\n            type: String,\n            required: false,\n            default: '',\n        },\n    },\n\n    data() {\n        return {\n            mailHeaderFooters: null,\n            showDeleteModal: null,\n            isLoading: false,\n        };\n    },\n\n    computed: {\n        mailHeaderFooterRepository() {\n            return this.repositoryFactory.create('mail_header_footer');\n        },\n\n        skeletonItemAmount() {\n            return this.mailHeaderFooters && this.mailHeaderFooters.length !== 0 ? this.mailHeaderFooters.length : 3;\n        },\n\n        showListing() {\n            return !!this.mailHeaderFooters && this.mailHeaderFooters.length !== 0;\n        },\n\n        assetFilter() {\n            return Cicada.Filter.getByName('asset');\n        },\n    },\n\n    watch: {\n        searchTerm() {\n            this.getList();\n        },\n    },\n\n    methods: {\n        onEdit(mailHeaderFooter) {\n            if (mailHeaderFooter?.id) {\n                this.$router.push({\n                    name: 'sw.mail.template.detail_head_foot',\n                    params: {\n                        id: mailHeaderFooter.id,\n                    },\n                });\n            }\n        },\n\n        getList() {\n            this.isLoading = true;\n\n            const criteria = new Criteria(this.page, this.limit);\n            criteria.addAssociation('salesChannels').addSorting(Criteria.sort('name'));\n\n            if (this.searchTerm) {\n                criteria.setTerm(this.searchTerm);\n            }\n\n            this.mailHeaderFooterRepository.search(criteria).then((items) => {\n                this.total = items.total;\n                this.mailHeaderFooters = items;\n                this.isLoading = false;\n\n                return this.mailHeaderFooters;\n            });\n        },\n\n        getListColumns() {\n            return [\n                {\n                    property: 'name',\n                    dataIndex: 'name',\n                    label: 'sw-mail-header-footer.list.columnName',\n                    allowResize: true,\n                    routerLink: 'sw.mail.template.detail_head_foot',\n                    primary: true,\n                },\n                {\n                    property: 'description',\n                    dataIndex: 'description',\n                    label: 'sw-mail-header-footer.list.columnDescription',\n                    allowResize: true,\n                },\n                {\n                    property: 'salesChannels.name',\n                    dataIndex: 'salesChannels.name',\n                    label: 'sw-mail-header-footer.list.columnSalesChannels',\n                    allowResize: true,\n                    sortable: false,\n                },\n            ];\n        },\n\n        getSalesChannelsString(item) {\n            if (typeof item.salesChannels === 'undefined') {\n                return '';\n            }\n            let salesChannels = '';\n\n            item.salesChannels.forEach((salesChannel) => {\n                if (salesChannels !== '') {\n                    salesChannels += ', ';\n                }\n                salesChannels += `${salesChannel.translated.name}`;\n            });\n\n            if (item.salesChannels.length >= 5) {\n                salesChannels += '...';\n            }\n\n            return salesChannels;\n        },\n\n        onDuplicate(id) {\n            this.mailHeaderFooterRepository.clone(id).then((mailHeaderFooter) => {\n                this.$router.push({\n                    name: 'sw.mail.template.detail_head_foot',\n                    params: { id: mailHeaderFooter.id },\n                });\n            });\n        },\n\n        checkCanBeDeleted(mailHeaderFooter) {\n            return !mailHeaderFooter.salesChannels.length;\n        },\n\n        onDelete(item) {\n            this.$refs.listing.deleteId = null;\n\n            if (!this.checkCanBeDeleted(item)) {\n                this.showDeleteErrorNotification(item);\n            }\n\n            return this.mailHeaderFooterRepository.delete(item.id).then(() => {\n                this.$refs.listing.resetSelection();\n                this.$refs.listing.doSearch();\n            });\n        },\n\n        getMailHeaderFooterCriteria(mailHeaderFooter) {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addFilter(Criteria.equalsAny('id', mailHeaderFooter));\n\n            criteria.addAssociation('salesChannels');\n\n            return criteria;\n        },\n\n        onMultipleDelete() {\n            const selectedMailHeaderFooters = Object.values(this.$refs.listing.selection).map((currentProxy) => {\n                return currentProxy.id;\n            });\n\n            this.mailHeaderFooterRepository\n                .search(this.getMailHeaderFooterCriteria(selectedMailHeaderFooters))\n                .then((response) => {\n                    response.forEach((mailHeaderFooter) => {\n                        if (!this.checkCanBeDeleted(mailHeaderFooter)) {\n                            this.showDeleteErrorNotification(mailHeaderFooter);\n                        }\n                    });\n\n                    this.$refs.listing.deleteItems();\n                });\n        },\n\n        showDeleteErrorNotification(item) {\n            return this.createNotificationError({\n                message: this.$tc('sw-mail-header-footer.list.messageDeleteError', 0, { name: item.name }),\n            });\n        },\n\n        updateRecords(result) {\n            this.mailHeaderFooters = result;\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","index","mailHeaderFooter","criteria","items","item","salesChannels","salesChannel","id","selectedMailHeaderFooters","currentProxy","response","result"],"mappings":"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"}