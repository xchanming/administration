{"version":3,"file":"index-BwMca_Dx.js","sources":["../../../app/administration/src/module/sw-product/component/sw-product-variants/sw-product-modal-variant-generation/sw-product-modal-variant-generation.html.twig","../../../app/administration/node_modules/events/events.js","../../../app/administration/src/module/sw-product/helper/sw-products-variants-generator.js","../../../app/administration/src/module/sw-product/component/sw-product-variants/sw-product-modal-variant-generation/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_product_modal_variant_generation %}\n<sw-modal\n    v-if=\"!showUploadModal\"\n    :title=\"$tc('sw-product.variations.configuratorModal.title')\"\n    class=\"sw-product-modal-variant-generation\"\n    @modal-close=\"$emit('modal-close')\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_modal_variant_generation_sidebar %}\n    <div class=\"sw-product-modal-variant-generation__sidebar\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_sidebar_tabs %}\n        <sw-tabs\n            is-vertical\n            position-identifier=\"sw-product-modal-variant-generation\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_modal_variant_generation_sidebar_tabs_items %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_modal_variant_generation_sidebar_tabs_item_options %}\n            <sw-tabs-item\n                class=\"sw-variant-modal__option-selection\"\n                :active=\"activeTab == 'options'\"\n                @click=\"activeTab = 'options'\"\n            >\n                {{ $tc('sw-product.variations.configuratorModal.selectOptions') }}\n            </sw-tabs-item>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_modal_variant_generation_sidebar_tabs_item_prices %}\n            <sw-tabs-item\n                v-show=\"variantsNumber\"\n                class=\"sw-variant-modal__surcharge-configuration\"\n                :active=\"activeTab == 'prices'\"\n                @click=\"activeTab = 'prices'\"\n            >\n                {{ $tc('sw-product.variations.configuratorModal.priceSurcharges') }}\n            </sw-tabs-item>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_modal_variant_generation_sidebar_tabs_item_restrictions %}\n            <sw-tabs-item\n                v-show=\"variantsNumber\"\n                class=\"sw-variant-modal__restriction-configuration\"\n                :active=\"activeTab == 'restrictions'\"\n                @click=\"activeTab = 'restrictions'\"\n            >\n                {{ $tc('sw-product.variations.configuratorModal.defineRestrictions') }}\n            </sw-tabs-item>\n            {% endblock %}\n\n            {% endblock %}\n        </sw-tabs>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_sidebar_descriptions %}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_sidebar_descriptions_options %}\n        <div v-if=\"activeTab == 'options'\">\n            <p>{{ $tc('sw-product.variations.configuratorModal.selectOptionsExplanation') }}</p>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_modal_variant_generation_sidebar_add_only_selected %}\n            <sw-switch-field\n                v-model:value=\"isAddOnly\"\n                :label=\"$tc('sw-product.variations.configuratorModal.addVariantsOnly')\"\n            />\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_sidebar_descriptions_restrictions %}\n        <p v-else-if=\"activeTab == 'restrictions'\">\n            {{ $tc('sw-product.variations.configuratorModal.selectRestrictionsExplanation') }}\n        </p>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_sidebar_descriptions_prices %}\n        <p v-else-if=\"activeTab == 'prices'\">\n            {{ $tc('sw-product.variations.configuratorModal.selectPricesExplanation') }}\n        </p>\n        {% endblock %}\n        {% endblock %}\n\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_modal_variant_generation_main %}\n    <div class=\"sw-product-modal-variant-generation__main\">\n        {# @deprecated tag:v6.7.0 - The property :disabled will be removed, use isAddOnly instead #}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_main_configurator_selection %}\n        <sw-product-variants-configurator-selection\n            v-show=\"activeTab == 'options'\"\n            :product=\"product\"\n            :options=\"product.configuratorSettings\"\n            :overlay=\"false\"\n            :collapsible=\"false\"\n            :disabled=\"isAddOnly\"\n            :is-add-only=\"isAddOnly\"\n            @variations-finish-generate=\"$emit('variations-finish-generate')\"\n            @option-select=\"calcVariantsNumber()\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_main_configurator_prices %}\n        <sw-product-variants-configurator-prices\n            v-if=\"activeTab == 'prices'\"\n            :product=\"product\"\n            :selected-groups=\"selectedGroups\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_main_configurator_restrictions %}\n        <sw-product-variants-configurator-restrictions\n            v-if=\"activeTab == 'restrictions'\"\n            :product=\"product\"\n            :selected-groups=\"selectedGroups\"\n        />\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_modal_variant_generation_footer %}\n    <template #modal-footer>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_footer_cancel %}\n        <sw-button\n            size=\"small\"\n            @click=\"onModalCancel\"\n        >\n            {{ $tc('global.default.cancel') }}\n        </sw-button>\n        {% endblock %}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_modal_variant_generation_footer_generate %}\n        <sw-button\n            class=\"sw-product-variant-generation__next-action\"\n            variant=\"primary\"\n            size=\"small\"\n            @click=\"showNextStep\"\n        >\n            {{ $tc('sw-product.variations.nextModalButton') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n</sw-modal>\n\n<sw-modal\n    v-else\n    :title=\"$tc('sw-product.variations.configuratorModal.title')\"\n    class=\"sw-product-modal-variant-generation sw-product-modal-variant-generation__upload_files\"\n    @modal-close=\"$emit('modal-close')\"\n>\n    <div class=\"sw-product-modal-variant-generation__infoBox\">\n        {{ $tc('sw-product.variations.configuratorModal.uploadInfoBoxHeader') }}\n        <div class=\"sw-product-modal-variant-generation__infoBoxContent\">\n            <span class=\"sw-product-modal-variant-generation__variant-amount\">\n                {{ $tc('sw-product.variations.configuratorModal.uploadInfoBoxCount', variantGenerationQueue.createQueue.length, { count: variantGenerationQueue.createQueue.length }) }}\n            </span>\n            {{ $tc('sw-product.variations.configuratorModal.uploadInfoBoxCreateLabel', variantGenerationQueue.createQueue.length, { count: variantGenerationQueue.createQueue.length }) }}\n\n            <span class=\"sw-product-modal-variant-generation__variant-amount\">\n                {{ $tc('sw-product.variations.configuratorModal.uploadInfoBoxCount', variantGenerationQueue.deleteQueue.length, { count: variantGenerationQueue.deleteQueue.length }) }}\n            </span>\n            {{ $tc('sw-product.variations.configuratorModal.uploadInfoBoxDeleteLabel', variantGenerationQueue.deleteQueue.length, { count: variantGenerationQueue.deleteQueue.length }) }}\n        </div>\n    </div>\n\n    <template v-if=\"variantGenerationQueue.createQueue.length > 0\">\n        <div class=\"sw-product-modal-variant-generation__upload-card\">\n            <div class=\"sw-product-modal-variant-generation__card-title\">\n                {{ $tc('sw-product.variations.configuratorModal.uploadCardDescription') }}\n            </div>\n\n            <div class=\"sw-product-modal-variant-generation__upload-all-container\">\n                <sw-switch-field\n                    :label=\"$tc('sw-product.variations.configuratorModal.digitalVariantSwitch')\"\n                    @update:value=\"onChangeAllVariantValues\"\n                />\n                <div class=\"sw-product-modal-variant-generation__upload-all\">\n                    <sw-upload-listener\n                        upload-tag=\"upload_all\"\n                        auto-upload\n                        @media-upload-finish=\"successfulUpload\"\n                    />\n                    <sw-media-compact-upload-v2\n                        v-if=\"productDownloadFolderId\"\n                        :button-label=\"$tc('sw-product.variations.configuratorModal.uploadAllButton')\"\n                        :remove-button-label=\"$tc('sw-product.variations.configuratorModal.removeAllButton')\"\n                        upload-tag=\"upload_all\"\n                        private-filesystem\n                        :source-multiselect=\"downloadFilesForAllVariants.length > 0 ? downloadFilesForAllVariants : null\"\n                        allow-multi-select\n                        add-files-on-multiselect\n                        :target-folder-id=\"productDownloadFolderId\"\n                        file-accept=\"*/*\"\n                        @delete-item=\"(file) => removeFileForAllVariants(file)\"\n                    />\n                </div>\n            </div>\n\n            <div class=\"sw-product-modal-variant-generation__toolbar\">\n                <sw-card-filter\n                    :placeholder=\"$tc('sw-product.variations.configuratorModal.uploadCardSearchPlaceholder')\"\n                    @sw-card-filter-term-change=\"onTermChange\"\n                />\n            </div>\n\n            <sw-data-grid\n                class=\"sw-product-modal-variant-generation__grid\"\n                :data-source=\"paginatedVariantArray\"\n                :show-selection=\"false\"\n                :show-header=\"false\"\n                :show-actions=\"false\"\n                :compact-mode=\"false\"\n                :plain-appearance=\"true\"\n                :columns=\"[\n                    { property: 'options', label: 'Optionen' },\n                ]\"\n            >\n                <template #column-options=\"{ item }\">\n                    <div>\n                        <template\n                            v-for=\"(option, index) in item.options\"\n                            :key=\"index\"\n                        >\n                            <span\n                                v-if=\"option.entity\"\n                            >\n                                {{ option.entity.group.translated?.name || option.entity.group.name }}:\n                                {{ option.entity.translated?.name || option.entity.name }}\n                                <template v-if=\"index != Object.keys(item.options).length - 1\">|</template>\n                            </span>\n                        </template>\n                    </div>\n\n                    <div\n                        :key=\"item.id\"\n                        class=\"sw-data-grid__item\"\n                    >\n                        <sw-switch-field\n                            label=\"Digital\"\n                            :value=\"item.productStates.includes('is-download')\"\n                            @update:value=\"(event) => onChangeVariantValue(event, item)\"\n                        />\n                        <sw-upload-listener\n                            :upload-tag=\"item.productNumber\"\n                            auto-upload\n                            @media-upload-finish=\"(event) => successfulUpload(event, item)\"\n                        />\n                        <sw-media-compact-upload-v2\n                            v-if=\"productDownloadFolderId\"\n                            :upload-tag=\"item.productNumber\"\n                            :disabled=\"item.productStates.length === 0\"\n                            private-filesystem\n                            allow-multi-select\n                            add-files-on-multiselect\n                            :source-multiselect=\"item.downloads.length > 0 ? item.downloads : null\"\n                            :target-folder-id=\"productDownloadFolderId\"\n                            file-accept=\"*/*\"\n                            @delete-item=\"(file) => removeFile(`${file.fileName}.${file.fileExtension}`, item)\"\n                        />\n                    </div>\n                </template>\n\n                <template #pagination>\n                    <sw-pagination\n                        :page=\"page\"\n                        :limit=\"limit\"\n                        :total=\"total\"\n                        :total-visible=\"7\"\n                        @page-change=\"handlePageChange\"\n                    />\n                </template>\n            </sw-data-grid>\n        </div>\n    </template>\n\n    <template #modal-footer>\n        <sw-button\n            size=\"small\"\n            @click=\"showUploadModal = false\"\n        >\n            {{ $tc('sw-product.variations.backVariationsButton') }}\n        </sw-button>\n\n        <sw-button\n            :disabled=\"isGenerateButtonDisabled\"\n            class=\"sw-product-variant-generation__generate-action\"\n            :variant=\"buttonVariant\"\n            size=\"small\"\n            @click=\"generateVariants()\"\n        >\n            {{ buttonLabel }}\n        </sw-button>\n    </template>\n\n    <template #modal-loader>\n        <transition name=\"generate-variant-progress-bar-transition\">\n            <div\n                v-if=\"isLoading\"\n                class=\"generate-variant-progress-bar__wrapper\"\n            >\n                <sw-progress-bar\n                    class=\"generate-variant-progress-bar\"\n                    :value=\"progressInPercentage\"\n                />\n\n                <span class=\"generate-variant-progress-bar__description\">\n                    {{ actualProgress }} {{ $tc('sw-product.variations.progressTypeOf') }} {{ maxProgress }} {{ $tc('sw-product.variations.progressTypeVariation') }} {{ progressMessage }}\n                </span>\n            </div>\n        </transition>\n    </template>\n</sw-modal>\n{% endblock %}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/*\n * @package inventory\n */\n\nimport EventEmitter from 'events';\nimport RetryHelper from '../../../core/helper/retry.helper';\n\nconst { deepCopyObject } = Cicada.Utils.object;\nconst { md5 } = Cicada.Utils.format;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default class VariantsGenerator extends EventEmitter {\n    constructor() {\n        super();\n\n        this.product = null;\n        this.productIds = [];\n\n        // set dependencies\n        this.syncService = Cicada.Service('syncService');\n        this.cacheService = Cicada.Service('cacheApiService');\n        this.httpClient = this.syncService.httpClient;\n\n        // local data\n        this.languageId = null;\n    }\n\n    /*\n     * Saves the variants to the database via sync api.\n     */\n    saveVariants(queues) {\n        return new Promise((resolveDelete) => {\n            // notify view to refresh progress\n            this.emit('progress-max', {\n                type: 'delete',\n                progress: queues.deleteQueue.length,\n            });\n\n            // create mapping for api call\n            const mapped = queues.deleteQueue.map((id) => {\n                return { id };\n            });\n\n            // send api calls for delete\n            this.processQueue('delete', mapped, 0, 10, resolveDelete);\n        })\n            .then(() => {\n                // notify view to refresh progress\n                this.emit('progress-max', {\n                    type: 'upsert',\n                    progress: queues.createQueue.length,\n                });\n\n                return new Promise((resolve) => {\n                    // send api calls for create\n                    this.processQueue('upsert', queues.createQueue, 0, 10, resolve);\n                });\n            })\n            .then(() => {\n                this.indexProducts(this.productIds);\n            });\n    }\n\n    generateVariants(currencies, product, isAddOnly = false) {\n        this.product = product;\n        const configuratorSettings = this.product.configuratorSettings;\n\n        // This check is done to set a default value for completely new generated variants\n        // without changing existing configuration\n        if (\n            !this.product.variantListingConfig ||\n            (!this.product.variantListingConfig.displayParent &&\n                !this.product.variantListingConfig.configuratorGroupConfig &&\n                !this.product.variantListingConfig.mainVariantId)\n        ) {\n            this.product.variantListingConfig = {};\n            this.product.variantListingConfig.displayParent = true;\n        }\n\n        return new Promise(() => {\n            const grouped = this.groupTheOptions(configuratorSettings);\n\n            // When nothing is selected\n            if (grouped.length <= 0) {\n                this.loadExisting(this.product.id).then((variantsOnServer) => {\n                    const deleteArray = Object.keys(variantsOnServer).map((id) => {\n                        return id;\n                    });\n                    this.emit('queues', {\n                        createQueue: [],\n                        deleteQueue: isAddOnly ? [] : deleteArray,\n                    });\n                });\n                return;\n            }\n\n            // create permutations of variants\n            const permutations = this.buildCombinations(grouped);\n\n            this.loadExisting(this.product.id)\n                .then((variantsOnServer) => {\n                    // filter deletable and creatable variations\n                    return this.filterVariations(permutations, variantsOnServer, currencies, isAddOnly);\n                })\n                .then((queues) => {\n                    this.emit('queues', queues);\n                });\n        });\n    }\n\n    filterVariations(newVariations, variationOnServer, currencies, isAddOnly = false) {\n        const configuratorSettings = this.product.configuratorSettings;\n\n        return new Promise((resolve) => {\n            const createQueue = [];\n\n            /*\n             * {\n             *      hash1: variantId\n             *      hash2: variantId2\n             *      hash3: variantId..\n             * }\n             *\n             */\n            const hashed = {};\n            const numbers = {};\n            const numberMap = {};\n\n            // eslint-disable-next-line\n            for (const [\n                key,\n                variant,\n            ] of Object.entries(variationOnServer)) {\n                const hash = md5(JSON.stringify(variant.options.sort()));\n                hashed[hash] = key;\n                numberMap[hash] = variant.productNumber;\n                numbers[variant.productNumber] = true;\n            }\n\n            let deleteQueue = [];\n            if (!isAddOnly) {\n                // Copy the hashed list with the sorted variations on the server.\n                deleteQueue = deepCopyObject(hashed);\n            }\n\n            const newVariationsSorted = newVariations.map((variation) => variation.sort());\n\n            // Get price changes for all option ids\n            const priceChanges = configuratorSettings.reduce((result, element) => {\n                result.push({\n                    id: element.option.id,\n                    price: element.price,\n                });\n\n                return result;\n            }, []);\n\n            // notify page that the generation starts now\n            this.emit('progress-max', {\n                type: 'calc',\n                progress: newVariationsSorted.length,\n            });\n\n            let increment = 1;\n\n            // Check if the new variation exists on the server.\n            newVariationsSorted.forEach((variation) => {\n                const hash = md5(JSON.stringify(variation));\n                const exist = hashed[hash];\n\n                /*\n                When the variation exists on the server and in the user selection,\n                then remove it from the delete queue. Otherwise create a new variation\n                 */\n                if (exist !== undefined) {\n                    delete deleteQueue[hash];\n                }\n            });\n\n            Object.keys(deleteQueue).forEach((hash) => {\n                delete numbers[numberMap[hash]];\n            });\n\n            // Check if the new variation exists on the server.\n            newVariationsSorted.forEach((variation) => {\n                const hash = md5(JSON.stringify(variation));\n                const exist = hashed[hash];\n\n                // handled in above loop\n                if (exist !== undefined) {\n                    return;\n                }\n\n                const variations = variation.map((optionId) => {\n                    return { id: optionId };\n                });\n\n                // new variation price\n                let variationPrice = {};\n\n                // Go through each option and add price changes to main price of variation\n                variations\n                    .map((variationObject) => variationObject.id)\n                    .forEach((variationId) => {\n                        priceChanges.forEach((option) => {\n                            if (!option.price) {\n                                return;\n                            }\n\n                            if (option.id !== variationId) {\n                                return;\n                            }\n\n                            // iterate through each currency\n                            option.price.forEach((price) => {\n                                const currencyId = price.currencyId;\n\n                                let refCurrencyPrice;\n\n                                if (variationPrice[currencyId]) {\n                                    refCurrencyPrice = variationPrice[currencyId];\n                                } else {\n                                    // get parent price for currency\n                                    refCurrencyPrice = this.product.price.find((productPrice) => {\n                                        return productPrice.currencyId === price.currencyId;\n                                    });\n                                }\n\n                                let refPrice = refCurrencyPrice;\n\n                                // use the default price as fallback when no custom price for the currency exists\n                                if (!refCurrencyPrice) {\n                                    const defaultCurrency = currencies.find((currency) => {\n                                        return currency.isSystemDefault;\n                                    });\n\n                                    const defaultCurrencyPrice = this.product.price.find((productPrice) => {\n                                        return productPrice.currencyId === defaultCurrency.id;\n                                    });\n\n                                    const actualCurrency = currencies.find((currency) => {\n                                        return currency.id === price.currencyId;\n                                    });\n\n                                    // recalculate price for currency with conversion factor\n                                    refPrice = {\n                                        net: defaultCurrencyPrice.net * actualCurrency.factor,\n                                        gross: defaultCurrencyPrice.gross * actualCurrency.factor,\n                                    };\n                                }\n\n                                // calculate new price with surcharge\n                                const grossPrice = refPrice.gross + price.gross;\n                                const netPrice = refPrice.net + price.net;\n\n                                // push new currency price with surcharges to variation price\n                                variationPrice[currencyId] = {\n                                    currencyId: price.currencyId,\n                                    gross: grossPrice,\n                                    linked: price.linked,\n                                    net: netPrice,\n                                };\n                            });\n                        });\n                    });\n\n                // get generated number and increment\n                const generated = this.createNumber(this.product.productNumber, increment, numbers);\n                increment = generated.increment;\n\n                // create new variant product\n                const variantObject = {\n                    parentId: this.product.id,\n                    options: variations,\n                    stock: 0,\n                    productNumber: generated.number,\n                };\n\n                variationPrice = Object.values(variationPrice);\n\n                // when variant has custom price then add it to price\n                if (variationPrice.length > 0) {\n                    variantObject.price = variationPrice;\n                }\n\n                // Add to create list\n                createQueue.push(variantObject);\n            });\n\n            // create an array with only the values\n            deleteQueue = Object.values(deleteQueue);\n\n            // filter the create queue with the new restrictions\n            const filteredCreateQueue = this.filterRestrictions(createQueue);\n\n            // return the delete and create queue\n            resolve({ deleteQueue, createQueue: filteredCreateQueue });\n        });\n    }\n\n    createNumber(prefix, increment, numbers) {\n        let exists = true;\n        let number = null;\n\n        // check for the first unused number\n        while (exists) {\n            number = `${prefix}.${increment}`;\n            exists = numbers.hasOwnProperty(number);\n            increment += 1;\n        }\n\n        return { number, increment };\n    }\n\n    filterRestrictions(createQueue) {\n        const variantRestriction = this.product.variantRestrictions || [];\n\n        // Filter to get an array with only the restrictions ids with the single option ids\n        const restrictionsOnly = variantRestriction.map((restriction) => {\n            return restriction.values.map((value) => {\n                return value.options;\n            });\n        });\n\n        // Return the normal create queue when the user does not create restrictions\n        if (restrictionsOnly.length <= 0) {\n            return createQueue;\n        }\n\n        /**\n         * Go through the whole createQueue and check for each variation,\n         * if the option combination matches one of the restrictions\n         */\n        return createQueue.filter((newVariation) => {\n            const variations = newVariation.options.map((variation) => variation.id);\n\n            return restrictionsOnly.reduce((result, restriction) => {\n                const hasRestriction = restriction.reduce((exists, restrictionArray) => {\n                    const restrictionExist = restrictionArray.find((optionId) => {\n                        return variations.indexOf(optionId) >= 0;\n                    });\n\n                    return restrictionExist ? exists : false;\n                }, true);\n\n                return hasRestriction ? false : result;\n            }, true);\n        });\n    }\n\n    loadExisting(id) {\n        // Return all existing variations from the server\n        return this.httpClient\n            .get(`/_action/product/${id}/combinations`, {\n                headers: this.syncService.getBasicHeaders(),\n            })\n            .then((response) => {\n                return response.data;\n            });\n    }\n\n    groupTheOptions(configurators) {\n        // get all selected group id with the selected options\n        //\n        // {\n        //     groupId: [optionId, optionId, ...],\n        //     groupId: [optionId, optionId, ...],\n        //     ...\n        // }\n\n        const groupedData = configurators.reduce((accumulator, configurator) => {\n            const groupId = configurator.option.groupId;\n            const grouped = accumulator[groupId];\n\n            if (grouped) {\n                grouped.push(configurator.option.id);\n                return accumulator;\n            }\n\n            accumulator[groupId] = [configurator.option.id];\n\n            return accumulator;\n        }, {});\n\n        // Return only the grouped options\n        return Object.values(groupedData);\n    }\n\n    buildCombinations(data, group = [], value = null, index = 0) {\n        // Recursion which build the permutation of all options (sorted in groups)\n        const all = [];\n\n        if (value !== null) {\n            group.push(value);\n        }\n\n        if (index >= data.length) {\n            all.push(group);\n            return all;\n        }\n\n        data[index].forEach((entryValue) => {\n            const nested = this.buildCombinations(data, group.slice(), entryValue, index + 1);\n\n            nested.forEach((nestedItem) => {\n                all.push(nestedItem);\n            });\n        });\n\n        return all;\n    }\n\n    processQueue(type, queue, offset, limit, resolve) {\n        // Create a chunk\n        const chunk = queue.slice(offset, offset + limit);\n        if (chunk.length <= 0) {\n            resolve();\n            return;\n        }\n\n        // Emit the progress to the view\n        this.emit('progress-actual', { type: type, progress: offset });\n\n        const payload = [\n            {\n                action: type,\n                entity: 'product',\n                payload: chunk,\n            },\n        ];\n\n        // Send the payload to the server\n        const header = { 'single-operation': 1 };\n\n        RetryHelper.retry(() => {\n            return this.syncService.sync(payload, { 'indexing-behavior': 'disable-indexing' }, header);\n        }).then((response) => {\n            this.productIds.concat(response.data?.product ?? []).concat(response.data?.deleted?.product ?? []);\n            this.processQueue(type, queue, offset + limit, limit, resolve);\n        });\n    }\n\n    indexProducts(productIds) {\n        if (productIds.length <= 0) {\n            return;\n        }\n\n        this.cacheService.indexProducts(productIds);\n    }\n}\n","/*\n * @package inventory\n */\n\nimport template from './sw-product-modal-variant-generation.html.twig';\nimport VariantsGenerator from '../../../helper/sw-products-variants-generator';\nimport './sw-product-modal-variant-generation.scss';\n\nconst { Criteria } = Cicada.Data;\nconst { Mixin, Context } = Cicada;\nconst { mapState } = Cicada.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'mediaService',\n        'swProductDetailLoadAll',\n    ],\n\n    emits: [\n        'modal-close',\n        'variations-finish-generate',\n    ],\n\n    mixins: [\n        Mixin.getByName('listing'),\n    ],\n\n    props: {\n        product: {\n            type: Object,\n            required: true,\n        },\n\n        groups: {\n            type: Array,\n            required: true,\n        },\n\n        selectedGroups: {\n            type: Array,\n            required: true,\n        },\n\n        actualStatus: {\n            type: String,\n            default: 'is-physical',\n            required: false,\n        },\n    },\n\n    data() {\n        return {\n            activeTab: 'options',\n            isLoading: false,\n            actualProgress: 0,\n            maxProgress: 0,\n            progressType: '',\n            variantsNumber: 0,\n            variantsGenerator: null,\n            showUploadModal: false,\n            variantGenerationQueue: { createQueue: [], deleteQueue: [] },\n            term: '',\n            paginatedVariantArray: [],\n            disableRouteParams: true,\n            downloadFilesForAllVariants: [],\n            usageOfFiles: {},\n            idToIndex: {},\n            productDownloadFolderId: null,\n            isAddOnly: false,\n            originalConfiguratorSettings: [],\n        };\n    },\n\n    computed: {\n        ...mapState('swProductDetail', [\n            'currencies',\n        ]),\n\n        productRepository() {\n            return this.repositoryFactory.create('product');\n        },\n\n        optionRepository() {\n            return this.repositoryFactory.create('property_group_option');\n        },\n\n        mediaRepository() {\n            return this.repositoryFactory.create('media');\n        },\n\n        progressInPercentage() {\n            return this.actualProgress / (this.maxProgress * 100);\n        },\n\n        progressMessage() {\n            if (this.progressType === 'delete') {\n                return this.$tc('sw-product.variations.progressTypeDeleted');\n            }\n            if (this.progressType === 'upsert') {\n                return this.$tc('sw-product.variations.progressTypeGenerated');\n            }\n            if (this.progressType === 'calc') {\n                return this.$tc('sw-product.variations.progressTypeCalculated');\n            }\n            return '';\n        },\n\n        buttonVariant() {\n            if (this.variantsNumber <= 0) {\n                return 'danger';\n            }\n            return 'primary';\n        },\n\n        buttonLabel() {\n            if (this.variantsNumber <= 0) {\n                return this.$tc('sw-product.variations.deleteVariationsButton');\n            }\n\n            return this.$tc('sw-product.variations.generateVariationsButton');\n        },\n\n        isGenerateButtonDisabled() {\n            return this.variantGenerationQueue.createQueue.some((item) => {\n                return item.downloads.length === 0 && item.productStates?.includes('is-download');\n            });\n        },\n    },\n\n    watch: {\n        variantGenerationQueue() {\n            this.getList();\n            this.showUploadModal = true;\n        },\n\n        isAddOnly() {\n            if (this.isAddOnly) {\n                this.emptyConfiguratorSettings();\n                return;\n            }\n\n            this.addOriginalConfiguratorSettings();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.mediaService.getDefaultFolderId('product_download').then((folderId) => {\n                this.productDownloadFolderId = folderId;\n            });\n\n            this.variantsGenerator = new VariantsGenerator();\n            this.term = '';\n\n            this.variantsGenerator.on('queues', (queues) => {\n                const optionIdsToSearch = this.product.configuratorSettings.reduce((result, element) => {\n                    if (result.indexOf(element.option.id) < 0) {\n                        result.push(element.option.id);\n                    }\n\n                    return result;\n                }, []);\n\n                if (optionIdsToSearch.length > 0) {\n                    const criteria = new Criteria(1, 500);\n                    criteria.addFilter(Criteria.equalsAny('id', optionIdsToSearch));\n                    criteria.addAssociation('group');\n\n                    this.optionRepository.search(criteria).then((options) => {\n                        queues.createQueue.forEach((item, index) => {\n                            item.options.forEach((option) => {\n                                option.entity = options.get(option.id);\n                            });\n\n                            item.options.sort((firstOption, secondOption) => {\n                                const firstGroupName = firstOption.entity.group.name;\n                                const secondGroupName = secondOption.entity.group.name;\n\n                                return firstGroupName.localeCompare(secondGroupName);\n                            });\n\n                            item.downloads = [];\n                            item.productStates = [];\n                            item.id = item.productNumber;\n                            this.idToIndex[item.id] = index;\n                        });\n\n                        this.variantGenerationQueue = queues;\n                        this.total = queues.createQueue.length;\n                    });\n                } else {\n                    this.variantGenerationQueue = queues;\n                    this.total = queues.createQueue.length;\n                }\n                this.isLoading = false;\n            });\n\n            this.variantsGenerator.on('progress-max', (maxProgress) => {\n                this.maxProgress = maxProgress.progress;\n                this.progressType = maxProgress.type;\n            });\n\n            this.variantsGenerator.on('progress-actual', (actualProgress) => {\n                this.actualProgress = actualProgress.progress;\n                this.progressType = actualProgress.type;\n            });\n        },\n\n        /**\n         *\n         * @param fileName string must include filename and its extension: \"example.png\"\n         * @param variant\n         */\n        removeFile(fileName, variant) {\n            // keep all downloadable files expect the one that should be removed\n            variant.downloads = variant.downloads.filter(\n                (download) => `${download.fileName}.${download.fileExtension}` !== fileName,\n            );\n\n            // check if file is used in another place\n            this.usageOfFiles[fileName] = this.usageOfFiles[fileName].filter((id) => id !== variant.id);\n            if (this.usageOfFiles[fileName].length === 0) {\n                delete this.usageOfFiles[fileName];\n            }\n            const fileUsedElsewhere = this.usageOfFiles[fileName];\n\n            if (!fileUsedElsewhere) {\n                // removes file from the array, so it won't be shown inside the top upload component\n                this.downloadFilesForAllVariants = this.downloadFilesForAllVariants.filter(\n                    (download) => `${download.fileName}.${download.fileExtension}` !== fileName,\n                );\n            }\n        },\n\n        removeFileForAllVariants(file) {\n            const fileName = `${file.fileName}.${file.fileExtension}`;\n            const usage = this.usageOfFiles[fileName];\n\n            if (usage) {\n                usage.forEach((use) => {\n                    const index = this.idToIndex[use];\n                    const variant = this.variantGenerationQueue.createQueue[index];\n                    variant.downloads = variant.downloads.filter(\n                        (download) => `${download.fileName}.${download.fileExtension}` !== fileName,\n                    );\n                });\n                delete this.usageOfFiles[fileName];\n            }\n\n            this.downloadFilesForAllVariants = this.downloadFilesForAllVariants.filter(\n                (download) => download.id !== file.id,\n            );\n        },\n\n        getList() {\n            if (!this.variantGenerationQueue) {\n                this.paginatedVariantArray = [];\n\n                return;\n            }\n\n            const filteredQueue = [];\n            this.variantGenerationQueue.createQueue.forEach((item) => {\n                item.options.some((option) => {\n                    const name = option.entity.translated?.name || option.entity.name;\n                    if (name.toUpperCase().includes(this.term.toUpperCase()) || this.term === '') {\n                        filteredQueue.push(item);\n                        return true;\n                    }\n\n                    return false;\n                });\n            });\n\n            const start = this.page * this.limit - this.limit;\n            const end = start + this.limit;\n            this.total = filteredQueue.length;\n            this.paginatedVariantArray = filteredQueue.slice(start, end);\n        },\n\n        handlePageChange(opts) {\n            this.onPageChange(opts);\n            this.getList();\n        },\n\n        generateVariants() {\n            this.isLoading = true;\n\n            this.variantGenerationQueue.createQueue.forEach((item) => {\n                delete item.id;\n\n                if (item.productStates.includes('is-download')) {\n                    item.maxPurchase = 1;\n                    item.minPurchase = 1;\n                    item.isCloseout = false;\n                    item.shippingFree = false;\n                }\n\n                const mediaIds = [];\n                item.downloads.forEach((download) => {\n                    mediaIds.push({ mediaId: download.id });\n                });\n\n                item.downloads = mediaIds;\n            });\n\n            this.variantsGenerator\n                .saveVariants(this.variantGenerationQueue)\n                .then(() => {\n                    this.addOriginalConfiguratorSettings();\n                    return this.productRepository.save(this.product);\n                })\n                .then(() => {\n                    this.$emit('variations-finish-generate');\n                    this.$emit('modal-close');\n                    this.isLoading = false;\n                    this.actualProgress = 0;\n                    this.maxProgress = 0;\n\n                    this.swProductDetailLoadAll();\n                });\n        },\n\n        showNextStep() {\n            this.isLoading = true;\n            this.variantsGenerator.generateVariants(this.currencies, this.product, this.isAddOnly);\n            this.isLoading = false;\n        },\n\n        calcVariantsNumber() {\n            // Group all option ids\n            const groupedData = this.product.configuratorSettings.reduce((accumulator, element) => {\n                const groupId = element.option.groupId;\n                const grouped = accumulator[groupId];\n\n                if (grouped) {\n                    grouped.push(element.option.id);\n                    return accumulator;\n                }\n\n                accumulator[groupId] = [element.option.id];\n                return accumulator;\n            }, {});\n\n            // Get only the values\n            const groupedDataValues = Object.values(groupedData);\n\n            // Multiply each group options when options are selected\n            this.variantsNumber =\n                groupedDataValues.length > 0\n                    ? groupedDataValues.map((group) => group.length).reduce((curr, length) => curr * length)\n                    : 0;\n        },\n\n        onChangeAllVariantValues(checked) {\n            let variants = this.variantGenerationQueue.createQueue;\n            if (this.term) {\n                variants = this.paginatedVariantArray;\n            }\n\n            if (!checked) {\n                this.usageOfFiles = {};\n                variants.forEach((item) => {\n                    item.downloads = [];\n                    item.productStates = [];\n                });\n                this.getList();\n                return;\n            }\n\n            variants.forEach((item) => {\n                item.downloads = [...this.downloadFilesForAllVariants];\n                this.updateUsageForAllVariantFiles(item.id);\n\n                item.productStates = ['is-download'];\n            });\n\n            this.getList();\n        },\n\n        onChangeVariantValue(checked, item) {\n            if (!checked) {\n                Object.keys(this.usageOfFiles).forEach((key) => {\n                    this.usageOfFiles[key] = this.usageOfFiles[key].filter((id) => id !== item.id);\n                    if (this.usageOfFiles[key].length === 0) {\n                        delete this.usageOfFiles[key];\n                        this.downloadFilesForAllVariants = this.downloadFilesForAllVariants.filter(\n                            (download) => `${download.fileName}.${download.fileExtension}` !== key,\n                        );\n                    }\n                });\n\n                item.downloads = [];\n                item.productStates = [];\n                return;\n            }\n\n            item.downloads = [...this.downloadFilesForAllVariants];\n            this.updateUsageForAllVariantFiles(item.id);\n\n            item.productStates = ['is-download'];\n        },\n\n        isUploadDisabled(item) {\n            return item.downloads.length === 0;\n        },\n\n        isExistingMedia(files, targetId) {\n            return files.some(({ id }) => {\n                return id === targetId;\n            });\n        },\n\n        successfulUpload(event, item) {\n            this.mediaRepository.get(event.targetId, Context.api).then((media) => {\n                if (item) {\n                    if (this.isExistingMedia(item.downloads, event.targetId)) {\n                        return;\n                    }\n\n                    item.downloads.push(media);\n                    this.pushFileToUsageList(`${media.fileName}.${media.fileExtension}`, item.id);\n                    return;\n                }\n\n                if (!this.isExistingMedia(this.downloadFilesForAllVariants, event.targetId)) {\n                    this.downloadFilesForAllVariants.push(media);\n                }\n\n                let variants = this.variantGenerationQueue.createQueue;\n                if (this.term) {\n                    variants = this.paginatedVariantArray;\n                }\n\n                variants.forEach((currentItem) => {\n                    if (currentItem.productStates.includes('is-download')) {\n                        if (this.isExistingMedia(currentItem.downloads, event.targetId)) {\n                            return;\n                        }\n\n                        currentItem.downloads.push(media);\n\n                        this.pushFileToUsageList(`${media.fileName}.${media.fileExtension}`, currentItem.id);\n                    }\n                });\n            });\n        },\n\n        updateUsageForAllVariantFiles(id) {\n            this.downloadFilesForAllVariants.forEach((download) => {\n                this.pushFileToUsageList(`${download.fileName}.${download.fileExtension}`, id);\n            });\n        },\n\n        pushFileToUsageList(fileName, id) {\n            if (!this.usageOfFiles[fileName]) {\n                this.usageOfFiles[fileName] = [];\n            }\n            this.usageOfFiles[fileName].push(id);\n        },\n\n        onModalCancel() {\n            this.addOriginalConfiguratorSettings();\n            this.$emit('modal-close');\n        },\n\n        addOriginalConfiguratorSettings() {\n            this.removeDuplicateEntries();\n            this.originalConfiguratorSettings.forEach((configSetting) => {\n                this.product.configuratorSettings.add(configSetting);\n            });\n\n            this.calcVariantsNumber();\n        },\n\n        emptyConfiguratorSettings() {\n            this.originalConfiguratorSettings = [];\n            this.product.configuratorSettings.getIds().forEach((id) => {\n                this.originalConfiguratorSettings.push(this.product.configuratorSettings.get(id));\n                this.product.configuratorSettings.remove(id);\n            });\n\n            this.calcVariantsNumber();\n        },\n\n        onTermChange(term) {\n            this.term = term;\n            this.getList();\n        },\n\n        removeDuplicateEntries() {\n            const that = this;\n            this.product.configuratorSettings.getIds().forEach((configSettingId) => {\n                const configSetting = that.product.configuratorSettings.get(configSettingId);\n\n                if (\n                    this.originalConfiguratorSettings.find((setting) => {\n                        return setting.optionId === configSetting.optionId;\n                    }) !== undefined\n                ) {\n                    that.product.configuratorSettings.remove(configSettingId);\n                }\n            });\n        },\n    },\n};\n"],"names":["template","R","ReflectApply","target","receiver","args","ReflectOwnKeys","ProcessEmitWarning","warning","NumberIsNaN","value","EventEmitter","eventsModule","once","defaultMaxListeners","checkListener","listener","arg","n","_getMaxListeners","that","type","i","doError","events","er","err","handler","len","listeners","arrayClone","_addListener","prepend","m","existing","w","onceWrapper","_onceWrap","state","wrapped","list","position","originalListener","spliceOne","keys","key","_listeners","unwrap","evlistener","unwrapListeners","emitter","listenerCount","arr","copy","index","ret","name","resolve","reject","errorListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","flags","wrapListener","deepCopyObject","md5","VariantsGenerator","queues","resolveDelete","mapped","id","currencies","product","isAddOnly","configuratorSettings","grouped","variantsOnServer","deleteArray","permutations","newVariations","variationOnServer","createQueue","hashed","numbers","numberMap","variant","hash","deleteQueue","newVariationsSorted","variation","priceChanges","result","element","increment","variations","optionId","variationPrice","variationObject","variationId","option","price","currencyId","refCurrencyPrice","productPrice","refPrice","defaultCurrency","currency","defaultCurrencyPrice","actualCurrency","grossPrice","netPrice","generated","variantObject","filteredCreateQueue","prefix","exists","number","restrictionsOnly","restriction","newVariation","restrictionArray","response","configurators","groupedData","accumulator","configurator","groupId","data","group","all","entryValue","nestedItem","queue","offset","limit","chunk","payload","header","RetryHelper","_a","_c","_b","productIds","Criteria","Mixin","Context","mapState","item","folderId","optionIdsToSearch","criteria","options","firstOption","secondOption","firstGroupName","secondGroupName","maxProgress","actualProgress","fileName","download","file","usage","use","filteredQueue","start","end","opts","mediaIds","groupedDataValues","curr","length","checked","variants","files","targetId","event","media","currentItem","configSetting","term","configSettingId","setting"],"mappings":"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","x_google_ignoreList":[1]}