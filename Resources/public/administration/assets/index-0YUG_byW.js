const s=`{% block sw_product_stream_grid_preview_content %} <div class="sw-product-stream-grid-preview"> {% block sw_product_stream_grid_preview_search_field_label %} <div class="sw-product-stream-grid-preview__toolbar"> {% block sw_product_stream_grid_preview_search_field %} <sw-simple-search-field v-model:value="searchTerm" size="small" variant="form" :delay="750" :disabled="!filters" class="sw-product-stream-grid-preview__search-field" @search-term-change="onSearchTermChange" /> {% endblock %} </div> {% endblock %} {% block sw_product_stream_grid_preview_grid %} <sw-data-grid v-if="total" class="sw-product-stream-grid-preview__grid" :data-source="products" :columns="productColumns" :show-selection="showSelection" :show-actions="false" :show-previews="true" :plain-appearance="true" :is-loading="isLoading" @selection-change="onSelectionChange" > {% block sw_product_stream_grid_preview_grid_columns %} <template #column-name="{ item, column }"> {% block sw_product_stream_grid_preview_grid_column_name %} <router-link v-if="column.routerLink" :to="{ name: column.routerLink, params: { id: item.id } }" > <sw-product-variant-info :variations="item.variation"> {{ item.name || item.translated.name }} </sw-product-variant-info> </router-link> <sw-product-variant-info v-else :variations="item.variation" > {{ item.name || item.translated.name }} </sw-product-variant-info> {% endblock %} </template> <template #column-manufacturer.name="{ item, column }"> {% block sw_product_stream_grid_preview_grid_column_manufacturer %} <router-link v-if="column.routerLink && item.manufacturerId" :to="{ name: column.routerLink, params: { id: item.manufacturerId } }" > {{ item.manufacturer.name || item.manufacturer.translated.name }} </router-link> <template v-else-if="item.manufacturerId"> {{ item.manufacturer.name || item.manufacturer.translated.name }} </template> {% endblock %} </template> <template #column-active="{ item }"> {% block sw_product_stream_grid_preview_grid_column_active %} <sw-data-grid-column-boolean :value="item.active" :is-inline-edit="false" /> {% endblock %} </template> <template #column-price="{ item }"> {% block sw_product_stream_grid_preview_grid_column_price %} {{ currencyFilter(getPriceForDefaultCurrency(item), systemCurrency.isoCode) }} {% endblock %} </template> <template #column-stock="{ item }"> {% block sw_product_stream_grid_preview_grid_column_stock %} {{ item.stock }} {% endblock %} </template> {% endblock %} <slot name="additional-columns"></slot> <template #pagination> {% block sw_product_stream_grid_preview_grid_pagination %} <sw-pagination v-bind="{ total, page, limit }" :total-visible="7" :auto-hide="false" @page-change="onPageChange" /> {% endblock %} </template> </sw-data-grid> {% endblock %} {% block sw_product_stream_grid_preview_empty_state %} <slot name="empty-state"> <sw-empty-state v-if="!total && !isLoading" :title="emptyStateMessage" :absolute="false" auto-height :show-description="false" > <template #icon> <img :src="assetFilter('/administration/static/img/empty-states/products-empty-state.svg')" alt="" > </template> </sw-empty-state> </slot> {% endblock %} </div> {% endblock %}`,{Component:o,Context:i,Defaults:c}=Cicada,{Criteria:t}=Cicada.Data;o.register("sw-product-stream-grid-preview",{template:s,compatConfig:Cicada.compatConfig,inject:["repositoryFactory","productStreamPreviewService"],emits:["selection-change"],props:{filters:{required:!0},columns:{required:!1,type:Array,default(){return[]}},criteria:{required:!1,type:Object,default(){return new t(1,10)}},showSelection:{required:!1,type:Boolean,default:!1}},data(){return{products:[],systemCurrency:null,searchTerm:"",page:1,total:0,limit:10,isLoading:!1}},computed:{productRepository(){return this.repositoryFactory.create("product")},currencyRepository(){return this.repositoryFactory.create("currency")},salesChannelRepository(){return this.repositoryFactory.create("sales_channel")},salesChannelCriteria(){return new t(1,1).addFilter(t.not("OR",[t.equals("typeId",c.productComparisonTypeId)])).addSorting(t.sort("type.iconName","ASC"))},defaultColumns(){return[{property:"name",label:this.$tc("sw-product-stream.filter.values.product"),type:"text",routerLink:"sw.product.detail"},{property:"manufacturer.name",label:this.$tc("sw-product-stream.filter.values.manufacturer")},{property:"active",label:this.$tc("sw-product-stream.filter.values.active"),align:"center",type:"bool"},{property:"price",label:this.$tc("sw-product-stream.filter.values.price")},{property:"stock",label:this.$tc("sw-product-stream.filter.values.stock"),align:"right"}]},productColumns(){return this.columns.length?this.columns:this.defaultColumns},emptyStateMessage(){return this.filters?this.searchTerm.length?this.$tc("global.entity-components.productStreamPreview.emptyMessageNoSearchResults",this.searchTerm,{term:this.searchTerm}):this.$tc("global.entity-components.productStreamPreview.emptyMessageNoProducts"):this.$tc("global.entity-components.productStreamPreview.emptyMessageNoStream")},assetFilter(){return Cicada.Filter.getByName("asset")},currencyFilter(){return Cicada.Filter.getByName("currency")}},watch:{async filters(e){if(!e){this.total=0;return}this.isLoading=!0,this.systemCurrency=await this.loadSystemDefaultCurrency(),this.loadProducts()}},created(){this.createdComponent()},methods:{onSearchTermChange(e){this.searchTerm=e,this.page=1,this.loadProducts()},async createdComponent(){this.filters&&(this.isLoading=!0,this.systemCurrency=await this.loadSystemDefaultCurrency(),this.loadProducts())},loadSystemDefaultCurrency(){return this.currencyRepository.get(i.app.systemCurrencyId,i.api)},loadProducts(){return this.criteria.term=this.searchTerm||null,this.criteria.filters=[...this.filters],this.criteria.limit=this.limit,this.criteria.setPage(this.page),this.criteria.addAssociation("manufacturer"),this.criteria.addAssociation("options.group"),this.criteria.addGroupField("displayGroup"),this.criteria.addFilter(t.not("AND",[t.equals("displayGroup",null)])),this.salesChannelRepository.searchIds(this.salesChannelCriteria).then(({data:e})=>this.productStreamPreviewService.preview(e.at(0),this.criteria,[],{"sw-currency-id":i.app.systemCurrencyId,"sw-inheritance":!0})).then(e=>{this.products=Object.values(e.elements),this.total=e.total,this.isLoading=!1})},onPageChange({page:e=1,limit:r=25}){this.page=e,this.limit=r,this.isLoading=!0,this.loadProducts()},getPriceForDefaultCurrency(e){const r=e.price.find(a=>a.currencyId===this.systemCurrency.id);return r?r.gross:"-"},onSelectionChange(e){this.$emit("selection-change",e)}}});
//# sourceMappingURL=index-0YUG_byW.js.map
