{"version":3,"file":"index-BhldFCeG.js","sources":["../../../app/administration/src/module/sw-settings-tax/component/sw-settings-tax-rule-modal/sw-settings-tax-rule-modal.html.twig","../../../app/administration/src/module/sw-settings-tax/component/sw-settings-tax-rule-modal/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_tax_rule_modal %}\n<sw-modal\n    :title=\"$tc('sw-settings-tax.taxRuleCard.labelCountryName')\"\n    class=\"sw-settings-tax-rule-modal__settings-modal\"\n    @modal-close=\"$emit('modal-close')\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_tax_rule_modal_form_first_row %}\n    <sw-container\n        columns=\"1fr 1fr\"\n        gap=\"0px 32px\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_country_select %}\n        <sw-entity-single-select\n            v-model:value=\"taxRule.countryId\"\n            show-clearable-button\n            required\n            :label=\"$tc('sw-settings-tax.taxRuleCard.labelCountryName')\"\n            :help-text=\"$tc('sw-settings-tax.taxRuleCard.tooltipCountries')\"\n            :error=\"taxRuleCountryIdError\"\n            :criteria=\"countryCriteria\"\n            entity=\"country\"\n        />\n        {% endblock %}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_type_select %}\n        <sw-entity-single-select\n            v-model:value=\"taxRule.taxRuleTypeId\"\n            show-clearable-button\n            required\n            :label=\"$tc('sw-settings-tax.taxRuleCard.labelAppliesOn')\"\n            label-property=\"typeName\"\n            :error=\"taxRuleTaxRuleTypeIdError\"\n            :criteria=\"taxRuleTypeCriteria\"\n            entity=\"tax_rule_type\"\n            @update:value=\"changeRuleType\"\n        />\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_tax_rule_modal_form_second_row %}\n    <sw-container\n        columns=\"1fr 1fr\"\n        gap=\"0 32px\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_additional_component %}\n        <component\n            :is=\"additionalComponent\"\n            v-if=\"additionalComponent\"\n            :tax-rule=\"taxRule\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_tax_rate %}\n        <sw-number-field\n            v-model:value=\"taxRule.taxRate\"\n            required\n            :digits=\"3\"\n            :error=\"taxRuleTaxRateError\"\n            :label=\"$tc('sw-settings-tax.taxRuleCard.labelTaxRate')\"\n        >\n            <template #suffix>\n                <span>\n                    <span v-html=\"$sanitize($tc('sw-settings-tax.general.taxRateSymbol'))\"></span>\n                </span>\n            </template>\n        </sw-number-field>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_tax_active_from %}\n        <sw-datepicker\n            v-model:value=\"taxRule.activeFrom\"\n            date-type=\"datetime\"\n            :error=\"taxRuleActiveFromError\"\n            :label=\"$tc('sw-settings-tax.taxRuleCard.labelActiveFrom')\"\n            :placeholder=\"$tc('sw-datepicker.datetime.placeholder')\"\n        />\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_tax_rule_modal_form_footer %}\n    <template #modal-footer>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_form_footer_cancel %}\n        <sw-button\n            size=\"small\"\n            @click=\"$emit('modal-close')\"\n        >\n            {{ $tc('global.default.cancel') }}\n        </sw-button>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_tax_rule_modal_form_footer_button_create %}\n        <sw-button\n            variant=\"primary\"\n            size=\"small\"\n            @click=\"onConfirm\"\n        >\n            {{ $tc('sw-settings-tax.detail.buttonSave') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n","import template from './sw-settings-tax-rule-modal.html.twig';\n\n/**\n * @package checkout\n */\n\nconst { Context } = Cicada;\nconst { Criteria } = Cicada.Data;\nconst { mapPropertyErrors } = Cicada.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'feature',\n    ],\n\n    emits: ['modal-close'],\n\n    props: {\n        tax: {\n            type: Object,\n            required: true,\n        },\n        currentRule: {\n            type: Object,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            showModal: false,\n            taxRule: null,\n            currentTaxRuleType: null,\n        };\n    },\n\n    computed: {\n        taxRuleRepository() {\n            return this.repositoryFactory.create('tax_rule');\n        },\n        taxRuleTypeRepository() {\n            return this.repositoryFactory.create('tax_rule_type');\n        },\n        additionalComponent() {\n            if (!this.currentTaxRuleType) {\n                return null;\n            }\n\n            const subComponentName = this.currentTaxRuleType.technicalName.replace(/_/g, '-');\n            return `sw-settings-tax-rule-type-${subComponentName}`;\n        },\n        taxRuleTypeCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('position', 'ASC'));\n\n            return criteria;\n        },\n        countryCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('name', 'ASC', false));\n\n            return criteria;\n        },\n\n        ...mapPropertyErrors('taxRule', [\n            'taxRuleTypeId',\n            'countryId',\n            'taxRate',\n            'activeFrom',\n        ]),\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        changeRuleType(id) {\n            this.taxRuleTypeRepository.get(id, Context.api).then((item) => {\n                this.currentTaxRuleType = item;\n            });\n        },\n        createdComponent() {\n            if (this.currentRule) {\n                this.taxRule = this.currentRule;\n                if (this.taxRule.taxRuleTypeId) {\n                    this.changeRuleType(this.taxRule.taxRuleTypeId);\n                }\n            } else {\n                this.taxRule = this.taxRuleRepository.create();\n                this.taxRule.taxId = this.tax.id;\n            }\n        },\n\n        onConfirm() {\n            this.taxRuleRepository\n                .save(this.taxRule, Context.api)\n                .then(() => {\n                    this.isSaveSuccessful = true;\n\n                    this.$emit('modal-close');\n                })\n                .catch(() => {\n                    this.isLoading = false;\n                });\n        },\n    },\n};\n"],"names":["template","Context","Criteria","mapPropertyErrors","index","criteria","id","item"],"mappings":"AAAA,MAAeA,EAAA,m+ECMT,CAAE,QAAAC,CAAS,EAAG,OACd,CAAE,SAAAC,CAAQ,EAAK,OAAO,KACtB,CAAE,kBAAAC,CAAiB,EAAK,OAAO,UAAU,mBAAkB,EAGlDC,EAAA,CACX,SAAAJ,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,SACH,EAED,MAAO,CAAC,aAAa,EAErB,MAAO,CACH,IAAK,CACD,KAAM,OACN,SAAU,EACb,EACD,YAAa,CACT,KAAM,OACN,SAAU,GACV,QAAS,IACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,UAAW,GACX,QAAS,KACT,mBAAoB,IAChC,CACK,EAED,SAAU,CACN,mBAAoB,CAChB,OAAO,KAAK,kBAAkB,OAAO,UAAU,CAClD,EACD,uBAAwB,CACpB,OAAO,KAAK,kBAAkB,OAAO,eAAe,CACvD,EACD,qBAAsB,CAClB,OAAK,KAAK,mBAKH,6BADkB,KAAK,mBAAmB,cAAc,QAAQ,KAAM,GAAG,CAC5B,GAJzC,IAKd,EACD,qBAAsB,CAClB,MAAMK,EAAW,IAAIH,EAAS,EAAG,EAAE,EACnC,OAAAG,EAAS,WAAWH,EAAS,KAAK,WAAY,KAAK,CAAC,EAE7CG,CACV,EACD,iBAAkB,CACd,MAAMA,EAAW,IAAIH,EAAS,EAAG,EAAE,EACnC,OAAAG,EAAS,WAAWH,EAAS,KAAK,OAAQ,MAAO,EAAK,CAAC,EAEhDG,CACV,EAED,GAAGF,EAAkB,UAAW,CAC5B,gBACA,YACA,UACA,YACZ,CAAS,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,eAAeG,EAAI,CACf,KAAK,sBAAsB,IAAIA,EAAIL,EAAQ,GAAG,EAAE,KAAMM,GAAS,CAC3D,KAAK,mBAAqBA,CAC1C,CAAa,CACJ,EACD,kBAAmB,CACX,KAAK,aACL,KAAK,QAAU,KAAK,YAChB,KAAK,QAAQ,eACb,KAAK,eAAe,KAAK,QAAQ,aAAa,IAGlD,KAAK,QAAU,KAAK,kBAAkB,OAAM,EAC5C,KAAK,QAAQ,MAAQ,KAAK,IAAI,GAErC,EAED,WAAY,CACR,KAAK,kBACA,KAAK,KAAK,QAASN,EAAQ,GAAG,EAC9B,KAAK,IAAM,CACR,KAAK,iBAAmB,GAExB,KAAK,MAAM,aAAa,CAC5C,CAAiB,EACA,MAAM,IAAM,CACT,KAAK,UAAY,EACrC,CAAiB,CACR,CACJ,CACL"}