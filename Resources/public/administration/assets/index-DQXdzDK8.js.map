{"version":3,"file":"index-DQXdzDK8.js","sources":["../../../app/administration/src/module/sw-promotion-v2/page/sw-promotion-v2-list/sw-promotion-v2-list.html.twig","../../../app/administration/src/module/sw-promotion-v2/page/sw-promotion-v2-list/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_promotion_v2_list %}\n<sw-page class=\"sw-promotion-v2-list\">\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_search_bar %}\n    <template #search-bar>\n        <sw-search-bar\n            initial-search-type=\"promotion\"\n            :placeholder=\"$tc('sw-promotion-v2.list.placeholderSearchBar')\"\n            :initial-search=\"term\"\n            @search=\"onSearch\"\n        />\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_list_smart_bar_header %}\n    <template #smart-bar-header>\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_promotion_v2_list_smart_bar_header_title %}\n        <h2>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_v2_list_smart_bar_header_title_text %}\n            {{ $tc('sw-promotion-v2.list.textTitle') }}\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_v2_list_smart_bar_header_amount %}\n            <span\n                v-if=\"!isLoading\"\n                class=\"sw-page__smart-bar-amount\"\n            >\n                ({{ total }})\n            </span>\n            {% endblock %}\n\n        </h2>\n        {% endblock %}\n\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_list_smart_bar_actions %}\n    <template #smart-bar-actions>\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_promotion_v2_list_smart_bar_actions_add %}\n        <sw-button\n            v-tooltip=\"addButtonTooltip\"\n            class=\"sw-promotion-v2-list__smart-bar-button-add\"\n            variant=\"primary\"\n            :router-link=\"{ name: 'sw.promotion.v2.create' }\"\n            :disabled=\"!acl.can('promotion.creator') || undefined\"\n        >\n            {{ $tc('sw-promotion-v2.list.buttonAddPromotion') }}\n        </sw-button>\n        {% endblock %}\n\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_list_language_switch %}\n    <template #language-switch>\n        <sw-language-switch @on-change=\"onChangeLanguage\" />\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_list_content %}\n    <template #content>\n        <div class=\"sw-promotion-v2-list__content\">\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_v2_list_grid %}\n            <sw-entity-listing\n                v-if=\"entitySearchable\"\n                :repository=\"promotionRepository\"\n                :columns=\"promotionColumns\"\n                :items=\"promotions\"\n                detail-route=\"sw.promotion.v2.detail\"\n                :is-loading=\"isLoading\"\n                :allow-inline-edit=\"acl.can('promotion.editor') || undefined\"\n                :show-selection=\"acl.can('promotion.deleter') || undefined\"\n                :allow-edit=\"acl.can('promotion.editor') || undefined\"\n                :allow-view=\"acl.can('promotion.viewer') || undefined\"\n                allow-column-edit\n                full-page\n                @update-records=\"updateTotal\"\n                @selection-change=\"updateSelection\"\n            >\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns %}\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns_active %}\n                <template #column-active=\"{ item }\">\n                    <sw-icon\n                        v-if=\"item.active\"\n                        class=\"sw-promotion-v2-list__icon-activity is--active\"\n                        name=\"regular-checkmark-xs\"\n                    />\n                    <sw-icon\n                        v-else\n                        class=\"sw-promotion-v2-list__icon-activity is--inactive\"\n                        name=\"regular-times-s\"\n                    />\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns_valid_from %}\n                <template #column-validFrom=\"{ item }\">\n                    {{ dateFilter(item.validFrom, { hour: '2-digit', minute: '2-digit' }) }}\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns_valid_until %}\n                <template #column-validUntil=\"{ item }\">\n                    {{ dateFilter(item.validUntil, { hour: '2-digit', minute: '2-digit' }) }}\n                </template>\n                {% endblock %}\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns_actions %}\n                <template #more-actions=\"{ item }\">\n                    {% block sw_promotion_v2_list_grid_columns_actions_duplicate %}\n                    <sw-context-menu-item\n                        :disabled=\"!acl.can('promotion.creator')\"\n                        @click=\"onDuplicatePromotion(item)\"\n                    >\n                        {{ $tc('global.default.duplicate') }}\n                    </sw-context-menu-item>\n                    {% endblock %}\n                </template>\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_promotion_v2_list_grid_columns_actions_delete %}\n                <template #delete-action=\"{ item, showDelete }\">\n                    <sw-context-menu-item\n                        variant=\"danger\"\n                        :disabled=\"(item && item.orderCount > 0) || !acl.can('promotion.deleter') || undefined\"\n                        @click=\"showDelete(item.id)\"\n                    >\n                        {{ $tc('global.default.delete') }}\n                    </sw-context-menu-item>\n                </template>\n                {% endblock %}\n                {% endblock %}\n\n            </sw-entity-listing>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_v2_list_empty_state %}\n            <template v-if=\"!isLoading && !total\">\n                <sw-promotion-v2-empty-state-hero\n                    v-if=\"isValidTerm(term)\"\n                    :title=\"$tc('sw-empty-state.messageNoResultTitle')\"\n                    :description=\"$tc('sw-empty-state.messageNoResultSubline')\"\n                />\n                <sw-promotion-v2-empty-state-hero\n                    v-else\n                    :title=\"$tc('sw-promotion-v2.list.titleEmpty')\"\n                    :description=\"$tc('sw-promotion-v2.list.descriptionEmpty')\"\n                >\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_promotion_v2_list_empty_state_actions %}\n                    <template #actions>\n                        <sw-button\n                            v-tooltip=\"addButtonTooltip\"\n                            class=\"sw-promotion-v2-list__empty-state-button-add\"\n                            variant=\"primary\"\n                            :router-link=\"{ name: 'sw.promotion.v2.create' }\"\n                            :disabled=\"!acl.can('promotion.creator') || undefined\"\n                        >\n                            {{ $tc('sw-promotion-v2.list.buttonAddPromotion') }}\n                        </sw-button>\n                    </template>\n                    {% endblock %}\n\n                </sw-promotion-v2-empty-state-hero>\n            </template>\n            {% endblock %}\n\n        </div>\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_v2_list_sidebar %}\n    <template #sidebar>\n        <sw-sidebar>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_v2_list_sidebar_refresh %}\n            <sw-sidebar-item\n                icon=\"regular-undo\"\n                :title=\"$tc('sw-promotion-v2.list.titleSidebarItemRefresh')\"\n                @click=\"onRefresh\"\n            />\n            {% endblock %}\n\n        </sw-sidebar>\n    </template>\n    {% endblock %}\n\n</sw-page>\n{% endblock %}\n","/**\n * @package checkout\n */\nimport template from './sw-promotion-v2-list.html.twig';\nimport './sw-promotion-v2-list.scss';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('listing'),\n        Mixin.getByName('notification'),\n    ],\n\n    data() {\n        return {\n            isLoading: true,\n            promotions: null,\n            total: 0,\n            showDeleteModal: false,\n            sortBy: 'createdAt',\n            sortDirection: 'DESC',\n            searchConfigEntity: 'promotion',\n        };\n    },\n\n    metaInfo() {\n        return {\n            title: this.$createTitle(),\n        };\n    },\n\n    computed: {\n        promotionRepository() {\n            return this.repositoryFactory.create('promotion');\n        },\n\n        promotionCriteria() {\n            return new Criteria(this.page, this.limit)\n                .setTerm(this.term)\n                .addSorting(Criteria.sort(this.sortBy, this.sortDirection));\n        },\n\n        promotionColumns() {\n            return this.getPromotionColumns();\n        },\n\n        addButtonTooltip() {\n            return {\n                message: this.$tc('sw-privileges.tooltip.warning'),\n                disabled: this.acl.can('promotion.creator'),\n                showOnDisabledElements: true,\n                position: 'bottom',\n            };\n        },\n\n        dateFilter() {\n            return Cicada.Filter.getByName('date');\n        },\n    },\n\n    methods: {\n        async getList() {\n            this.isLoading = true;\n\n            const criteria = await this.addQueryScores(this.term, this.promotionCriteria);\n            if (!this.entitySearchable) {\n                this.isLoading = false;\n                this.total = 0;\n\n                return false;\n            }\n            return this.promotionRepository.search(criteria).then((searchResult) => {\n                this.isLoading = false;\n                this.total = searchResult.total;\n                this.promotions = searchResult;\n\n                return this.promotions;\n            });\n        },\n\n        onChangeLanguage() {\n            this.getList();\n        },\n\n        getPromotionColumns() {\n            return [\n                {\n                    property: 'name',\n                    label: 'sw-promotion-v2.list.columnName',\n                    routerLink: 'sw.promotion.v2.detail',\n                    inlineEdit: 'string',\n                    allowResize: true,\n                    primary: true,\n                },\n                {\n                    property: 'active',\n                    label: 'sw-promotion-v2.list.columnActive',\n                    inlineEdit: 'boolean',\n                    allowResize: true,\n                    align: 'center',\n                },\n                {\n                    property: 'validFrom',\n                    label: 'sw-promotion-v2.list.columnValidFrom',\n                    inlineEdit: 'date',\n                    allowResize: true,\n                    align: 'center',\n                },\n                {\n                    property: 'validUntil',\n                    label: 'sw-promotion-v2.list.columnValidUntil',\n                    inlineEdit: 'date',\n                    allowResize: true,\n                    align: 'center',\n                },\n            ];\n        },\n\n        updateTotal({ total }) {\n            this.total = total;\n        },\n\n        async onDuplicatePromotion(referencePromotion) {\n            this.isLoading = true;\n\n            try {\n                const behavior = {\n                    overwrites: {\n                        name: `${referencePromotion.name} ${this.$tc('global.default.copy')}`,\n                        code: null,\n                        useCodes: false,\n                        useIndividualCodes: false,\n                        individualCodePattern: '',\n                        individualCodes: null,\n                        active: false,\n                    },\n                };\n                const clone = await this.promotionRepository.clone(referencePromotion.id, behavior, Cicada.Context.api);\n\n                this.$nextTick(() => {\n                    this.$router.push({\n                        name: 'sw.promotion.v2.detail',\n                        params: { id: clone.id },\n                    });\n                });\n\n                this.createNotificationInfo({\n                    message: this.$tc('sw-promotion-v2.list.duplicatePromotionInfo'),\n                });\n            } catch (error) {\n                throw new Error(error);\n            } finally {\n                this.isLoading = false;\n            }\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","index","criteria","searchResult","total","referencePromotion","behavior","clone","error"],"mappings":"AAAA,MAAeA,EAAA,ysJCMT,CAAE,MAAAC,CAAO,EAAG,OACZ,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAGbC,EAAA,CACX,SAAAH,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,KACH,EAED,OAAQ,CACJC,EAAM,UAAU,SAAS,EACzBA,EAAM,UAAU,cAAc,CACjC,EAED,MAAO,CACH,MAAO,CACH,UAAW,GACX,WAAY,KACZ,MAAO,EACP,gBAAiB,GACjB,OAAQ,YACR,cAAe,OACf,mBAAoB,WAChC,CACK,EAED,UAAW,CACP,MAAO,CACH,MAAO,KAAK,aAAc,CACtC,CACK,EAED,SAAU,CACN,qBAAsB,CAClB,OAAO,KAAK,kBAAkB,OAAO,WAAW,CACnD,EAED,mBAAoB,CAChB,OAAO,IAAIC,EAAS,KAAK,KAAM,KAAK,KAAK,EACpC,QAAQ,KAAK,IAAI,EACjB,WAAWA,EAAS,KAAK,KAAK,OAAQ,KAAK,aAAa,CAAC,CACjE,EAED,kBAAmB,CACf,OAAO,KAAK,qBACf,EAED,kBAAmB,CACf,MAAO,CACH,QAAS,KAAK,IAAI,+BAA+B,EACjD,SAAU,KAAK,IAAI,IAAI,mBAAmB,EAC1C,uBAAwB,GACxB,SAAU,QAC1B,CACS,EAED,YAAa,CACT,OAAO,OAAO,OAAO,UAAU,MAAM,CACxC,CACJ,EAED,QAAS,CACL,MAAM,SAAU,CACZ,KAAK,UAAY,GAEjB,MAAME,EAAW,MAAM,KAAK,eAAe,KAAK,KAAM,KAAK,iBAAiB,EAC5E,OAAK,KAAK,iBAMH,KAAK,oBAAoB,OAAOA,CAAQ,EAAE,KAAMC,IACnD,KAAK,UAAY,GACjB,KAAK,MAAQA,EAAa,MAC1B,KAAK,WAAaA,EAEX,KAAK,WACf,GAXG,KAAK,UAAY,GACjB,KAAK,MAAQ,EAEN,GASd,EAED,kBAAmB,CACf,KAAK,QAAO,CACf,EAED,qBAAsB,CAClB,MAAO,CACH,CACI,SAAU,OACV,MAAO,kCACP,WAAY,yBACZ,WAAY,SACZ,YAAa,GACb,QAAS,EACZ,EACD,CACI,SAAU,SACV,MAAO,oCACP,WAAY,UACZ,YAAa,GACb,MAAO,QACV,EACD,CACI,SAAU,YACV,MAAO,uCACP,WAAY,OACZ,YAAa,GACb,MAAO,QACV,EACD,CACI,SAAU,aACV,MAAO,wCACP,WAAY,OACZ,YAAa,GACb,MAAO,QACV,CACjB,CACS,EAED,YAAY,CAAE,MAAAC,GAAS,CACnB,KAAK,MAAQA,CAChB,EAED,MAAM,qBAAqBC,EAAoB,CAC3C,KAAK,UAAY,GAEjB,GAAI,CACA,MAAMC,EAAW,CACb,WAAY,CACR,KAAM,GAAGD,EAAmB,IAAI,IAAI,KAAK,IAAI,qBAAqB,CAAC,GACnE,KAAM,KACN,SAAU,GACV,mBAAoB,GACpB,sBAAuB,GACvB,gBAAiB,KACjB,OAAQ,EACX,CACrB,EACsBE,EAAQ,MAAM,KAAK,oBAAoB,MAAMF,EAAmB,GAAIC,EAAU,OAAO,QAAQ,GAAG,EAEtG,KAAK,UAAU,IAAM,CACjB,KAAK,QAAQ,KAAK,CACd,KAAM,yBACN,OAAQ,CAAE,GAAIC,EAAM,EAAI,CAChD,CAAqB,CACrB,CAAiB,EAED,KAAK,uBAAuB,CACxB,QAAS,KAAK,IAAI,6CAA6C,CACnF,CAAiB,CACJ,OAAQC,EAAO,CACZ,MAAM,IAAI,MAAMA,CAAK,CACrC,QAAsB,CACN,KAAK,UAAY,EACpB,CACJ,CACJ,CACL"}