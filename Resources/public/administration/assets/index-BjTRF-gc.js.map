{"version":3,"file":"index-BjTRF-gc.js","sources":["../../../app/administration/src/module/sw-first-run-wizard/component/sw-plugin-card/sw-plugin-card.html.twig","../../../app/administration/src/module/sw-first-run-wizard/component/sw-plugin-card/index.ts"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_plugin_card %}\n<div class=\"sw-plugin-card\">\n    <sw-extension-icon\n        :src=\"plugin.iconPath\"\n    />\n    <div class=\"sw-plugin-card__info\">\n        <div class=\"sw-plugin-card__label\">\n            {{ plugin.label }}\n        </div>\n        <div class=\"sw-plugin-card__manufacturer\">\n            {{ plugin.manufacturer }}\n        </div>\n        <div\n            v-if=\"showDescription\"\n            class=\"sw-plugin-card__short-description\"\n        >\n            {{ truncateFilter(plugin.shortDescription, 140) }}\n        </div>\n\n        <div\n            v-if=\"pluginIsNotActive\"\n            class=\"bottom\"\n        >\n            <sw-button-process\n                variant=\"primary\"\n                :is-loading=\"pluginIsLoading\"\n                :disabled=\"pluginIsLoading\"\n                :process-success=\"pluginIsSaveSuccessful\"\n                class=\"button-plugin-install\"\n                @click=\"onInstall\"\n            >\n                {{ $tc('sw-first-run-wizard.general.buttonInstall') }}\n            </sw-button-process>\n        </div>\n        <div\n            v-else\n            class=\"plugin-status\"\n        >\n            <span class=\"plugin-installed\">\n                <sw-icon\n                    name=\"regular-check-circle-s\"\n                    size=\"16\"\n                />\n                {{ $tc('sw-first-run-wizard.general.pluginInstalled') }}\n            </span>\n        </div>\n    </div>\n</div>\n{% endblock %}\n","import type { PropType } from 'vue';\nimport type { ExtensionType } from 'src/module/sw-extension/service/extension-store-action.service';\nimport template from './sw-plugin-card.html.twig';\nimport './sw-plugin-card.scss';\n\ntype ComponentData = {\n    pluginIsLoading: boolean;\n    pluginIsSaveSuccessful: boolean;\n};\n\ntype RecommendedPlugin = {\n    active: boolean;\n    name: string;\n    iconPath: string;\n    label: string;\n    manufacturer: string;\n    shortDescription: string;\n    type: ExtensionType;\n};\n\n/**\n * @package checkout\n * @private\n */\nexport default Cicada.Component.wrapComponentConfig({\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'cacheApiService',\n        'extensionHelperService',\n        'cicadaExtensionService',\n    ],\n\n    mixins: [Cicada.Mixin.getByName('sw-extension-error')],\n\n    props: {\n        plugin: {\n            type: Object as PropType<RecommendedPlugin>,\n            required: true,\n        },\n        showDescription: {\n            type: Boolean,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n            required: false,\n        },\n    },\n\n    data(): ComponentData {\n        return {\n            pluginIsLoading: false,\n            pluginIsSaveSuccessful: false,\n        };\n    },\n\n    computed: {\n        pluginIsNotActive(): boolean {\n            return !this.plugin.active;\n        },\n\n        truncateFilter() {\n            return Cicada.Filter.getByName('truncate');\n        },\n    },\n\n    methods: {\n        onInstall(): void {\n            void this.setupPlugin();\n        },\n\n        async setupPlugin(): Promise<void> {\n            this.pluginIsLoading = true;\n            this.pluginIsSaveSuccessful = false;\n\n            try {\n                await this.extensionHelperService.downloadAndActivateExtension(this.plugin.name, this.plugin.type);\n                this.pluginIsSaveSuccessful = true;\n                this.$emit('extension-activated');\n            } catch (error: unknown) {\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n                this.showExtensionErrors(error);\n            } finally {\n                this.pluginIsLoading = false;\n\n                if (this.plugin.type === 'plugin') {\n                    // wait until cacheApiService is transpiled to ts\n                    // @ts-expect-error\n                    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-call\n                    this.cacheApiService.clear();\n                }\n\n                await this.cicadaExtensionService.updateExtensionData();\n\n                this.$emit('on-plugin-installed', this.plugin.name);\n            }\n        },\n    },\n});\n"],"names":["template","index","error"],"mappings":"AAAA,MAAeA,EAAA,i7BCwBfC,EAAe,OAAO,UAAU,oBAAoB,CAChD,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,kBACA,yBACA,wBACJ,EAEA,OAAQ,CAAC,OAAO,MAAM,UAAU,oBAAoB,CAAC,EAErD,MAAO,CACH,OAAQ,CACJ,KAAM,OACN,SAAU,EACd,EACA,gBAAiB,CACb,KAAM,QAEN,QAAS,GACT,SAAU,EACd,CACJ,EAEA,MAAsB,CACX,MAAA,CACH,gBAAiB,GACjB,uBAAwB,EAAA,CAEhC,EAEA,SAAU,CACN,mBAA6B,CAClB,MAAA,CAAC,KAAK,OAAO,MACxB,EAEA,gBAAiB,CACN,OAAA,OAAO,OAAO,UAAU,UAAU,CAC7C,CACJ,EAEA,QAAS,CACL,WAAkB,CACT,KAAK,aACd,EAEA,MAAM,aAA6B,CAC/B,KAAK,gBAAkB,GACvB,KAAK,uBAAyB,GAE1B,GAAA,CACM,MAAA,KAAK,uBAAuB,6BAA6B,KAAK,OAAO,KAAM,KAAK,OAAO,IAAI,EACjG,KAAK,uBAAyB,GAC9B,KAAK,MAAM,qBAAqB,QAC3BE,EAAgB,CAErB,KAAK,oBAAoBA,CAAK,CAAA,QAChC,CACE,KAAK,gBAAkB,GAEnB,KAAK,OAAO,OAAS,UAIrB,KAAK,gBAAgB,QAGnB,MAAA,KAAK,uBAAuB,sBAElC,KAAK,MAAM,sBAAuB,KAAK,OAAO,IAAI,CACtD,CACJ,CACJ,CACJ,CAAC"}