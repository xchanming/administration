const u=`{% block sw_settings_product_feature_sets_modal %} <sw-modal :title="$tc('sw-settings-product-feature-sets.modal.labelTitleModal')" class="sw-settings-product-feature-sets__modal" @modal-close="$emit('modal-close')" > {% block sw_settings_product_feature_sets_modal_first_page %} <template v-if="showPageOne"> <sw-radio-field v-model:value="selectedFeatureType" :label="$tc('sw-settings-product-feature-sets.modal.labelTitlePageOne')" block class="sw-settings-product-feature-sets-modal__options" identification="fieldType" :options="settingOptions" @update:value="onChangeOption" /> </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_custom_field_list %} <template v-if="showCustomField"> {% block sw_settings_product_feature_sets_modal_custom_field_list_toolbar %} <div class="sw-product-feature-set-modal-custom-field-list__toolbar"> {% block sw_settings_product_feature_sets_modal_custom_field_list_toolbar_search %} <sw-simple-search-field v-model:value="term" size="small" variant="form" @search-term-change="onSearchCustomFields" /> {% endblock %} </div> {% endblock %} <sw-data-grid ref="customFieldGrid" :data-source="customFields" :columns="customFieldColumns" :show-selection="true" :show-actions="false" :is-loading="valuesLoading" identifier="sw-product-feature-set-modal-custom-field-list" @selection-change="setFeatureSelection" > {% block sw_settings_product_feature_sets_modal_custom_field_list_column_name %} <template #column-name="{ item }"> {{ readCustomFieldLabel(item) }} </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_custom_field_list_column_type %} <template #column-type="{ item }"> {{ item.type }} </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_custom_field_list_pagination %} <template #pagination> <sw-pagination v-if="customFieldTotal > customFieldCriteria.limit" :total="customFieldTotal" :limit="customFieldCriteria.limit" :page="customFieldCriteria.page" :auto-hide="false" @page-change="paginateCustomFieldGrid" /> </template> {% endblock %} </sw-data-grid> </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_property_list %} <template v-if="showPropertyGroups"> {% block sw_settings_product_feature_sets_modal_property_list_toolbar %} <div class="sw-product-feature-set-modal-property-list__toolbar"> {% block sw_settings_product_feature_sets_modal_property_list_toolbar_search %} <sw-simple-search-field v-model:value="term" size="small" variant="form" @search-term-change="onSearchPropertyGroups" /> {% endblock %} </div> {% endblock %} <sw-data-grid ref="propertyGroupGrid" :data-source="propertyGroups" :columns="propertyGroupColumns" :show-selection="true" :show-actions="false" :is-loading="valuesLoading" identifier="sw-product-feature-set-modal-property-list" @selection-change="setFeatureSelection" > {% block sw_settings_product_feature_sets_modal_property_list_column_property %} <template #column-id="{ item }"> {{ item.name }} </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_property_list_pagination %} <template #pagination> <sw-pagination v-if="propertyGroupTotal > propertyGroupCriteria.limit" :total="propertyGroupTotal" :limit="propertyGroupCriteria.limit" :page="propertyGroupCriteria.page" :auto-hide="false" @page-change="paginatePropertyGroupGrid" /> </template> {% endblock %} </sw-data-grid> </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_product_information_list %} <template v-if="showProductInfo"> {% block sw_settings_product_feature_sets_modal_product_information_list_toolbar %}{% endblock %} <sw-data-grid :data-source="productInfo" :columns="productInformationColumns" :show-selection="true" :show-actions="false" :is-loading="valuesLoading" identifier="sw-product-feature-set-modal-product-information-list" @selection-change="setFeatureSelection" > {% block sw_settings_product_feature_sets_modal_product_informationlist_column_property %} <template #column-id="{ item }"> {{ item.name }} </template> {% endblock %} </sw-data-grid> </template> {% endblock %} {% block sw_settings_product_feature_sets_modal_footer %} <template #modal-footer> {% block sw_settings_product_feature_sets_modal_footer_cancel %} <sw-button size="small" @click="$emit('modal-close')" > {{ $tc('global.default.cancel') }} </sw-button> {% endblock %} {% block sw_settings_product_feature_sets_modal_footer_button_add %} <sw-button v-if="!showPageOne | referencePriceSelected" variant="primary" size="small" :disabled="addButtonDisabled" @click="onConfirm" > {{ $tc('global.default.add') }} </sw-button> {% endblock %} {% block sw_settings_product_feature_sets_modal_footer_button_next %} <sw-button v-if="showNextButton" variant="primary" size="small" :disabled="nextButtonDisabled" @click="onClickNext" > {{ $tc('sw-settings-product-feature-sets.modal.buttonNext') }} </sw-button> {% endblock %} </template> {% endblock %} </sw-modal> {% endblock %}`,{Context:c}=Cicada,{Criteria:s}=Cicada.Data,d={template:u,compatConfig:Cicada.compatConfig,inject:["repositoryFactory"],emits:["modal-close"],props:{productFeatureSet:{type:Object,required:!0}},data(){return{showModal:!1,featureType:null,selectedFeatures:new Map,features:[],selectedFeatureType:null,showPageOne:!0,term:"",showCustomField:!1,showPropertyGroups:!1,showProductInfo:!1,nextButtonDisabled:!0,addButtonDisabled:!0,showNextButton:!0,valuesLoading:!1,customFields:[],propertyGroups:[],productInfo:[{id:"fc472b0728ce4000969214a0fa61f2df",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.description"),name:"description"},{id:"f64801aad24a4de7bfea4d312f957258",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.releaseDate"),name:"releaseDate"},{id:"f4a361187eac4f6ea4507ebf20c2e9d7",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.manufacturerNumber"),name:"manufacturerNumber"},{id:"eb6c8ec9b6e24811a176be5a5c9871cf",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.ean"),name:"ean"},{id:"09110f8260804f009ab4536a1ffbc938",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.width"),name:"width"},{id:"e8a48d5fce2f402e8696477b03d7e8e7",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.height"),name:"height"},{id:"e4cf3f607a704f569c3912fb85ada9ad",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.length"),name:"length"},{id:"e06c53dc014a4130a8850fe64e395046",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.weight"),name:"weight"}]}},computed:{productFeatureSetRepository(){return this.repositoryFactory.create("product_feature_set")},customFieldsRepository(){return this.repositoryFactory.create("custom_field")},propertyGroupsRepository(){return this.repositoryFactory.create("property_group")},productFeatureSetCriteria(){return new s(1,25)},customFieldCriteria(){const e=new s(1,25);e.addSorting(s.sort("type","DESC"));const t=this.getFeaturesIds("customField");return t.length>0&&e.addFilter(s.not("AND",[s.equalsAny("id",t)])),e},propertyGroupCriteria(){const e=new s(1,25),t=this.getFeaturesIds("property");return t.length>0&&e.addFilter(s.not("AND",[s.equalsAny("id",t)])),e},referencePriceSelected(){return this.selectedFeatureType==="referencePrice"},propertyGroupColumns(){return this.getPropertyGroupColumns()},customFieldColumns(){return this.getCustomFieldColumns()},productInformationColumns(){return this.getProductInformationColumns()},checkIfReferencePriceSelected(){return this.productFeatureSet.features?this.productFeatureSet.features.filter(e=>e.type==="referencePrice").length===1:!1},settingOptions(){return[{value:"property",disabled:this.propertyGroups.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textPropertyLabel")},{value:"customField",disabled:this.customFields.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textCustomFieldLabel")},{value:"product",disabled:this.productInfo.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textProductInfoLabel")},{value:"referencePrice",disabled:this.checkIfReferencePriceSelected,name:this.$tc("sw-settings-product-feature-sets.modal.textReferencePriceLabel")}]},customFieldTotal(){return this.customFields.total||0},propertyGroupTotal(){return this.propertyGroups.total||0}},created(){this.createdComponent()},methods:{createdComponent(){this.productFeatureSet.features&&(this.features=this.productFeatureSet.features),this.customFieldCriteria.setLimit(10),this.propertyGroupCriteria.setLimit(10),this.getCustomFieldList(),this.getPropertyList(),this.getProductInformationList()},onSearchCustomFields(){this.customFieldCriteria.setTerm(this.term),this.getCustomFieldList()},onSearchPropertyGroups(){this.propertyGroupCriteria.setTerm(this.term),this.getPropertyList()},onClickNext(){switch(this.showPageOne=!1,this.showNextButton=!1,this.featureType=this.selectedFeatureType,this.selectedFeatureType){case"customField":this.showCustomField=!0;break;case"property":this.showPropertyGroups=!0;break;case"product":this.showProductInfo=!0;break}},getProductInformationList(){if(!this.productFeatureSet.features)return;const e=this.productFeatureSet.features.map(t=>t.name);this.productInfo=this.productInfo.filter(t=>!(t.type==="product"&&e.includes(t.name)))},getCustomFieldList(){return this.getList(this.customFieldsRepository,this.customFieldCriteria,e=>{this.customFields=e,this.valuesLoading=!1})},getPropertyList(){return this.getList(this.propertyGroupsRepository,this.propertyGroupCriteria,e=>{this.propertyGroups=e,this.valuesLoading=!1})},getList(e,t,r){return this.valuesLoading=!0,e.search(t,Cicada.Context.api).then(r).catch(()=>{this.valuesLoading=!1})},getFeaturesIds(e){return this.productFeatureSet.features?this.productFeatureSet.features.filter(t=>t.type===e).map(t=>t.id):[]},onChangeOption(){this.checkIfReferencePriceIsSelected(),this.addButtonDisabled=!this.referencePriceSelected,this.nextButtonDisabled&&(this.nextButtonDisabled=!1)},checkIfReferencePriceIsSelected(){this.showNextButton=!this.referencePriceSelected},onConfirm(){this.referencePriceSelected?this.features.push({id:"d45b40f6a99c4c2abe66c410369b9d3c",name:"referencePrice",type:"referencePrice",position:this.features.length+1}):this.selectedFeatures.forEach(e=>this.setFeatures(e)),this.productFeatureSet.features=this.features,this.productFeatureSetRepository.save(this.productFeatureSet,c.api).then(()=>{this.isSaveSuccessful=!0,this.featureType=null,this.$emit("modal-close")}).catch(()=>{this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("global.notification.unspecifiedSaveErrorMessage")})}).finally(()=>{this.isLoading=!1})},setFeatures(e){Object.keys(e).forEach(t=>{this.features.push({id:e[t].id,name:e[t].name,type:this.selectedFeatureType,position:this.features.length+1})})},setFeatureSelection(e,t){if(!(this.showCustomField||this.showPropertyGroups)){if(t<1){this.addButtonDisabled=!0;return}this.selectedFeatures.set(1,e),this.addButtonDisabled=!1;return}const a=(this.showCustomField?this.customFieldCriteria:this.propertyGroupCriteria).page,o=this.selectedFeatures.get(a);if(!o||Object.keys(o).length<1){this.selectedFeatures.set(a,e),this.addButtonDisabled=!1;return}const i=this.showCustomField?this.$refs.customFieldGrid:this.$refs.propertyGroupGrid;Object.keys(o).forEach(l=>i.selectItem(!0,o[l]))},getPropertyGroupColumns(){return[{property:"name",label:"sw-settings-product-feature-sets.modal.textPropertyLabel",primary:!0}]},getCustomFieldColumns(){return[{property:"name",label:"sw-settings-product-feature-sets.modal.labelName",primary:!0},{property:"type",label:"sw-settings-product-feature-sets.valuesCard.labelType"}]},getProductInformationColumns(){return[{property:"label",label:"sw-settings-product-feature-sets.modal.labelName",primary:!0}]},paginateCustomFieldGrid({page:e,limit:t}){this.customFieldCriteria.setPage(e),this.customFieldCriteria.setLimit(t),this.getCustomFieldList()},paginatePropertyGroupGrid({page:e,limit:t}){this.propertyGroupCriteria.setPage(e),this.propertyGroupCriteria.setLimit(t),this.getPropertyList()},readCustomFieldLabel(e){const t=Cicada.State.get("session").currentLocale,r=Cicada.Context.app.fallbackLocale;return e.config.label[t]||e.config.label[r]}}};export{d as default};
//# sourceMappingURL=index-DKqiG49o.js.map
