{"version":3,"file":"index-bZpBQ8NG.js","sources":["../../../app/administration/src/module/sw-promotion-v2/view/sw-promotion-detail-discounts/sw-promotion-detail-discounts.html.twig","../../../app/administration/src/module/sw-promotion-v2/view/sw-promotion-detail-discounts/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_promotion_detail_discounts %}\n<div class=\"sw-promotion-detail-discounts\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_detail_discounts_card_add %}\n    <div\n        class=\"promotion-detail-discounts__action_add\"\n        position-identifier=\"sw-promotion-detail-discounts\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_promotion_detail_discounts_actions_add %}\n        <sw-button\n            v-tooltip=\"{\n                message: $tc('sw-privileges.tooltip.warning'),\n                disabled: acl.can('promotion.editor'),\n                showOnDisabledElements: true\n            }\"\n            :is-loading=\"isLoading\"\n            variant=\"ghost\"\n            :disabled=\"(promotion && promotion.hasOrders) || !acl.can('promotion.editor')\"\n            @click=\"onAddDiscount\"\n        >\n            {{ $tc('sw-promotion.detail.main.discounts.buttonAddDiscount') }}\n        </sw-button>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_detail_discounts_items %}\n    <ul class=\"sw-promotion-detail-discounts__discount-list\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_promotion_detail_discounts_item_form %}\n        <sw-promotion-discount-component\n            v-for=\"discount in discounts\"\n            :key=\"discount.id\"\n            :promotion=\"promotion\"\n            :discount=\"discount\"\n            @discount-delete=\"deleteDiscount\"\n        />\n        {% endblock %}\n    </ul>\n    {% endblock %}\n</div>\n{% endblock %}\n","import { DiscountTypes, DiscountScopes } from 'src/module/sw-promotion-v2/helper/promotion.helper';\nimport template from './sw-promotion-detail-discounts.html.twig';\nimport './sw-promotion-detail-discounts.scss';\n\n/**\n * @package checkout\n *\n * @private\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    data() {\n        return {\n            deleteDiscountId: null,\n            repository: null,\n        };\n    },\n\n    computed: {\n        promotion() {\n            return Cicada.State.get('swPromotionDetail').promotion;\n        },\n\n        isLoading: {\n            get() {\n                return Cicada.State.get('swPromotionDetail').isLoading;\n            },\n            set(isLoading) {\n                Cicada.State.commit('swPromotionDetail/setIsLoading', isLoading);\n            },\n        },\n\n        discounts() {\n            return (\n                Cicada.State.get('swPromotionDetail').promotion && Cicada.State.get('swPromotionDetail').promotion.discounts\n            );\n        },\n    },\n\n    methods: {\n        // This function adds a new blank discount object to our promotion.\n        // It will automatically trigger a rendering of the view which\n        // leads to a new card that appears within our discounts area.\n        onAddDiscount() {\n            const promotionDiscountRepository = this.repositoryFactory.create(this.discounts.entity, this.discounts.source);\n            const newDiscount = promotionDiscountRepository.create();\n            newDiscount.promotionId = this.promotion.id;\n            newDiscount.scope = DiscountScopes.CART;\n            newDiscount.type = DiscountTypes.PERCENTAGE;\n            newDiscount.value = 0.01;\n            newDiscount.considerAdvancedRules = false;\n            newDiscount.sorterKey = 'PRICE_ASC';\n            newDiscount.applierKey = 'ALL';\n            newDiscount.usageKey = 'ALL';\n\n            this.discounts.push(newDiscount);\n        },\n\n        deleteDiscount(discount) {\n            if (discount.isNew()) {\n                this.discounts.remove(discount.id);\n                return;\n            }\n\n            this.isLoading = true;\n            const promotionDiscountRepository = this.repositoryFactory.create(this.discounts.entity, this.discounts.source);\n\n            promotionDiscountRepository.delete(discount.id, this.discounts.context).then(() => {\n                this.discounts.remove(discount.id);\n                this.isLoading = false;\n            });\n        },\n    },\n};\n"],"names":["template","index","isLoading","newDiscount","DiscountScopes","DiscountTypes","discount"],"mappings":"6HAAA,MAAeA,EAAA,wjCCSAC,EAAA,CACX,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,KACH,EAED,MAAO,CACH,MAAO,CACH,iBAAkB,KAClB,WAAY,IACxB,CACK,EAED,SAAU,CACN,WAAY,CACR,OAAO,OAAO,MAAM,IAAI,mBAAmB,EAAE,SAChD,EAED,UAAW,CACP,KAAM,CACF,OAAO,OAAO,MAAM,IAAI,mBAAmB,EAAE,SAChD,EACD,IAAIE,EAAW,CACX,OAAO,MAAM,OAAO,iCAAkCA,CAAS,CAClE,CACJ,EAED,WAAY,CACR,OACI,OAAO,MAAM,IAAI,mBAAmB,EAAE,WAAa,OAAO,MAAM,IAAI,mBAAmB,EAAE,UAAU,SAE1G,CACJ,EAED,QAAS,CAIL,eAAgB,CAEZ,MAAMC,EAD8B,KAAK,kBAAkB,OAAO,KAAK,UAAU,OAAQ,KAAK,UAAU,MAAM,EAC9D,SAChDA,EAAY,YAAc,KAAK,UAAU,GACzCA,EAAY,MAAQC,EAAe,KACnCD,EAAY,KAAOE,EAAc,WACjCF,EAAY,MAAQ,IACpBA,EAAY,sBAAwB,GACpCA,EAAY,UAAY,YACxBA,EAAY,WAAa,MACzBA,EAAY,SAAW,MAEvB,KAAK,UAAU,KAAKA,CAAW,CAClC,EAED,eAAeG,EAAU,CACrB,GAAIA,EAAS,QAAS,CAClB,KAAK,UAAU,OAAOA,EAAS,EAAE,EACjC,MACH,CAED,KAAK,UAAY,GACmB,KAAK,kBAAkB,OAAO,KAAK,UAAU,OAAQ,KAAK,UAAU,MAAM,EAElF,OAAOA,EAAS,GAAI,KAAK,UAAU,OAAO,EAAE,KAAK,IAAM,CAC/E,KAAK,UAAU,OAAOA,EAAS,EAAE,EACjC,KAAK,UAAY,EACjC,CAAa,CACJ,CACJ,CACL"}