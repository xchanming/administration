{"version":3,"file":"index-BVvNO6hu.js","sources":["../../../app/administration/src/module/sw-flow/component/modals/sw-flow-app-action-modal/sw-flow-app-action-modal.html.twig","../../../app/administration/src/module/sw-flow/component/modals/sw-flow-app-action-modal/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_flow_app_action_modal %}\n<sw-modal\n    class=\"sw-flow-app-action-modal\"\n    @modal-close=\"onClose\"\n>\n    <template #modal-header>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_flow_app_action_modal_header %}\n        <div class=\"sw-flow-app-action-modal__header\">\n            {{ actionLabel }}\n            <span class=\"sw-flow-app-action-modal__app-badge\">\n                {{ appBadge }}\n            </span>\n        </div>\n        {% endblock %}\n    </template>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_flow_app_action_modal_content %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_flow_app_action_modal_headcontent %}\n    <div\n        v-if=\"headline || paragraph\"\n        class=\"sw-flow-app-action-modal__headcontent\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_flow_app_action_modal_headline %}\n        <div\n            v-if=\"headline\"\n            class=\"sw-flow-app-action-modal__headline\"\n        >\n            {{ headline }}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_flow_app_action_modal_paragraph %}\n        <div\n            v-if=\"paragraph\"\n            class=\"sw-flow-app-action-modal__paragraph\"\n        >\n            {{ paragraph }}\n        </div>\n        {% endblock %}\n    </div>\n    {% endblock %}\n    <sw-form-field-renderer\n        v-for=\"field in fields\"\n        :key=\"field.name\"\n        v-model:value=\"config[field.name]\"\n        :type=\"field.type\"\n        :config=\"getConfig(field)\"\n        :error=\"errors[field.name]\"\n        @update:value=\"onChange($event, field)\"\n    />\n    {% endblock %}\n    <template #modal-footer>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_flow_app_action_modal_footer_cancel_button %}\n        <sw-button\n            class=\"sw-flow-app-action-modal__cancel-button\"\n            size=\"small\"\n            @click=\"onClose\"\n        >\n            {{ $tc('global.default.cancel') }}\n        </sw-button>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_flow_app_action_modal_footer_save_button %}\n        <sw-button\n            class=\"sw-flow-app-action-modal__save-button\"\n            variant=\"primary\"\n            size=\"small\"\n            @click=\"onSave\"\n        >\n            {{ $tc('sw-flow.modals.buttonSaveAction') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n</sw-modal>\n{% endblock %}\n","import template from './sw-flow-app-action-modal.html.twig';\nimport './sw-flow-app-action-modal.scss';\n\nconst {\n    Mixin,\n    Classes: { CicadaError },\n} = Cicada;\n\n/**\n * @private\n * @package services-settings\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['acl'],\n\n    emits: [\n        'process-finish',\n        'modal-close',\n    ],\n\n    mixins: [\n        Mixin.getByName('placeholder'),\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        sequence: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            config: {},\n            fields: [],\n            errors: {},\n        };\n    },\n\n    computed: {\n        actionLabel() {\n            return this.sequence?.propsAppFlowAction?.translated?.label || this.sequence?.propsAppFlowAction?.label;\n        },\n\n        appBadge() {\n            return this.sequence?.propsAppFlowAction?.app?.label;\n        },\n\n        currentLocale() {\n            return Cicada.State.get('session').currentLocale;\n        },\n\n        headline() {\n            return this.sequence?.propsAppFlowAction?.translated?.headline || this.sequence?.propsAppFlowAction?.headline;\n        },\n\n        paragraph() {\n            return (\n                this.sequence?.propsAppFlowAction?.translated?.description || this.sequence?.propsAppFlowAction?.description\n            );\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.getFields();\n            if (!this.sequence?.config) {\n                return;\n            }\n\n            Object.entries({ ...this.sequence.config }).forEach(\n                ([\n                    key,\n                    configValue,\n                ]) => {\n                    this.config[key] =\n                        typeof configValue === 'object' && configValue.value !== undefined ? configValue.value : configValue;\n                },\n            );\n        },\n\n        onChange(event, field) {\n            this.handleValid(field, event);\n        },\n\n        isValid() {\n            this.errors = {};\n            this.fields.forEach((field) => {\n                const val = this.config[field.name] ?? null;\n                this.handleValid(field, val);\n            });\n\n            return Object.keys(this.errors).length === 0;\n        },\n\n        handleValid(field, val) {\n            let value = val;\n            if (typeof value === 'object' && (value?.length === 0 || value?.value?.length === 0)) {\n                value = null;\n            }\n\n            if (field.required && !value && typeof value !== 'boolean') {\n                if (this.isCompatEnabled('INSTANCE_DELETE')) {\n                    this.$delete(this.config, [field.name]);\n                } else {\n                    delete this.config[field.name];\n                }\n\n                if (this.isCompatEnabled('INSTANCE_SET')) {\n                    this.$set(\n                        this.errors,\n                        field.name,\n                        new CicadaError({\n                            code: 'c1051bb4-d103-4f74-8988-acbcafc7fdc3',\n                        }),\n                    );\n                } else {\n                    this.errors[field.name] = new CicadaError({\n                        code: 'c1051bb4-d103-4f74-8988-acbcafc7fdc3',\n                    });\n                }\n                return;\n            }\n\n            if (this.isCompatEnabled('INSTANCE_DELETE')) {\n                this.$delete(this.errors, [field.name]);\n            } else {\n                delete this.errors[field.name];\n            }\n        },\n\n        onSave() {\n            if (!this.isValid() || !this.sequence?.propsAppFlowAction?.app?.active) return;\n\n            const config = this.buildConfig();\n            const data = {\n                ...this.sequence,\n                config,\n            };\n            this.$emit('process-finish', data);\n            this.onClose();\n        },\n\n        buildConfig() {\n            const data = {};\n            this.fields.forEach((field) => {\n                if (this.config[field.name]?.length !== 0 && this.config[field.name] !== null) {\n                    data[field.name] = this.config[field.name];\n                }\n            });\n\n            return data;\n        },\n\n        onClose() {\n            this.$emit('modal-close');\n        },\n\n        getFields() {\n            this.sequence.propsAppFlowAction?.config.forEach((config) => {\n                this.config[config.name] = this.convertDefaultValue(config.type, config.defaultValue);\n                this.fields.push(config);\n                if (this.isCompatEnabled('INSTANCE_DELETE')) {\n                    this.$delete(this.errors, config.name);\n                } else {\n                    delete this.errors[config.name];\n                }\n            });\n        },\n\n        convertDefaultValue(type, value) {\n            if (value === undefined) {\n                return null;\n            }\n\n            if (\n                [\n                    'int',\n                    'float',\n                ].includes(type)\n            ) {\n                return parseInt(value, 10);\n            }\n\n            if (\n                [\n                    'bool',\n                    'checkbox',\n                ].includes(type)\n            ) {\n                return !!value;\n            }\n\n            if (\n                [\n                    'date',\n                    'datetime',\n                    'time',\n                ].includes(type)\n            ) {\n                return null;\n            }\n\n            return value;\n        },\n\n        getConfig(field) {\n            const config = {\n                label: field.label,\n                placeholder: field.placeHolder,\n                disabled: field.disabled,\n                required: field.required,\n                helpText: this.helpText(field),\n            };\n\n            if (field.type === 'colorpicker') {\n                config.componentName = 'sw-colorpicker';\n                config.zIndex = 1000;\n                config.colorOutput = 'hex';\n\n                return config;\n            }\n\n            if (field.type === 'text-editor') {\n                config.componentName = 'sw-text-editor';\n\n                return config;\n            }\n\n            if (\n                [\n                    'single-select',\n                    'multi-select',\n                ].includes(field.type)\n            ) {\n                config.componentName = `sw-${field.type}`;\n                config.options = field.options;\n            }\n\n            return config;\n        },\n\n        helpText(field) {\n            if (field.helpText === undefined) {\n                return null;\n            }\n\n            const objHelpText = JSON.parse(JSON.stringify(field.helpText));\n\n            return objHelpText[this.currentLocale] ?? objHelpText[Cicada.Context.app.fallbackLocale] ?? null;\n        },\n    },\n};\n"],"names":["template","Mixin","CicadaError","index","_a","_b","_c","_d","_e","key","configValue","event","field","val","value","config","data","type","objHelpText"],"mappings":"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"}