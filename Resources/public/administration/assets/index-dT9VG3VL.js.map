{"version":3,"file":"index-dT9VG3VL.js","sources":["../../../app/administration/src/module/sw-first-run-wizard/view/sw-first-run-wizard-mailer-local/sw-first-run-wizard-mailer-local.html.twig","../../../app/administration/src/module/sw-first-run-wizard/view/sw-first-run-wizard-mailer-local/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_first_run_wizard_mailer_local %}\n<div class=\"sw-first-run-wizard-mailer-local\">\n    <sw-loader v-if=\"isLoading\" />\n\n    <h2>{{ $tc('sw-first-run-wizard.mailerLocal.headline') }}</h2>\n\n    <div class=\"sw-settings-mailer-local\">\n        <sw-radio-field\n            v-model:value=\"mailerSettings['core.mailerSettings.sendMailOptions']\"\n            :options=\"emailSendmailOptions\"\n        />\n    </div>\n</div>\n{% endblock %}\n","import './sw-first-run-wizard-mailer-local.scss';\nimport template from './sw-first-run-wizard-mailer-local.html.twig';\n\n/**\n * @package checkout\n * @private\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['systemConfigApiService'],\n\n    emits: [\n        'buttons-update',\n        'frw-set-title',\n        'frw-redirect',\n    ],\n\n    data() {\n        return {\n            isLoading: false,\n            mailerSettings: {\n                'core.mailerSettings.emailAgent': null,\n                'core.mailerSettings.sendMailOptions': null,\n            },\n        };\n    },\n\n    computed: {\n        emailSendmailOptions() {\n            /**\n             * -bs: Starts a smtp session over the sendmail binary\n             * -t: Sends a mail in background\n             */\n            return [\n                {\n                    value: '-bs',\n                    name: this.$tc('sw-settings-mailer.sendmail.sync'),\n                },\n                {\n                    value: '-t -i',\n                    name: this.$tc('sw-settings-mailer.sendmail.async'),\n                },\n            ];\n        },\n\n        nextAction() {\n            if (Cicada.State.get('context').app.config.settings.disableExtensionManagement) {\n                return 'sw.first.run.wizard.index.cicada.account';\n            }\n\n            return 'sw.first.run.wizard.index.paypal.info';\n        },\n\n        buttonConfig() {\n            return [\n                {\n                    key: 'back',\n                    label: this.$tc('sw-first-run-wizard.general.buttonBack'),\n                    position: 'left',\n                    variant: null,\n                    action: 'sw.first.run.wizard.index.mailer.selection',\n                    disabled: false,\n                },\n                {\n                    key: 'configure-later',\n                    label: this.$tc('sw-first-run-wizard.general.buttonConfigureLater'),\n                    position: 'right',\n                    variant: null,\n                    action: this.nextAction,\n                    disabled: false,\n                },\n                {\n                    key: 'next',\n                    label: this.$tc('sw-first-run-wizard.general.buttonNext'),\n                    position: 'right',\n                    variant: 'primary',\n                    action: this.saveMailerSettings.bind(this),\n                    disabled: !this.requiredFieldsFilled,\n                },\n            ];\n        },\n\n        requiredFieldsFilled() {\n            return (\n                !!this.mailerSettings['core.mailerSettings.emailAgent'] &&\n                !!this.mailerSettings['core.mailerSettings.sendMailOptions']\n            );\n        },\n    },\n\n    watch: {\n        mailerSettings: {\n            deep: true,\n            handler() {\n                this.updateButtons();\n            },\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        async createdComponent() {\n            this.updateButtons();\n            this.setTitle();\n            await this.loadMailerSettings();\n        },\n\n        updateButtons() {\n            this.$emit('buttons-update', this.buttonConfig);\n        },\n\n        setTitle() {\n            this.$emit('frw-set-title', this.$tc('sw-first-run-wizard.mailerLocal.headline'));\n        },\n\n        async loadMailerSettings() {\n            this.isLoading = true;\n\n            this.mailerSettings = await this.systemConfigApiService.getValues('core.mailerSettings');\n            this.mailerSettings['core.mailerSettings.emailAgent'] = 'local';\n            const option = this.mailerSettings['core.mailerSettings.sendMailOptions'];\n\n            if (option === undefined || option === '') {\n                this.mailerSettings['core.mailerSettings.sendMailOptions'] = '-t -i';\n            }\n\n            this.isLoading = false;\n        },\n\n        saveMailerSettings() {\n            this.isLoading = true;\n\n            return this.systemConfigApiService\n                .saveValues(this.mailerSettings)\n                .then(() => {\n                    this.$emit('frw-redirect', this.nextAction);\n                    this.isLoading = false;\n                })\n                .catch(() => {\n                    this.isLoading = false;\n                });\n        },\n    },\n};\n"],"names":["template","index","option"],"mappings":"AAAA,MAAeA,EAAA,yXCOAC,EAAA,CACX,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CAAC,wBAAwB,EAEjC,MAAO,CACH,iBACA,gBACA,cACH,EAED,MAAO,CACH,MAAO,CACH,UAAW,GACX,eAAgB,CACZ,iCAAkC,KAClC,sCAAuC,IAC1C,CACb,CACK,EAED,SAAU,CACN,sBAAuB,CAKnB,MAAO,CACH,CACI,MAAO,MACP,KAAM,KAAK,IAAI,kCAAkC,CACpD,EACD,CACI,MAAO,QACP,KAAM,KAAK,IAAI,mCAAmC,CACrD,CACjB,CACS,EAED,YAAa,CACT,OAAI,OAAO,MAAM,IAAI,SAAS,EAAE,IAAI,OAAO,SAAS,2BACzC,2CAGJ,uCACV,EAED,cAAe,CACX,MAAO,CACH,CACI,IAAK,OACL,MAAO,KAAK,IAAI,wCAAwC,EACxD,SAAU,OACV,QAAS,KACT,OAAQ,6CACR,SAAU,EACb,EACD,CACI,IAAK,kBACL,MAAO,KAAK,IAAI,kDAAkD,EAClE,SAAU,QACV,QAAS,KACT,OAAQ,KAAK,WACb,SAAU,EACb,EACD,CACI,IAAK,OACL,MAAO,KAAK,IAAI,wCAAwC,EACxD,SAAU,QACV,QAAS,UACT,OAAQ,KAAK,mBAAmB,KAAK,IAAI,EACzC,SAAU,CAAC,KAAK,oBACnB,CACjB,CACS,EAED,sBAAuB,CACnB,MACI,CAAC,CAAC,KAAK,eAAe,gCAAgC,GACtD,CAAC,CAAC,KAAK,eAAe,qCAAqC,CAElE,CACJ,EAED,MAAO,CACH,eAAgB,CACZ,KAAM,GACN,SAAU,CACN,KAAK,cAAa,CACrB,CACJ,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,MAAM,kBAAmB,CACrB,KAAK,cAAa,EAClB,KAAK,SAAQ,EACb,MAAM,KAAK,oBACd,EAED,eAAgB,CACZ,KAAK,MAAM,iBAAkB,KAAK,YAAY,CACjD,EAED,UAAW,CACP,KAAK,MAAM,gBAAiB,KAAK,IAAI,0CAA0C,CAAC,CACnF,EAED,MAAM,oBAAqB,CACvB,KAAK,UAAY,GAEjB,KAAK,eAAiB,MAAM,KAAK,uBAAuB,UAAU,qBAAqB,EACvF,KAAK,eAAe,gCAAgC,EAAI,QACxD,MAAME,EAAS,KAAK,eAAe,qCAAqC,GAEpEA,IAAW,QAAaA,IAAW,MACnC,KAAK,eAAe,qCAAqC,EAAI,SAGjE,KAAK,UAAY,EACpB,EAED,oBAAqB,CACjB,YAAK,UAAY,GAEV,KAAK,uBACP,WAAW,KAAK,cAAc,EAC9B,KAAK,IAAM,CACR,KAAK,MAAM,eAAgB,KAAK,UAAU,EAC1C,KAAK,UAAY,EACrC,CAAiB,EACA,MAAM,IAAM,CACT,KAAK,UAAY,EACrC,CAAiB,CACR,CACJ,CACL"}