{"version":3,"file":"index-DFymPUxI.js","sources":["../../../app/administration/src/app/component/structure/sw-language-switch/sw-language-switch.html.twig","../../../app/administration/src/app/component/structure/sw-language-switch/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_language_switch %}\n<div class=\"sw-language-switch\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_language_switch_modal %}\n    <sw-modal\n        v-if=\"showUnsavedChangesModal\"\n        :title=\"$tc('sw-language-switch.titleModalUnsavedChanges')\"\n        variant=\"small\"\n        @modal-close=\"onCloseChangesModal\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_language_switch_message %}\n        <p>{{ $tc('sw-language-switch.messageModalUnsavedChanges') }}</p>\n        {% endblock %}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_language_switch_footer %}\n        <template #modal-footer>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_language_switch_footer_button_close %}\n            <sw-button\n                id=\"sw-language-switch-close-button\"\n                size=\"small\"\n                @click=\"onCloseChangesModal\"\n            >\n                {{ $tc('global.default.cancel') }}\n            </sw-button>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_language_switch_footer_button_revert %}\n            <sw-button\n                id=\"sw-language-switch-revert-changes-button\"\n                size=\"small\"\n                @click=\"onClickRevertUnsavedChanges\"\n            >\n                {{ $tc('sw-language-switch.titleModalButtonRevertUnsavedChanges') }}\n            </sw-button>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_language_switch_footer_button_save %}\n            <sw-button\n                id=\"sw-language-switch-save-changes-button\"\n                v-tooltip=\"{\n                    message: $tc('sw-privileges.tooltip.warning'),\n                    disabled: allowEdit,\n                    showOnDisabledElements: true\n                }\"\n                variant=\"primary\"\n                :disabled=\"!allowEdit || undefined\"\n                size=\"small\"\n                @click=\"onClickSaveChanges\"\n            >\n                {{ $tc('global.default.save') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_language_switch_select %}\n    <sw-entity-single-select\n        id=\"language\"\n        class=\"sw-language-switch__select\"\n        entity=\"language\"\n        :disabled=\"disabled || undefined\"\n        :criteria=\"languageCriteria\"\n        size=\"medium\"\n        required\n        :value=\"languageId\"\n        :result-limit=\"Infinity\"\n        @update:value=\"onInput\"\n    />\n    {% endblock %}\n</div>\n{% endblock %}\n","import template from './sw-language-switch.html.twig';\nimport './sw-language-switch.scss';\n\nconst { Component } = Cicada;\nconst { warn } = Cicada.Utils.debug;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @package admin\n *\n * @private\n * @description\n * Renders a language switcher.\n * @status ready\n * @example-type code-only\n * @component-example\n * <sw-language-switch></sw-language-switch>\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nComponent.register('sw-language-switch', {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    emits: ['on-change'],\n\n    props: {\n        disabled: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n        changeGlobalLanguage: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n        abortChangeFunction: {\n            type: Function,\n            required: false,\n            default: () => {},\n        },\n        saveChangesFunction: {\n            type: Function,\n            required: false,\n            default: () => {},\n        },\n        savePermission: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n        allowEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            languageId: '',\n            lastLanguageId: '',\n            newLanguageId: '',\n            showUnsavedChangesModal: false,\n        };\n    },\n\n    computed: {\n        languageCriteria() {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addSorting(Criteria.sort('name', 'ASC', false));\n\n            return criteria;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    unmounted() {\n        this.destroyedComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.languageId = Cicada.Context.api.languageId;\n            this.lastLanguageId = this.languageId;\n\n            if (this.isCompatEnabled('INSTANCE_EVENT_EMITTER')) {\n                this.$root.$on('on-change-language-clicked', this.changeToNewLanguage);\n            } else {\n                Cicada.Utils.EventBus.on('on-change-language-clicked', this.changeToNewLanguage);\n            }\n        },\n\n        destroyedComponent() {\n            if (this.isCompatEnabled('INSTANCE_EVENT_EMITTER')) {\n                this.$root.$off('on-change-language-clicked', this.changeToNewLanguage);\n            } else {\n                Cicada.Utils.EventBus.off('on-change-language-clicked', this.changeToNewLanguage);\n            }\n        },\n\n        onInput(newLanguageId) {\n            this.languageId = newLanguageId;\n            this.newLanguageId = newLanguageId;\n\n            this.checkAbort();\n        },\n\n        checkAbort() {\n            // Check if abort function exists und reset the select field if the change should be aborted\n            if (typeof this.abortChangeFunction === 'function' && this.savePermission) {\n                if (\n                    this.abortChangeFunction({\n                        oldLanguageId: this.lastLanguageId,\n                        newLanguageId: this.languageId,\n                    })\n                ) {\n                    this.showUnsavedChangesModal = true;\n                    this.languageId = this.lastLanguageId;\n\n                    return;\n                }\n            }\n\n            this.emitChange();\n        },\n\n        emitChange() {\n            this.lastLanguageId = this.languageId;\n\n            if (this.changeGlobalLanguage) {\n                Cicada.State.commit('context/setApiLanguageId', this.languageId);\n                if (this.isCompatEnabled('INSTANCE_EVENT_EMITTER')) {\n                    this.$root.$emit('on-change-application-language', {\n                        languageId: this.languageId,\n                    });\n                } else {\n                    Cicada.Utils.EventBus.emit('sw-language-switch-change-application-language', {\n                        languageId: this.languageId,\n                    });\n                }\n            }\n\n            this.$emit('on-change', this.languageId);\n        },\n\n        onCloseChangesModal() {\n            this.showUnsavedChangesModal = false;\n            this.newLanguageId = '';\n        },\n\n        onClickSaveChanges() {\n            let save = {};\n            // Check if save function exists and wait for it before changing the language\n            if (typeof this.saveChangesFunction === 'function') {\n                save = this.saveChangesFunction();\n            } else {\n                warn('sw-language-switch', 'You need to implement an own save function to save the changes!');\n            }\n            return Promise.resolve(save).then(() => {\n                this.changeToNewLanguage();\n                this.onCloseChangesModal();\n            });\n        },\n\n        onClickRevertUnsavedChanges() {\n            this.changeToNewLanguage();\n            this.onCloseChangesModal();\n        },\n\n        changeToNewLanguage(languageId) {\n            if (languageId) {\n                this.newLanguageId = languageId;\n            }\n            this.languageId = this.newLanguageId;\n            this.newLanguageId = '';\n            this.emitChange();\n        },\n    },\n});\n"],"names":["template","Component","warn","Criteria","criteria","newLanguageId","save","languageId"],"mappings":"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"}