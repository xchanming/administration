{"version":3,"file":"index-BSJufXXe.js","sources":["../../../app/administration/src/module/sw-import-export/component/sw-import-export-exporter/sw-import-export-exporter.html.twig","../../../app/administration/src/module/sw-import-export/component/sw-import-export-exporter/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_import_export_exporter %}\n<div class=\"sw-import-export-exporter\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_import_export_exporter_header %}\n    <h2>{{ $tc('sw-import-export.importer.selectProfileLabel') }}</h2>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_import_export_exporter_profile_select %}\n    <sw-entity-single-select\n        class=\"sw-import-export-exporter__profile-select\"\n        :disabled=\"isLoading\"\n        :label=\"$tc('sw-import-export.importer.profileLabel')\"\n        :criteria=\"profileCriteria\"\n        entity=\"import_export_profile\"\n        label-property=\"label\"\n        :value=\"selectedProfileId\"\n        required\n        show-clearable-button\n        @update:value=\"onProfileSelect\"\n    />\n    {% endblock %}\n\n    <template v-if=\"selectedProfile && selectedProfile.sourceEntity === 'product'\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_import_export_exporter_profile_select_product_variants_switch %}\n        <sw-switch-field\n            v-model:value=\"config.parameters.includeVariants\"\n            class=\"sw-import-export-exporter__variants-switch-field\"\n            :label=\"$tc('sw-import-export.exporter.exportVariants')\"\n        />\n        {% endblock %}\n    </template>\n\n    <template v-if=\"showProductVariantsInfo\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_import_export_exporter_product_variants_warning %}\n        <sw-alert\n            variant=\"warning\"\n            class=\"sw-import-export-exporter__variants-warning\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_import_export_exporter_product_variants_warning_text %}\n            <p>\n                <span v-html=\"$tc('sw-import-export.exporter.variantsWarning')\"></span>\n            </p>\n            <p>\n                <a\n                    href=\"#\"\n                    class=\"sw-import-export-exporter__link\"\n                    @click.prevent=\"setExportModalProfile('product_configurator_setting')\"\n                >\n                    {{ $tc('sw-import-export.exporter.directExportVariantsLabel') }}\n                </a>\n                <br>\n                <a\n                    href=\"#\"\n                    class=\"sw-import-export-exporter__link\"\n                    @click.prevent=\"setExportModalProfile('property_group_option')\"\n                >\n                    {{ $tc('sw-import-export.exporter.directExportPropertiesLabel') }}\n                </a>\n            </p>\n            {% endblock %}\n        </sw-alert>\n        {% endblock %}\n    </template>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_import_export_exporter_modal %}\n    <sw-modal\n        v-if=\"exportModalProfile\"\n        :title=\"$tc('sw-import-export.exporter.exportLabel')\"\n        @modal-close=\"setExportModalProfile(null)\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_import_export_exporter_modal_exporter %}\n        <sw-import-export-exporter\n            :source-entity=\"exportModalProfile\"\n            @export-started=\"$emit('export-started', $event)\"\n        />\n        {% endblock %}\n\n        <template #modal-footer>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_import_export_exporter_modal_footer %}\n            <sw-button\n                size=\"small\"\n                @click=\"setExportModalProfile(null)\"\n            >\n                {{ $tc('sw-import-export.exporter.close') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n    </sw-modal>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_import_export_exporter_progress %}\n    <sw-import-export-progress\n        activity-type=\"export\"\n        :disable-button=\"disableExporting\"\n        @process-start=\"onStartProcess\"\n    />\n    {% endblock %}\n\n</div>\n{% endblock %}\n","/**\n * @package services-settings\n */\nimport template from './sw-import-export-exporter.html.twig';\nimport './sw-import-export-exporter.scss';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @private\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'importExport',\n        'repositoryFactory',\n        'feature',\n    ],\n\n    emits: ['export-started'],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        sourceEntity: {\n            type: String,\n            required: false,\n            default: '',\n        },\n    },\n\n    data() {\n        return {\n            selectedProfileId: null,\n            selectedProfile: null,\n            config: {\n                parameters: {},\n            },\n            isLoading: false,\n            exportModalProfile: null,\n        };\n    },\n\n    computed: {\n        profileCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('label'));\n\n            if (this.sourceEntity.length > 0) {\n                criteria.addFilter(Criteria.equals('sourceEntity', this.sourceEntity));\n            }\n            criteria.addFilter(Criteria.not('AND', [Criteria.equals('type', 'import')]));\n\n            return criteria;\n        },\n\n        disableExporting() {\n            return this.isLoading || this.selectedProfileId === null;\n        },\n\n        showProductVariantsInfo() {\n            return (\n                this.selectedProfile &&\n                this.selectedProfile.sourceEntity === 'product' &&\n                this.config &&\n                this.config.parameters &&\n                this.config.parameters.includeVariants\n            );\n        },\n\n        logRepository() {\n            return this.repositoryFactory.create('import_export_log');\n        },\n    },\n\n    methods: {\n        onProfileSelect(profileId, profile) {\n            this.selectedProfileId = profileId;\n            this.selectedProfile = profile;\n        },\n\n        onStartProcess() {\n            this.isLoading = true;\n\n            this.importExport.export(this.selectedProfileId, this.handleProgress, this.config).catch((error) => {\n                if (!error.response || !error.response.data || !error.response.data.errors) {\n                    this.createNotificationError({\n                        message: error.message,\n                    });\n                } else {\n                    error.response.data.errors.forEach((singleError) => {\n                        this.createNotificationError({\n                            message: `${singleError.code}: ${singleError.detail}`,\n                        });\n                    });\n                }\n\n                this.isLoading = false;\n            });\n        },\n\n        handleProgress(log) {\n            this.createNotificationInfo({\n                message: this.$tc('sw-import-export.exporter.messageExportStarted'),\n            });\n\n            this.isLoading = false;\n            this.$emit('export-started', log);\n        },\n\n        setExportModalProfile(profileName) {\n            this.exportModalProfile = profileName;\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","index","criteria","profileId","profile","error","singleError","log","profileName"],"mappings":"AAAA,MAAeA,EAAA,ihFCMT,CAAE,MAAAC,CAAO,EAAG,OACZ,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAKbC,EAAA,CACX,SAAAH,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,eACA,oBACA,SACH,EAED,MAAO,CAAC,gBAAgB,EAExB,OAAQ,CACJC,EAAM,UAAU,cAAc,CACjC,EAED,MAAO,CACH,aAAc,CACV,KAAM,OACN,SAAU,GACV,QAAS,EACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,kBAAmB,KACnB,gBAAiB,KACjB,OAAQ,CACJ,WAAY,CAAE,CACjB,EACD,UAAW,GACX,mBAAoB,IAChC,CACK,EAED,SAAU,CACN,iBAAkB,CACd,MAAMG,EAAW,IAAIF,EAAS,EAAG,EAAE,EACnC,OAAAE,EAAS,WAAWF,EAAS,KAAK,OAAO,CAAC,EAEtC,KAAK,aAAa,OAAS,GAC3BE,EAAS,UAAUF,EAAS,OAAO,eAAgB,KAAK,YAAY,CAAC,EAEzEE,EAAS,UAAUF,EAAS,IAAI,MAAO,CAACA,EAAS,OAAO,OAAQ,QAAQ,CAAC,CAAC,CAAC,EAEpEE,CACV,EAED,kBAAmB,CACf,OAAO,KAAK,WAAa,KAAK,oBAAsB,IACvD,EAED,yBAA0B,CACtB,OACI,KAAK,iBACL,KAAK,gBAAgB,eAAiB,WACtC,KAAK,QACL,KAAK,OAAO,YACZ,KAAK,OAAO,WAAW,eAE9B,EAED,eAAgB,CACZ,OAAO,KAAK,kBAAkB,OAAO,mBAAmB,CAC3D,CACJ,EAED,QAAS,CACL,gBAAgBC,EAAWC,EAAS,CAChC,KAAK,kBAAoBD,EACzB,KAAK,gBAAkBC,CAC1B,EAED,gBAAiB,CACb,KAAK,UAAY,GAEjB,KAAK,aAAa,OAAO,KAAK,kBAAmB,KAAK,eAAgB,KAAK,MAAM,EAAE,MAAOC,GAAU,CAC5F,CAACA,EAAM,UAAY,CAACA,EAAM,SAAS,MAAQ,CAACA,EAAM,SAAS,KAAK,OAChE,KAAK,wBAAwB,CACzB,QAASA,EAAM,OACvC,CAAqB,EAEDA,EAAM,SAAS,KAAK,OAAO,QAASC,GAAgB,CAChD,KAAK,wBAAwB,CACzB,QAAS,GAAGA,EAAY,IAAI,KAAKA,EAAY,MAAM,EAC/E,CAAyB,CACzB,CAAqB,EAGL,KAAK,UAAY,EACjC,CAAa,CACJ,EAED,eAAeC,EAAK,CAChB,KAAK,uBAAuB,CACxB,QAAS,KAAK,IAAI,gDAAgD,CAClF,CAAa,EAED,KAAK,UAAY,GACjB,KAAK,MAAM,iBAAkBA,CAAG,CACnC,EAED,sBAAsBC,EAAa,CAC/B,KAAK,mBAAqBA,CAC7B,CACJ,CACL"}