const r=`{% block sw_media_preview_v2 %} <div v-tooltip.bottom="{ message: mediaName, disabled: hideTooltip }" class="sw-media-preview-v2" :class="mediaPreviewClasses" > {% block sw_media_preview_v2_no_media %} <template v-if="!source"> {% block sw_media_preview_v2_no_media_icon %} <sw-icon name="regular-image" size="16px" /> {% endblock %} </template> {% endblock %} {% block sw_media_preview_v2_file_types %} <template v-else> {% block sw_media_preview_v2_file_type_check %} <template v-if="mimeTypeGroup === 'image'"> {% block sw_media_preview_v2_file_type_image %} <img v-if="!imagePreviewFailed" class="sw-media-preview-v2__item" :class="transparencyClass" :src="previewUrl" :alt="alt" :srcset="sourceSet" :sizes="\`\${width}px\`" :draggable="false" @click="$emit('click')" @error="showEvent" > <img v-else class="sw-media-preview-v2__item sw-media-preview-v2__placeholder" :src="assetFilter(placeholderIconPath)" :alt="mimeType" > <sw-icon v-if="mediaIsPrivate && lockIsVisible" class="sw-media-preview-v2__locked-icon sw-icon--small" name="regular-lock" /> {% endblock %} </template> <template v-else-if="isPlayable && mimeTypeGroup === 'video'"> {% block sw_media_preview_v2_file_type_video %} <img v-if="mediaIsPrivate" class="sw-media-preview-v2__item sw-media-preview-v2__placeholder" :src="assetFilter(placeholderIconPath)" :alt="mimeType" > <video :controls="showControls" :autoplay="autoplay" controlsList="nodownload" class="sw-media-preview-v2__item" > <source :src="previewUrl" :type="mimeType" > {{ $tc('global.sw-media-preview-v2.fallbackVideoTagSupport') }} </video> <button v-if="!showControls && !mediaIsPrivate" class="sw-media-preview-v2__play-button" @click="onPlayClick" > <sw-icon class="sw-media-preview-v2__play-icon" name="regular-play" /> </button> <sw-icon v-if="mediaIsPrivate && lockIsVisible" class="sw-media-preview-v2__locked-icon sw-icon--small" name="regular-lock" /> {% endblock %} </template> <template v-else-if="isPlayable && mimeTypeGroup === 'audio'"> {% block sw_media_preview_v2_file_type_audio %} <img class="sw-media-preview-v2__item sw-media-preview-v2__placeholder" :src="assetFilter(placeholderIconPath)" :alt="mimeType" > <audio :controls="showControls" :autoplay="autoplay" controlsList="nodownload" class="sw-media-preview-v2__item sw-media-preview-v2__item--audio" > <source :src="previewUrl" :type="mimeType" > {{ $tc('global.sw-media-preview-v2.fallbackAudioTagSupport') }} </audio> <button v-if="!showControls" class="sw-media-preview-v2__play-button" @click="onPlayClick" > <sw-icon class="sw-media-preview-v2__play-icon" name="regular-play" /> </button> <sw-icon v-if="mediaIsPrivate && lockIsVisible" class="sw-media-preview-v2__locked-icon sw-icon--small" name="regular-lock" /> {% endblock %} </template> <template v-else-if="(isUrl || isRelativePath) && !urlPreviewFailed"> <img :src="previewUrl" class="sw-media-preview-v2__item" :draggable="false" :alt="mimeType" @error="removeUrlPreview" > </template> <template v-else> {% block sw_media_preview_v2_file_type_placeholder %} <img class="sw-media-preview-v2__item sw-media-preview-v2__placeholder" :src="assetFilter(placeholderIconPath)" :alt="mimeType" > {% endblock %} <sw-icon v-if="mediaIsPrivate && lockIsVisible" class="sw-media-preview-v2__locked-icon sw-icon--small" name="regular-lock" /> </template> {% endblock %} </template> {% endblock %} </div> {% endblock %}`,{Context:a,Filter:t}=Cicada,{fileReader:o}=Cicada.Utils,c={template:r,compatConfig:Cicada.compatConfig,inject:["repositoryFactory","feature"],emits:["click","media-preview-play"],playableVideoFormats:["video/mp4","video/ogg","video/webm"],playableAudioFormats:["audio/mp3","audio/mpeg","audio/ogg","audio/wav"],placeholderThumbnailsBasePath:"/administration/static/img/media-preview/",placeHolderThumbnails:{application:{"adobe.illustrator":"icons-multicolor-file-thumbnail-ai",illustrator:"icons-multicolor-file-thumbnail-ai",postscript:"icons-multicolor-file-thumbnail-ai",msword:"icons-multicolor-file-thumbnail-doc","vnd.openxmlformats-officedocument.wordprocessingml.document":"icons-multicolor-file-thumbnail-doc",pdf:"icons-multicolor-file-thumbnail-pdf","vnd.ms-excel":"icons-multicolor-file-thumbnail-xls","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"icons-multicolor-file-thumbnail-xls","vnd.ms-powerpoint":"icons-multicolor-file-thumbnail-ppt","vnd.openxmlformats-officedocument.presentationml.presentation":"icons-multicolor-file-thumbnail-ppt",glb:"icons-multicolor-file-thumbnail-glb","octet-stream":"icons-multicolor-file-thumbnail-glb"},video:{"x-msvideo":"icons-multicolor-file-thumbnail-avi",quicktime:"icons-multicolor-file-thumbnail-mov",mp4:"icons-multicolor-file-thumbnail-mp4"},text:{csv:"icons-multicolor-file-thumbnail-csv",plain:"icons-multicolor-file-thumbnail-csv"},image:{gif:"icons-multicolor-file-thumbnail-gif",jpeg:"icons-multicolor-file-thumbnail-jpg","svg+xml":"icons-multicolor-file-thumbnail-svg"},model:{"gltf-binary":"icons-multicolor-file-thumbnail-glb"}},props:{source:{required:!0},showControls:{type:Boolean,required:!1,default:!1},autoplay:{type:Boolean,required:!1,default:!1},transparency:{type:Boolean,required:!1,default:!0},useThumbnails:{type:Boolean,required:!1,default:!0},hideTooltip:{type:Boolean,required:!1,default:!0},mediaIsPrivate:{type:Boolean,required:!1,default:!1}},data(){return{trueSource:null,width:0,dataUrl:"",urlPreviewFailed:!1,imagePreviewFailed:!1}},computed:{mediaRepository(){return this.repositoryFactory.create("media")},mediaPreviewClasses(){return{"is--icon":this.isIcon,"is--no-media":!this.source}},transparencyClass(){return{"shows--transparency":this.canBeTransparent}},canBeTransparent(){return this.transparency?this.isIcon||this.mimeTypeGroup==="image":!1},mimeType(){return this.trueSource?this.trueSource instanceof File?this.trueSource.type:this.trueSource instanceof URL?"application/octet-stream":this.trueSource.mimeType:""},mimeTypeGroup(){return this.mimeType?this.mimeType.split("/")[0]:""},isPlayable(){return this.$options.playableVideoFormats.includes(this.mimeType)?!0:this.$options.playableAudioFormats.includes(this.mimeType)},isIcon(){return/.*svg.*/.test(this.mimeType)},placeholderIcon(){if(!this.mimeType)return"icons-multicolor-file-thumbnail-broken";const e=this.$options.placeHolderThumbnails[this.mimeTypeGroup];if(e){const i=e[`${this.mimeType.split("/")[1]}`];if(i)return i}return"icons-multicolor-file-thumbnail-normal"},placeholderIconPath(){return`${this.$options.placeholderThumbnailsBasePath}${this.placeholderIcon}.svg`},lockIsVisible(){return this.width>40},previewUrl(){return this.isFile?(this.getDataUrlFromFile(),this.dataUrl):this.isUrl?this.trueSource.href:this.isRelativePath?this.trueSource:this.trueSource.url},isUrl(){return this.trueSource instanceof URL},isFile(){return this.trueSource instanceof File},isRelativePath(){return typeof this.trueSource=="string"},alt(){return this.trueSource.alt?this.trueSource.alt:this.trueSource.fileName},mediaName(){return this.trueSource?this.mediaNameFilter(this.trueSource,this.trueSource.fileName):this.$tc("global.sw-media-preview-v2.textNoMedia")},mediaNameFilter(){return t.getByName("mediaName")},assetFilter(){return t.getByName("asset")},sourceSet(){if(this.isFile||this.isUrl||this.trueSource.thumbnails.length===0)return"";const e=[];return this.trueSource.thumbnails.forEach(i=>{const l=i.url,s=encodeURI(l);e.push(`${s} ${i.width}w`)}),e.join(", ")}},watch:{source(){this.urlPreviewFailed=!1,this.imagePreviewFailed=!1,this.fetchSourceIfNecessary()}},created(){this.createdComponent()},mounted(){this.mountedComponent()},methods:{createdComponent(){this.fetchSourceIfNecessary()},mountedComponent(){this.width=this.$el.offsetWidth},async fetchSourceIfNecessary(){if(this.source){if(typeof this.source!="string"){this.trueSource=this.source[0]??this.source;return}try{this.trueSource=await this.mediaRepository.get(this.source,a.api)}catch{this.trueSource=this.source}}},onPlayClick(e){e.shiftKey||e.ctrlKey||(e.stopPropagation(),this.$emit("media-preview-play",{originalDomEvent:e,item:this.trueSource}))},async getDataUrlFromFile(){this.mimeTypeGroup==="image"&&(this.dataUrl=await o.readAsDataURL(this.trueSource))},removeUrlPreview(){this.urlPreviewFailed=!0},showEvent(){this.isFile||(this.imagePreviewFailed=!0)}}};export{c as default};
//# sourceMappingURL=index-BsLs1F2X.js.map
