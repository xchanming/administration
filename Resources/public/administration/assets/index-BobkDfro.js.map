{"version":3,"file":"index-BobkDfro.js","sources":["../../../app/administration/src/app/asyncComponent/media/sw-sidebar-media-item/sw-sidebar-media-item.html.twig","../../../app/administration/src/app/asyncComponent/media/sw-sidebar-media-item/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_sidebar_media_item %}\n<sw-sidebar-item\n    ref=\"sidebarItem\"\n    class=\"sw-sidebar-media-item\"\n    icon=\"regular-image\"\n    :title=\"$tc('global.sw-sidebar-media-item.title')\"\n    :disabled=\"disabled\"\n    v-on=\"additionalEventListeners\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_sidebar_media_item_content %}\n    <div class=\"sw-sidebar-media-item__content\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_search_field %}\n        <sw-simple-search-field\n            v-model:value=\"term\"\n            @search-term-change=\"onSearchTermChange\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_folder_navigation %}\n        <sw-media-breadcrumbs\n            v-if=\"!term.length\"\n            v-model:currentFolderId=\"mediaFolderId\"\n            small\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_media_item_list %}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_media_item_list_folder_item %}\n        <!-- eslint-disable vue/no-use-v-if-with-v-for -->\n        <sw-media-folder-item\n            v-for=\"folder in subFolders\"\n            v-if=\"!term.length\"\n            :key=\"folder.id\"\n            :item=\"folder\"\n            :show-selection-indicator=\"false\"\n            :show-context-menu-button=\"true\"\n            :selected=\"false\"\n            :is-list=\"true\"\n            @media-item-click=\"onNavigateToFolder(folder.id)\"\n            @media-folder-delete=\"handleFolderGridItemDelete\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_media_item_list_media_item %}\n        <sw-media-media-item\n            v-for=\"mediaItem in mediaItems\"\n            :key=\"mediaItem.id\"\n            v-draggable=\"{ dragGroup: 'media', data: { mediaItem } }\"\n            :item=\"mediaItem\"\n            :show-selection-indicator=\"false\"\n            :show-context-menu-button=\"true\"\n            :selected=\"false\"\n            :is-list=\"true\"\n            @media-item-delete=\"handleMediaGridItemDelete\"\n        >\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sidebar_media_item_context_items %}\n            <slot\n                name=\"context-menu-items\"\n                :media-item=\"mediaItem\"\n            ></slot>\n        {% endblock %}\n        </sw-media-media-item>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_load_more_button %}\n        <sw-button\n            v-if=\"showMore\"\n            size=\"small\"\n            block\n            class=\"sw-sidebar-media-item__load-more-button\"\n            @click=\"onLoadMore\"\n        >\n\n            {{ $tc('global.sw-sidebar-media-item.labelLoadMore') }}\n        </sw-button>\n        {% endblock %}\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sidebar_media_item_loader %}\n        <sw-loader v-if=\"isLoading\" />\n        {% endblock %}\n    </div>\n    {% endblock %}\n</sw-sidebar-item>\n{% endblock %}\n","import template from './sw-sidebar-media-item.html.twig';\nimport './sw-sidebar-media-item.scss';\n\nconst { Context } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @status ready\n * @description The <u>sw-sidebar-media-item</u> component is used everywhere you need media objects outside the media\n * manager. Use the additional properties to filter the shown media.\n * @package content\n * @example-type code-only\n * @component-example\n * <sw-sidebar-media-item>\n *    <template #context-menu-items=\"media\">\n *       <sw-context-menu-item @click=\"onAddItemToProduct(media.mediaItem)\">\n *          Lorem ipsum dolor sit amet\n *       </sw-context-menu-item>\n *    </template>\n * </sw-sidebar-media-item>\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['repositoryFactory'],\n\n    props: {\n        initialFolderId: {\n            type: String,\n            required: false,\n            default: null,\n        },\n        isParentLoading: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n        disabled: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            isLoading: true,\n            mediaFolderId: this.initialFolderId,\n            mediaItems: [],\n            subFolders: [],\n            page: 1,\n            limit: 25,\n            total: 0,\n            term: '',\n        };\n    },\n\n    computed: {\n        mediaRepository() {\n            return this.repositoryFactory.create('media');\n        },\n\n        mediaFolderRepository() {\n            return this.repositoryFactory.create('media_folder');\n        },\n\n        showMore() {\n            return this.itemsLoaded < this.total;\n        },\n\n        itemsLoaded() {\n            return this.mediaItems.length;\n        },\n\n        additionalEventListeners() {\n            if (this.isCompatEnabled('INSTANCE_LISTENERS')) {\n                return this.$listeners;\n            }\n\n            return {};\n        },\n    },\n\n    watch: {\n        initialFolderId() {\n            this.mediaFolderId = this.initialFolderId;\n        },\n\n        mediaFolderId() {\n            this.initializeContent();\n        },\n\n        isParentLoading() {\n            this.getList();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.initializeContent();\n        },\n\n        onSearchTermChange(searchTerm) {\n            this.term = searchTerm;\n            this.page = 1;\n            this.getList();\n        },\n\n        initializeContent() {\n            if (this.disabled) {\n                return;\n            }\n            this.page = 1;\n            this.term = '';\n            this.mediaItems = [];\n            this.getSubFolders();\n            this.getList();\n        },\n\n        async getSubFolders() {\n            const criteria = new Criteria(1, 50);\n            criteria.addFilter(Criteria.equals('parentId', this.mediaFolderId));\n\n            const folder = await this.mediaFolderRepository.search(criteria, Context.api);\n            this.subFolders = folder;\n            return folder;\n        },\n\n        handleFolderGridItemDelete() {\n            this.getSubFolders();\n        },\n\n        handleMediaGridItemDelete() {\n            const pages = this.page;\n            this.page = 1;\n            this.getList().then(() => {\n                while (this.page < pages) {\n                    this.page += 1;\n                    this.extendList();\n                }\n            });\n        },\n\n        onLoadMore() {\n            this.page += 1;\n            this.extendList();\n        },\n\n        async extendList() {\n            const criteria = this.getListingCriteria();\n\n            const searchResult = await this.mediaRepository.search(criteria, Context.api);\n            this.mediaItems = this.mediaItems.concat(searchResult);\n\n            return this.mediaItems;\n        },\n\n        async getList() {\n            if (this.isParentLoading === true) {\n                return null;\n            }\n\n            this.isLoading = true;\n\n            const criteria = this.getListingCriteria();\n\n            this.mediaItems = await this.mediaRepository.search(criteria, Context.api);\n            this.total = this.mediaItems.total;\n            this.isLoading = false;\n\n            return this.mediaItems;\n        },\n\n        getListingCriteria() {\n            const criteria = new Criteria(this.page, this.limit);\n\n            if (!this.term.length) {\n                criteria.addFilter(Criteria.equals('mediaFolderId', this.mediaFolderId));\n            }\n\n            if (this.term) {\n                criteria.term = this.term;\n            }\n\n            criteria.addSorting(Criteria.sort('uploadedAt', 'DESC'));\n\n            return criteria;\n        },\n\n        openContent() {\n            this.$refs.sidebarItem.openContent();\n        },\n\n        onNavigateToFolder(folderId) {\n            this.mediaFolderId = folderId;\n        },\n    },\n};\n"],"names":["template","Context","Criteria","index","searchTerm","criteria","folder","pages","searchResult","folderId"],"mappings":"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"}