const s=`{% block sw_order_create_details_footer %} <sw-container class="sw-order-create-details-footer" columns="minmax(min-content, 1fr) minmax(min-content, 1fr)" gap="0 32px" > <div> {% block sw_order_create_details_footer_sales_channel %} <sw-entity-single-select v-model:value="salesChannelId" disabled size="small" entity="sales_channel" class="sw-order-create-details-footer__item" :label="$tc('sw-order.createBase.detailsFooter.labelSalesChannel')" :placeholder="$tc('sw-order.createBase.detailsFooter.placeholderSalesChannel')" show-clearable-button /> {% endblock %} {% block sw_order_create_details_footer_payment_method %} <sw-entity-single-select v-model:value="context.paymentMethodId" size="small" entity="payment_method" label-property="distinguishableName" class="sw-order-create-details-footer__item" :disabled="!isCustomerActive" :criteria="paymentMethodCriteria" :label="$tc('sw-order.createBase.detailsFooter.labelPaymentMethod')" :help-text="$tc('sw-order.createBase.detailsFooter.helpTextPaymentMethod')" :placeholder="$tc('sw-order.createBase.detailsFooter.placeholderPaymentMethod')" show-clearable-button /> {% endblock %} {% block sw_order_create_details_footer_shipping_method %} <sw-entity-single-select v-model:value="context.shippingMethodId" size="small" entity="shipping_method" class="sw-order-create-details-footer__item" :disabled="!isCustomerActive" :criteria="salesChannelCriteria" :label="$tc('sw-order.createBase.detailsFooter.labelShippingMethod')" :placeholder="$tc('sw-order.createBase.detailsFooter.placeholderShippingMethod')" /> {% endblock %} </div> <div> {% block sw_order_create_details_footer_order_language %} <sw-entity-single-select v-model:value="context.languageId" size="small" entity="language" class="sw-order-create-details-footer__item" :disabled="!isCustomerActive" :criteria="salesChannelCriteria" :label="$tc('sw-order.createBase.detailsFooter.labelOrderLanguage')" :placeholder="$tc('sw-order.createBase.detailsFooter.placeholderOrderLanguage')" show-clearable-button /> {% endblock %} {% block sw_order_create_details_footer_currency %} <sw-entity-single-select v-model:value="context.currencyId" size="small" entity="currency" class="sw-order-create-details-footer__item" :disabled="!isCustomerActive" :criteria="salesChannelCriteria" :label="$tc('sw-order.createBase.detailsFooter.labelCurrency')" :placeholder="$tc('sw-order.createBase.detailsFooter.placeholderCurrency')" show-clearable-button /> {% endblock %} </div> </sw-container> {% endblock %}`,{Store:t,Service:l}=Shopware,{Criteria:r}=Shopware.Data,n={template:s,inject:{swOrderDetailOnLoadingChange:{from:"swOrderDetailOnLoadingChange",default:null}},emits:["loading-change"],props:{cart:{type:Object,required:!0},customer:{type:Object,default:null},isCustomerActive:{type:Boolean,default:!1}},computed:{context:{get(){return this.customer?this.customer.salesChannel:{}},set(e){this.customer&&(this.customer.salesChannel=e)}},salesChannelId:{get(){return this.customer?this.customer.salesChannelId:null},set(e){this.customer&&(this.customer.salesChannelId=e)}},salesChannelCriteria(){const e=new r(1,25);return this.salesChannelId&&e.addFilter(r.equals("salesChannels.id",this.salesChannelId)),e},paymentMethodCriteria(){const e=new r(1,25);return this.salesChannelId&&e.addFilter(r.equals("salesChannels.id",this.salesChannelId)),e.addFilter(r.equals("afterOrderEnabled",1)),e},currencyRepository(){return l("repositoryFactory").create("currency")},currentCurrencyId(){return t.get("swOrder").currencyId},defaultSalesChannel(){return t.get("swOrder").defaultSalesChannel},isCartTokenAvailable(){return t.get("swOrder").isCartTokenAvailable}},watch:{context:{immediate:!0,deep:!0,handler(){!this.customer||!this.cart.token||(this.updateContext(),this.updateOrderContext())}},isCartTokenAvailable:{immediate:!0,handler(){this.isCartTokenAvailable&&this.customer&&this.updateOrderContext()}}},methods:{updateContext(){["currencyId","languageId","shippingMethodId","paymentMethodId"].forEach(a=>{this.context[a]=this.context[a]||this.defaultSalesChannel[a]})},updateOrderContext(){t.get("swOrder").updateOrderContext({context:this.context,salesChannelId:this.customer.salesChannelId,contextToken:this.cart.token}).then(()=>{this.updateCustomerContext(),this.currentCurrencyId!==this.context.currencyId&&this.getCurrency()})},updateCustomerContext(){t.get("swOrder").updateCustomerContext({customerId:this.customer.id,salesChannelId:this.customer.salesChannelId,contextToken:this.cart.token}).then(e=>{e.status===200&&this.getCart()})},getCart(){this.swOrderDetailOnLoadingChange&&this.swOrderDetailOnLoadingChange(!0),this.$emit("loading-change",!0),t.get("swOrder").getCart({salesChannelId:this.customer.salesChannelId,contextToken:this.cart.token}).finally(()=>{this.swOrderDetailOnLoadingChange&&this.swOrderDetailOnLoadingChange(!1),this.$emit("loading-change",!1)})},getCurrency(){return this.currencyRepository.get(this.context.currencyId).then(e=>{t.get("swOrder").setCurrency(e)})}}};export{n as default};
