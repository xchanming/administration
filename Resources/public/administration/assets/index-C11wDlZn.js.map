{"version":3,"file":"index-C11wDlZn.js","sources":["../../../app/administration/src/module/sw-customer/component/sw-customer-imitate-customer-modal/sw-customer-imitate-customer-modal.html.twig","../../../app/administration/src/module/sw-customer/component/sw-customer-imitate-customer-modal/index.js"],"sourcesContent":["<!-- eslint-disable vuejs-accessibility/click-events-have-key-events -->\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_customer_imitate_customer_modal %}\n<sw-modal\n    :title=\"modalTitle\"\n    class=\"sw-customer-imitate-customer-modal\"\n    @modal-close=\"onCancel\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_customer_imitate_customer_modal_alert %}\n    <sw-alert>\n        <i18n-t\n            keypath=\"sw-customer.imitateCustomerModal.modalInfo\"\n            tag=\"p\"\n        >\n            <template #logout>\n                <b>{{ $tc('sw-customer.imitateCustomerModal.modalInfoLogout') }}</b>\n            </template>\n        </i18n-t>\n    </sw-alert>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_customer_imitate_customer_modal_description %}\n    <div class=\"imitate-customer-modal-description\">\n        {{ modalDescription }}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_customer_imitate_customer_modal_body %}\n    <sw-container\n        class=\"imitate-customer-modal-container\"\n        columns=\"1fr\"\n        gap=\"8px 0px\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_customer_imitate_customer_modal_sales_channel_domain_items %}\n        <sw-context-menu-item\n            v-for=\"salesChannelDomain of salesChannelDomains\"\n            :key=\"salesChannelDomain.id\"\n            target=\"_blank\"\n            @click=\"onSalesChannelDomainMenuItemClick(salesChannelDomain.salesChannelId, salesChannelDomain.url)\"\n        >\n\n            <div\n                class=\"imitate-customer-modal-item-content\"\n                columns=\"1fr 1fr\"\n                gap=\"10px 0px\"\n            >\n                <div class=\"imitate-customer-modal-item-header\">\n                    {{ salesChannelDomain.salesChannel.name }}\n                </div>\n                <div class=\"imitate-customer-modal-item-url\">\n                    {{ salesChannelDomain.url }}\n                </div>\n                <sw-icon\n                    name=\"regular-external-link-s\"\n                    size=\"16px\"\n                />\n            </div>\n        </sw-context-menu-item>\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_customer_imitate_customer_modal_footer %}\n    <template #modal-footer>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        <div>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_customer_imitate_customer_modal_footer_cancel %}\n            <sw-button\n                size=\"small\"\n                @click=\"onCancel\"\n            >\n                {{ $tc('sw-customer.imitateCustomerModal.labelCancel') }}\n            </sw-button>\n            {% endblock %}\n        </div>\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n","import ApiService from 'src/core/service/api.service';\nimport template from './sw-customer-imitate-customer-modal.html.twig';\nimport './sw-customer-imitate-customer-modal.scss';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'contextStoreService',\n    ],\n\n    emits: ['modal-close'],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        customer: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            salesChannelDomains: [],\n        };\n    },\n\n    computed: {\n        modalTitle() {\n            return this.$tc('sw-customer.imitateCustomerModal.modalTitle', {\n                name: this.customer.name,\n            });\n        },\n\n        modalDescription() {\n            return this.$tc('sw-customer.imitateCustomerModal.modalDescription', {\n                name: this.customer.name,\n            });\n        },\n\n        salesChannelDomainRepository() {\n            return this.repositoryFactory.create('sales_channel_domain');\n        },\n\n        currentUser() {\n            return Cicada.State.get('session').currentUser;\n        },\n\n        salesChannelDomainCriteria() {\n            const criteria = new Criteria();\n            criteria.addAssociation('salesChannel');\n            criteria.addFilter(Criteria.equals('salesChannel.typeId', Cicada.Defaults.storefrontSalesChannelTypeId));\n            criteria.addSorting(Criteria.sort('salesChannel.name', 'ASC'));\n            criteria.addSorting(Criteria.sort('languageId', 'DESC'));\n\n            if (this.customer.boundSalesChannelId) {\n                criteria.addFilter(Criteria.equals('salesChannelId', this.customer.boundSalesChannelId));\n            }\n\n            return criteria;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        async createdComponent() {\n            this.fetchSalesChannelDomains();\n        },\n\n        async onSalesChannelDomainMenuItemClick(salesChannelId, salesChannelDomainUrl) {\n            this.contextStoreService\n                .generateImitateCustomerToken(this.customer.id, salesChannelId)\n                .then((response) => {\n                    const handledResponse = ApiService.handleResponse(response);\n\n                    this.contextStoreService.redirectToSalesChannelUrl(\n                        salesChannelDomainUrl,\n                        handledResponse.token,\n                        this.customer.id,\n                        this.currentUser?.id,\n                    );\n                })\n                .catch(() => {\n                    this.createNotificationError({\n                        message: this.$tc('sw-customer.detail.notificationImitateCustomerErrorMessage'),\n                    });\n                });\n        },\n\n        onCancel() {\n            this.$emit('modal-close');\n        },\n\n        fetchSalesChannelDomains() {\n            this.salesChannelDomainRepository\n                .search(this.salesChannelDomainCriteria, Cicada.Context.api)\n                .then((loadedDomains) => {\n                    this.salesChannelDomains = loadedDomains;\n                });\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","index","criteria","salesChannelId","salesChannelDomainUrl","response","handledResponse","ApiService","_a","loadedDomains"],"mappings":"iHAAA,MAAeA,EAAA,2sDCIT,CAAE,MAAAC,CAAO,EAAG,OACZ,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAGbC,EAAA,CACX,SAAAH,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,qBACH,EAED,MAAO,CAAC,aAAa,EAErB,OAAQ,CACJC,EAAM,UAAU,cAAc,CACjC,EAED,MAAO,CACH,SAAU,CACN,KAAM,OACN,SAAU,EACb,CACJ,EAED,MAAO,CACH,MAAO,CACH,oBAAqB,CAAE,CACnC,CACK,EAED,SAAU,CACN,YAAa,CACT,OAAO,KAAK,IAAI,8CAA+C,CAC3D,KAAM,KAAK,SAAS,IACpC,CAAa,CACJ,EAED,kBAAmB,CACf,OAAO,KAAK,IAAI,oDAAqD,CACjE,KAAM,KAAK,SAAS,IACpC,CAAa,CACJ,EAED,8BAA+B,CAC3B,OAAO,KAAK,kBAAkB,OAAO,sBAAsB,CAC9D,EAED,aAAc,CACV,OAAO,OAAO,MAAM,IAAI,SAAS,EAAE,WACtC,EAED,4BAA6B,CACzB,MAAMG,EAAW,IAAIF,EACrB,OAAAE,EAAS,eAAe,cAAc,EACtCA,EAAS,UAAUF,EAAS,OAAO,sBAAuB,OAAO,SAAS,4BAA4B,CAAC,EACvGE,EAAS,WAAWF,EAAS,KAAK,oBAAqB,KAAK,CAAC,EAC7DE,EAAS,WAAWF,EAAS,KAAK,aAAc,MAAM,CAAC,EAEnD,KAAK,SAAS,qBACdE,EAAS,UAAUF,EAAS,OAAO,iBAAkB,KAAK,SAAS,mBAAmB,CAAC,EAGpFE,CACV,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,MAAM,kBAAmB,CACrB,KAAK,yBAAwB,CAChC,EAED,MAAM,kCAAkCC,EAAgBC,EAAuB,CAC3E,KAAK,oBACA,6BAA6B,KAAK,SAAS,GAAID,CAAc,EAC7D,KAAME,GAAa,OAChB,MAAMC,EAAkBC,EAAW,eAAeF,CAAQ,EAE1D,KAAK,oBAAoB,0BACrBD,EACAE,EAAgB,MAChB,KAAK,SAAS,IACdE,EAAA,KAAK,cAAL,YAAAA,EAAkB,EAC1C,CACA,CAAiB,EACA,MAAM,IAAM,CACT,KAAK,wBAAwB,CACzB,QAAS,KAAK,IAAI,4DAA4D,CACtG,CAAqB,CACrB,CAAiB,CACR,EAED,UAAW,CACP,KAAK,MAAM,aAAa,CAC3B,EAED,0BAA2B,CACvB,KAAK,6BACA,OAAO,KAAK,2BAA4B,OAAO,QAAQ,GAAG,EAC1D,KAAMC,GAAkB,CACrB,KAAK,oBAAsBA,CAC/C,CAAiB,CACR,CACJ,CACL"}