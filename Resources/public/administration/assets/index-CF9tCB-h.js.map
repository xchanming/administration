{"version":3,"file":"index-CF9tCB-h.js","sources":["../../../app/administration/src/module/sw-settings-listing/page/sw-settings-listing-option-create/sw-settings-listing-option-create.html.twig","../../../app/administration/src/module/sw-settings-listing/page/sw-settings-listing-option-create/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_listing_option_edit_smart_bar_actions_grid %}\n<sw-settings-listing-option-criteria-grid\n    v-if=\"productSortingEntity\"\n    :product-sorting-entity=\"productSortingEntity\"\n    @criteria-delete=\"onDeleteCriteria\"\n    @criteria-add=\"onAddCriteria\"\n/>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_listing_option_base_language_switch %}\n<!-- eslint-disable vue/valid-v-slot -->\n<template #language-switch>\n    <sw-language-switch\n        :disabled=\"isNewProductSorting\"\n        @on-change=\"onChangeLanguage\"\n    />\n</template>\n{% endblock %}\n","/**\n * @package inventory\n */\nimport '../sw-settings-listing-option-base';\nimport template from './sw-settings-listing-option-create.html.twig';\n\nconst { Criteria } = Cicada.Data;\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    computed: {\n        smartBarHeading() {\n            return this.productSortingEntity && this.productSortingEntity.label\n                ? this.productSortingEntity.label\n                : this.$tc('sw-settings-listing.create.smartBarTitle');\n        },\n\n        isNewProductSorting() {\n            return !this.productSortingEntity || this.productSortingEntity._isNew;\n        },\n\n        urlKeyCriteria() {\n            const criteria = new Criteria(1, 1);\n            criteria.addFilter(Criteria.equals('key', this.productSortingEntity.key));\n            return criteria;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchCustomFields().then(() => {\n                this.productSortingEntity = this.createProductSortingEntity();\n                Cicada.State.commit('context/resetLanguageToDefault');\n            });\n        },\n\n        createProductSortingEntity() {\n            const productSortingEntity = this.productSortingRepository.create();\n            productSortingEntity.fields = [];\n            productSortingEntity.priority = 1;\n            productSortingEntity.active = false;\n\n            return productSortingEntity;\n        },\n\n        async onSave() {\n            this.sortingOptionTechnicalNameError = null;\n            this.sortingOptionLabelError = null;\n\n            this.transformCustomFieldCriterias();\n\n            this.productSortingEntity.fields = this.productSortingEntity.fields.filter((field) => {\n                return field.field !== 'customField';\n            });\n\n            return this.saveProductSorting()\n                .then((response) => {\n                    const encodedResponse = JSON.parse(response.config.data);\n\n                    this.$router.push({\n                        name: 'sw.settings.listing.edit',\n                        params: { id: encodedResponse.id },\n                    });\n\n                    const sortingOptionName = this.productSortingEntity.label;\n\n                    this.createNotificationSuccess({\n                        message: this.$t('sw-settings-listing.base.notification.saveSuccess', { sortingOptionName }),\n                    });\n                })\n                .catch(() => {\n                    const sortingOptionName = this.productSortingEntity.label;\n\n                    this.createNotificationError({\n                        message: this.$t('sw-settings-listing.base.notification.saveError', { sortingOptionName }),\n                    });\n                });\n        },\n\n        onAddCriteria(fieldName) {\n            if (!fieldName) {\n                return;\n            }\n\n            const newCriteria = this.getCriteriaTemplate(fieldName);\n\n            if (!this.productSortingEntity.fields) {\n                this.productSortingEntity.fields = [];\n            }\n\n            this.productSortingEntity.fields.push(newCriteria);\n        },\n\n        onConfirmDeleteCriteria() {\n            // filter out criteria\n            this.productSortingEntity.fields = this.productSortingEntity.fields.filter((currentCriteria) => {\n                return currentCriteria.field !== this.toBeDeletedCriteria.field;\n            });\n\n            // close delete modal\n            this.toBeDeletedCriteria = null;\n        },\n    },\n};\n"],"names":["template","Criteria","index","criteria","productSortingEntity","field","response","encodedResponse","sortingOptionName","fieldName","newCriteria","currentCriteria"],"mappings":"4BAAA,MAAeA,EAAA,sdCMT,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAEbC,EAAA,CACX,SAAAF,EAEA,aAAc,OAAO,aAErB,SAAU,CACN,iBAAkB,CACd,OAAO,KAAK,sBAAwB,KAAK,qBAAqB,MACxD,KAAK,qBAAqB,MAC1B,KAAK,IAAI,0CAA0C,CAC5D,EAED,qBAAsB,CAClB,MAAO,CAAC,KAAK,sBAAwB,KAAK,qBAAqB,MAClE,EAED,gBAAiB,CACb,MAAMG,EAAW,IAAIF,EAAS,EAAG,CAAC,EAClC,OAAAE,EAAS,UAAUF,EAAS,OAAO,MAAO,KAAK,qBAAqB,GAAG,CAAC,EACjEE,CACV,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,oBAAoB,KAAK,IAAM,CAChC,KAAK,qBAAuB,KAAK,6BACjC,OAAO,MAAM,OAAO,gCAAgC,CACpE,CAAa,CACJ,EAED,4BAA6B,CACzB,MAAMC,EAAuB,KAAK,yBAAyB,OAAM,EACjE,OAAAA,EAAqB,OAAS,GAC9BA,EAAqB,SAAW,EAChCA,EAAqB,OAAS,GAEvBA,CACV,EAED,MAAM,QAAS,CACX,YAAK,gCAAkC,KACvC,KAAK,wBAA0B,KAE/B,KAAK,8BAA6B,EAElC,KAAK,qBAAqB,OAAS,KAAK,qBAAqB,OAAO,OAAQC,GACjEA,EAAM,QAAU,aAC1B,EAEM,KAAK,mBAAoB,EAC3B,KAAMC,GAAa,CAChB,MAAMC,EAAkB,KAAK,MAAMD,EAAS,OAAO,IAAI,EAEvD,KAAK,QAAQ,KAAK,CACd,KAAM,2BACN,OAAQ,CAAE,GAAIC,EAAgB,EAAI,CAC1D,CAAqB,EAED,MAAMC,EAAoB,KAAK,qBAAqB,MAEpD,KAAK,0BAA0B,CAC3B,QAAS,KAAK,GAAG,oDAAqD,CAAE,kBAAAA,CAAiB,CAAE,CACnH,CAAqB,CACrB,CAAiB,EACA,MAAM,IAAM,CACT,MAAMA,EAAoB,KAAK,qBAAqB,MAEpD,KAAK,wBAAwB,CACzB,QAAS,KAAK,GAAG,kDAAmD,CAAE,kBAAAA,CAAiB,CAAE,CACjH,CAAqB,CACrB,CAAiB,CACR,EAED,cAAcC,EAAW,CACrB,GAAI,CAACA,EACD,OAGJ,MAAMC,EAAc,KAAK,oBAAoBD,CAAS,EAEjD,KAAK,qBAAqB,SAC3B,KAAK,qBAAqB,OAAS,IAGvC,KAAK,qBAAqB,OAAO,KAAKC,CAAW,CACpD,EAED,yBAA0B,CAEtB,KAAK,qBAAqB,OAAS,KAAK,qBAAqB,OAAO,OAAQC,GACjEA,EAAgB,QAAU,KAAK,oBAAoB,KAC7D,EAGD,KAAK,oBAAsB,IAC9B,CACJ,CACL"}