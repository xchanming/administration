{"version":3,"file":"index-XeWlTsmm.js","sources":["../../../app/administration/src/app/component/rule/condition-type/sw-condition-line-item-custom-field/sw-condition-line-item-custom-field.html.twig","../../../app/administration/src/app/component/rule/condition-type/sw-condition-line-item-custom-field/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_condition_value_content %}\n<div class=\"sw-condition-line-item-custom-field sw-condition__condition-value\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_condition_line_item_custom_field_field %}\n    <sw-entity-single-select\n        ref=\"selectedField\"\n        v-model:value=\"selectedField\"\n        name=\"sw-field--selectedField\"\n        entity=\"custom_field\"\n        :criteria=\"customFieldCriteria\"\n        :placeholder=\"$tc('global.sw-condition.condition.lineItemCustomField.field.customFieldSelect.placeholder')\"\n        :disabled=\"disabled || undefined\"\n        size=\"medium\"\n        show-clearable-button\n        @update:value=\"onFieldChange\"\n    >\n        <template #selection-label-property=\"{ item }\">\n            {{ getInlineSnippet(item.config.label) || item.name }}\n        </template>\n        <template #result-item=\"{ item, index, isSelected, setValue }\">\n            <sw-select-result\n                v-tooltip=\"getTooltipConfig(item)\"\n                :disabled=\"!item.allowCartExpose\"\n                :selected=\"isSelected(item)\"\n                v-bind=\"{ item, index }\"\n                @item-select=\"setValue\"\n            >\n                {{ getInlineSnippet(item.config.label) || item.name }}\n\n                <template #description>\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_condition_line_item_custom_field_field_description %}\n                    {{ truncateFilter((getInlineSnippet(item.customFieldSet.config.label) || item.customFieldSet.name), 20) }}\n                    {% endblock %}\n                </template>\n            </sw-select-result>\n        </template>\n    </sw-entity-single-select>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_condition_line_item_custom_field_operator %}\n    <sw-condition-operator-select\n        v-if=\"renderedField\"\n        name=\"sw-field--operator\"\n        v-bind=\"{ operators, condition }\"\n        :disabled=\"disabled || undefined\"\n    />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_condition_line_item_custom_field_value %}\n    <sw-form-field-renderer\n        v-if=\"renderedField\"\n        name=\"sw-field--renderedFieldValue\"\n        size=\"medium\"\n        :value=\"renderedFieldValue\"\n        :config=\"renderedField.config\"\n        :disabled=\"disabled || undefined\"\n        @update:value=\"renderedFieldValue = $event\"\n    />\n    {% endblock %}\n</div>\n{% endblock %}\n","import template from './sw-condition-line-item-custom-field.html.twig';\nimport './sw-condition-line-item-custom-field.scss';\n\nconst { Component, Mixin } = Cicada;\nconst { mapPropertyErrors } = Component.getComponentHelper();\nconst { Criteria } = Cicada.Data;\nconst { Filter } = Cicada;\n\n/**\n * @package services-settings\n */\nComponent.extend('sw-condition-line-item-custom-field', 'sw-condition-base-line-item', {\n    template,\n\n    inject: ['repositoryFactory'],\n\n    mixins: [\n        Mixin.getByName('sw-inline-snippet'),\n    ],\n\n    computed: {\n        /**\n         * Fetch custom fields that are related to the previously selected custom field set\n         * @returns {Object.Criteria}\n         */\n        customFieldCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addAssociation('customFieldSet');\n            criteria.addFilter(Criteria.equals('customFieldSet.relations.entityName', 'product'));\n            criteria.addSorting(Criteria.sort('customFieldSet.name', 'ASC'));\n            return criteria;\n        },\n\n        operator: {\n            get() {\n                this.ensureValueExist();\n                return this.condition.value.operator;\n            },\n            set(operator) {\n                this.ensureValueExist();\n                this.condition.value = {\n                    ...this.condition.value,\n                    operator,\n                };\n            },\n        },\n\n        renderedField: {\n            get() {\n                this.ensureValueExist();\n                return this.condition.value.renderedField;\n            },\n            set(renderedField) {\n                this.ensureValueExist();\n                this.condition.value = {\n                    ...this.condition.value,\n                    renderedField,\n                };\n            },\n        },\n\n        selectedField: {\n            get() {\n                this.ensureValueExist();\n                return this.condition.value.selectedField;\n            },\n            set(selectedField) {\n                this.ensureValueExist();\n                this.condition.value = {\n                    ...this.condition.value,\n                    selectedField,\n                };\n            },\n        },\n\n        selectedFieldSet: {\n            get() {\n                this.ensureValueExist();\n                return this.condition.value.selectedFieldSet;\n            },\n            set(selectedFieldSet) {\n                this.ensureValueExist();\n                this.condition.value = {\n                    ...this.condition.value,\n                    selectedFieldSet,\n                };\n            },\n        },\n\n        renderedFieldValue: {\n            get() {\n                this.ensureValueExist();\n                return this.condition.value.renderedFieldValue;\n            },\n            set(renderedFieldValue) {\n                this.ensureValueExist();\n                this.condition.value = {\n                    ...this.condition.value,\n                    renderedFieldValue,\n                };\n            },\n        },\n\n        operators() {\n            return this.conditionDataProviderService.getOperatorSetByComponent(this.renderedField);\n        },\n\n        ...mapPropertyErrors('condition', [\n            'value.renderedField',\n            'value.selectedField',\n            'value.selectedFieldSet',\n            'value.operator',\n            'value.renderedFieldValue',\n        ]),\n\n        currentError() {\n            return (\n                this.conditionValueRenderedFieldError ||\n                this.conditionValueSelectedFieldError ||\n                this.conditionValueSelectedFieldSetError ||\n                this.conditionValueOperatorError ||\n                this.conditionValueRenderedFieldValueError\n            );\n        },\n        truncateFilter() {\n            return Filter.getByName('truncate');\n        },\n    },\n\n    methods: {\n        getTooltipConfig(item) {\n            if (item.allowCartExpose) {\n                return { message: '', disabled: true };\n            }\n\n            const route = {\n                name: 'sw.settings.custom.field.detail',\n                params: { id: item.customFieldSetId },\n            };\n            const routeData = this.$router.resolve(route);\n\n            return {\n                disabled: false,\n                width: 260,\n                message: this.$t('global.sw-condition.condition.lineItemCustomField.field.customFieldSelect.tooltip', {\n                    customFieldSettingsLink: routeData.href,\n                }),\n            };\n        },\n\n        /**\n         * Clear any further field's values if no custom field has been selected\n         * @param id\n         */\n        onFieldChange(id) {\n            if (this.$refs.selectedField.resultCollection.has(id)) {\n                this.renderedField = this.$refs.selectedField.resultCollection.get(id);\n                this.selectedFieldSet = this.renderedField.customFieldSetId;\n            } else {\n                this.renderedField = null;\n            }\n\n            this.operator = null;\n            this.renderedFieldValue = null;\n        },\n    },\n});\n"],"names":["template","Component","Mixin","mapPropertyErrors","Criteria","Filter","criteria","operator","renderedField","selectedField","selectedFieldSet","renderedFieldValue","item","route","routeData","id"],"mappings":"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"}