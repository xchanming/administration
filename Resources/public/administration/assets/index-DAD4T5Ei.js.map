{"version":3,"file":"index-DAD4T5Ei.js","sources":["../../../app/administration/src/module/sw-settings-rule/component/sw-settings-rule-add-assignment-listing/sw-settings-rule-add-assignment-listing.html.twig","../../../app/administration/src/module/sw-settings-rule/component/sw-settings-rule-add-assignment-listing/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_rule_add_assignment_listing %}\n<sw-card\n    class=\"sw-settings-rule-add-assignment-listing__card\"\n    position-identifier=\"sw-settings-rule-add-assignment-listing\"\n>\n    <template #toolbar>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_rule_add_assignment_listing_toolbar %}\n        <sw-card-filter @sw-card-filter-term-change=\"doSearch\" />\n        {% endblock %}\n    </template>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_rule_add_assignment_listing_grid %}\n    <sw-data-grid\n        class=\"sw-settings-rule-add-assignment-listing__grid\"\n        :is-loading=\"loading\"\n        :data-source=\"items\"\n        :columns=\"entityContext.addContext.gridColumns\"\n        :is-record-selectable=\"isNotAssigned\"\n        :show-actions=\"false\"\n        @select-item=\"onSelectItem\"\n    >\n        <template\n            #selection-content=\"{\n                item,\n                isSelected,\n                isRecordSelectable,\n                selectItem,\n                itemIdentifierProperty,\n            }\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_rule_add_assignment_listing_checkbox %}\n            <div class=\"sw-data-grid__cell-content\">\n                <sw-checkbox-field\n                    :disabled=\"!isRecordSelectable(item)\"\n                    :value=\"isSelected(item[itemIdentifierProperty]) || !isNotAssigned(item)\"\n                    @update:value=\"selectItem($event, item)\"\n                />\n            </div>\n            {% endblock %}\n        </template>\n\n        <template #column-name=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_rule_add_assignment_listing_name %}\n            <sw-product-variant-info\n                v-if=\"item.variation\"\n                :variations=\"item.variation\"\n            >\n                {{ item.translated.name }}\n            </sw-product-variant-info>\n            <span v-else>\n                {{ item.translated.name }}\n            </span>\n            {% endblock %}\n        </template>\n\n        <template #column-active=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_rule_add_assignment_listing_active_flag %}\n            <sw-icon\n                v-if=\"item.active\"\n                name=\"regular-checkmark-xs\"\n                small\n                class=\"is--active\"\n            />\n            <sw-icon\n                v-else\n                name=\"regular-times-s\"\n                small\n                class=\"is--inactive\"\n            />\n            {% endblock %}\n        </template>\n\n        <template #column-taxType=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_rule_add_assignment_listing_tax_type %}\n            {{ shippingTaxTypeLabel(item.taxType) }}\n            {% endblock %}\n        </template>\n\n        <template #pagination>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_rule_add_assignment_listing_pagination %}\n            <sw-pagination\n                :limit=\"limit\"\n                :page=\"page\"\n                :total=\"total\"\n                @page-change=\"paginate\"\n            />\n            {% endblock %}\n        </template>\n    </sw-data-grid>\n    {% endblock %}\n</sw-card>\n{% endblock %}\n","import template from './sw-settings-rule-add-assignment-listing.html.twig';\nimport './sw-settings-rule-add-assignment-listing.scss';\n\nconst { Context } = Cicada;\nconst { Criteria } = Cicada.Data;\nconst { cloneDeep } = Cicada.Utils.object;\n\n/**\n * @private\n * @package services-settings\n */\nexport default {\n    template,\n\n    emits: ['select-item'],\n\n    compatConfig: Cicada.compatConfig,\n\n    props: {\n        ruleId: {\n            type: String,\n            required: true,\n        },\n\n        entityContext: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            loading: true,\n            repository: null,\n            items: [],\n            preselectedIds: [],\n            limit: 10,\n            page: 1,\n            total: 0,\n        };\n    },\n\n    computed: {\n        criteria() {\n            const criteria = new Criteria(this.page, this.limit);\n\n            if (this.entityContext.addContext.association) {\n                criteria.addAssociation(this.entityContext.addContext.association);\n                criteria\n                    .getAssociation(this.entityContext.addContext.association)\n                    .addFilter(Criteria.equals('id', this.ruleId));\n            }\n\n            if (this.entityContext.entityName === 'product') {\n                criteria.addAssociation('options.group');\n            }\n\n            return criteria;\n        },\n\n        shippingCostTaxOptions() {\n            return [\n                {\n                    label: this.$tc('sw-settings-shipping.shippingCostOptions.auto'),\n                    value: 'auto',\n                },\n                {\n                    label: this.$tc('sw-settings-shipping.shippingCostOptions.highest'),\n                    value: 'highest',\n                },\n                {\n                    label: this.$tc('sw-settings-shipping.shippingCostOptions.fixed'),\n                    value: 'fixed',\n                },\n            ];\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.repository = this.entityContext.repository;\n\n            this.doSearch();\n        },\n\n        onSelectItem(selection, item, selected) {\n            this.$emit('select-item', selection, item, selected);\n        },\n\n        isNotAssigned(item) {\n            if (this.entityContext.addContext.association) {\n                return item[this.entityContext.addContext.association].length <= 0;\n            }\n\n            return item[this.entityContext.addContext.column] !== this.ruleId;\n        },\n\n        paginate({ page, limit }) {\n            this.page = page;\n            this.limit = limit;\n\n            return this.doSearch();\n        },\n\n        doSearch(term) {\n            this.loading = true;\n            const api = this.entityContext.api ? this.entityContext.api() : Context.api;\n            const criteria = cloneDeep(this.criteria);\n\n            if (term) {\n                criteria.addFilter(Criteria.contains(this.entityContext.addContext.searchColumn ?? 'name', term));\n            }\n\n            return this.repository\n                .search(criteria, api)\n                .then((result) => {\n                    this.items = result;\n                    this.total = result.total;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n\n        shippingTaxTypeLabel(taxName) {\n            if (!taxName) {\n                return '';\n            }\n\n            const tax = this.shippingCostTaxOptions.find((i) => taxName === i.value) || '';\n\n            return tax?.label;\n        },\n    },\n};\n"],"names":["template","Context","Criteria","cloneDeep","index","criteria","selection","item","selected","page","limit","term","api","result","taxName","tax"],"mappings":"AAAA,MAAeA,EAAA,6hECGT,CAAE,QAAAC,CAAS,EAAG,OACd,CAAE,SAAAC,CAAQ,EAAK,OAAO,KACtB,CAAE,UAAAC,CAAW,EAAG,OAAO,MAAM,OAMpBC,EAAA,CACX,SAAAJ,EAEA,MAAO,CAAC,aAAa,EAErB,aAAc,OAAO,aAErB,MAAO,CACH,OAAQ,CACJ,KAAM,OACN,SAAU,EACb,EAED,cAAe,CACX,KAAM,OACN,SAAU,EACb,CACJ,EAED,MAAO,CACH,MAAO,CACH,QAAS,GACT,WAAY,KACZ,MAAO,CAAE,EACT,eAAgB,CAAE,EAClB,MAAO,GACP,KAAM,EACN,MAAO,CACnB,CACK,EAED,SAAU,CACN,UAAW,CACP,MAAMK,EAAW,IAAIH,EAAS,KAAK,KAAM,KAAK,KAAK,EAEnD,OAAI,KAAK,cAAc,WAAW,cAC9BG,EAAS,eAAe,KAAK,cAAc,WAAW,WAAW,EACjEA,EACK,eAAe,KAAK,cAAc,WAAW,WAAW,EACxD,UAAUH,EAAS,OAAO,KAAM,KAAK,MAAM,CAAC,GAGjD,KAAK,cAAc,aAAe,WAClCG,EAAS,eAAe,eAAe,EAGpCA,CACV,EAED,wBAAyB,CACrB,MAAO,CACH,CACI,MAAO,KAAK,IAAI,+CAA+C,EAC/D,MAAO,MACV,EACD,CACI,MAAO,KAAK,IAAI,kDAAkD,EAClE,MAAO,SACV,EACD,CACI,MAAO,KAAK,IAAI,gDAAgD,EAChE,MAAO,OACV,CACjB,CACS,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,WAAa,KAAK,cAAc,WAErC,KAAK,SAAQ,CAChB,EAED,aAAaC,EAAWC,EAAMC,EAAU,CACpC,KAAK,MAAM,cAAeF,EAAWC,EAAMC,CAAQ,CACtD,EAED,cAAcD,EAAM,CAChB,OAAI,KAAK,cAAc,WAAW,YACvBA,EAAK,KAAK,cAAc,WAAW,WAAW,EAAE,QAAU,EAG9DA,EAAK,KAAK,cAAc,WAAW,MAAM,IAAM,KAAK,MAC9D,EAED,SAAS,CAAE,KAAAE,EAAM,MAAAC,GAAS,CACtB,YAAK,KAAOD,EACZ,KAAK,MAAQC,EAEN,KAAK,UACf,EAED,SAASC,EAAM,CACX,KAAK,QAAU,GACf,MAAMC,EAAM,KAAK,cAAc,IAAM,KAAK,cAAc,IAAG,EAAKX,EAAQ,IAClEI,EAAWF,EAAU,KAAK,QAAQ,EAExC,OAAIQ,GACAN,EAAS,UAAUH,EAAS,SAAS,KAAK,cAAc,WAAW,cAAgB,OAAQS,CAAI,CAAC,EAG7F,KAAK,WACP,OAAON,EAAUO,CAAG,EACpB,KAAMC,GAAW,CACd,KAAK,MAAQA,EACb,KAAK,MAAQA,EAAO,KACxC,CAAiB,EACA,QAAQ,IAAM,CACX,KAAK,QAAU,EACnC,CAAiB,CACR,EAED,qBAAqBC,EAAS,CAC1B,GAAI,CAACA,EACD,MAAO,GAGX,MAAMC,EAAM,KAAK,uBAAuB,KAAM,GAAMD,IAAY,EAAE,KAAK,GAAK,GAE5E,OAAOC,GAAA,YAAAA,EAAK,KACf,CACJ,CACL"}