import"./store-D_-eM0q8.js";import"./sw-bulk-edit.store-6UtElGbe.js";const y=`{% block sw_bulk_edit_product %} <sw-page :class="{ 'sw-bulk-edit-product': true, 'is--variant': isChild, }" > {% block sw_bulk_edit_product_search_bar %} <template #search-bar> <sw-search-bar /> </template> {% endblock %} {% block sw_bulk_edit_product_smart_bar_back %} <template #smart-bar-back> <router-link v-if="isChild" class="smart-bar__back-btn" :to="{ name: 'sw.product.detail.variants', params: { id: $route.params.parentId } }" :style="{ 'color': $route.meta.$module?.color }" > <sw-icon name="regular-chevron-left" small /> </router-link> </template> {% endblock %} {% block sw_bulk_edit_product_smart_bar_header %} <template #smart-bar-header> {% block sw_bulk_edit_product_smart_bar_header_title %} <h2> {{ isChild ? $tc('sw-bulk-edit.variant.textTitle', selectedIds.length, { variantTotal: selectedIds.length }) : $tc('sw-bulk-edit.product.textTitle', selectedIds.length, { productTotal: selectedIds.length }) }} </h2> {% endblock %} </template> {% endblock %} {% block sw_bulk_edit_product_content_language_switch %} <template #language-switch> <sw-language-switch @on-change="onChangeLanguage" /> </template> {% endblock %} {% block sw_bulk_edit_product_content_smart_bar_actions %} <template #smart-bar-actions> {% block sw_bulk_edit_product_actions_save %} <sw-button-process class="sw-bulk-edit-product__save-action" variant="primary" :is-loading="isLoading" :process-success="isSaveSuccessful" :disabled="isLoading || !hasSelectedChanges || undefined" @click="openModal" > {{ $tc('sw-bulk-edit.applyChanges') }} </sw-button-process> {% endblock %} </template> {% endblock %} {% block sw_bulk_edit_product_content %} <template #content> <sw-card-view v-if="selectedIds.length > 0 && isLoadedData"> {% block sw_bulk_edit_product_content_inheritance_card %} <sw-card v-if="isChild" class="sw-bulk-edit-product__inheritance" position-identifier="sw-bulk-edit-product-inheritance" > {% block sw_bulk_edit_product_content_inheritance_alert %} <sw-alert variant="info"> <template #customIcon> <div class="sw-bulk-edit-product__inheritance-icon"> <sw-icon name="regular-link" color="#7363e5" size="16" /> </div> </template> <template #default> {{ $tc('sw-bulk-edit.product.alertInheritance.message') }} </template> </sw-alert> {% endblock %} </sw-card> {% endblock %} <sw-card v-if="restrictedFields.length" class="sw-bulk-edit-product__restricted-fields" position-identifier="sw-bulk-edit-product-restricted-fields" > <sw-alert :title="$tc('sw-bulk-edit.product.alertRestrictedFields.title')" variant="warning" > <span v-html="$tc('sw-bulk-edit.product.alertRestrictedFields.message')"></span> <ul> <li v-for="(restrictedField, index) in restrictedFields" :key="index" > {{ $tc(\`sw-bulk-edit.product.alertRestrictedFields.\${restrictedField}\`) }} </li> </ul> </sw-alert> </sw-card> {% block sw_bulk_edit_product_content_gereral_information_card %} <sw-card class="sw-bulk-edit-product-base__info" position-identifier="sw-bulk-edit-product-info" :title="$tc('sw-bulk-edit.product.generalInformation.cardTitle')" > {% block sw_bulk_edit_product_content_gereral_information %} <sw-bulk-edit-change-type-field-renderer :form-fields="generalFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_prices_card %} <sw-card class="sw-bulk-edit-product-base__prices" position-identifier="sw-bulk-edit-product-prices" :title="$tc('sw-bulk-edit.product.prices.cardTitle')" > {% block sw_bulk_edit_product_content_prices %} <sw-bulk-edit-change-type-field-renderer :form-fields="pricesFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @change-value="onChangePrices" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_advanced_prices_card %} <sw-card class="sw-bulk-edit-product-base__advanced-prices" position-identifier="sw-bulk-edit-product-advanced-prices" :title="$tc('sw-bulk-edit.product.advancedPrices.cardTitle')" > {% block sw_bulk_edit_product_content_advanced_prices %} <sw-bulk-edit-change-type-field-renderer :form-fields="advancedPricesFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" > <template #valueFieldWithBoxType="{ formField, entity, index }"> <sw-inheritance-switch v-if="isChild" :is-inherited="bulkEditProduct[formField.name].isInherited" @inheritance-restore="onInheritanceRestore(formField)" @inheritance-remove="onInheritanceRemove(formField)" /> <a v-if="['add', 'overwrite'].includes(bulkEditProduct[formField.name].type)" :class="{ 'is--disabled': !!bulkEditProduct[formField.name].isInherited }" class="sw-card__quick-link" role="link" tabindex="0" @click="displayAdvancePricesModal = true" @keydown.enter="displayAdvancePricesModal = true" > {{ $tc('sw-bulk-edit.product.advancedPrices.newAdvancedPrices', { count: entity[formField.name] ? Object.keys(priceRuleGroups).length : 0 }, 0) }} <sw-icon name="regular-long-arrow-right" small /> </a> {% block sw_bulk_edit_product_content_advanced_prices_rule_selection %} <sw-entity-multi-select v-else-if="bulkEditProduct[formField.name].type === 'remove'" class="sw-bulk-edit-product-base__advanced-prices-selection" :placeholder="$tc('sw-bulk-edit.product.advancedPrices.selectRule')" :criteria="ruleCriteria" entity-name="rule" :entity-collection="!!bulkEditProduct[formField.name].isInherited ? [] : entity[formField.name]" :disabled="!!bulkEditProduct[formField.name].isInherited || undefined" @update:entity-collection="onRuleChange" > <template #selection-label-property="{ item }"> {{ item.ruleName }} </template> <template #result-item="{ item, index, labelProperty, isSelected, addItem, getKey }"> <sw-select-result :selected="isSelected(item)" :disabled="!!priceRuleGroups[item.id] || undefined" v-bind="{ item, index }" @item-select="addItem" > {{ getKey(item,labelProperty) || getKey(item, \`translated.\${labelProperty}\`) }} </sw-select-result> </template> </sw-entity-multi-select> {% endblock %} </template> </sw-bulk-edit-change-type-field-renderer> {% endblock %} {% block sw_bulk_edit_product_content_advanced_prices_modal %} <sw-modal v-if="displayAdvancePricesModal" class="sw-bulk-edit-product-content-advanced-prices-modal" variant="large" :title="$tc('sw-bulk-edit.product.advancedPrices.cardTitle')" @modal-close="displayAdvancePricesModal = false" > <sw-product-detail-context-prices :is-set-default-price="true" :can-set-loading-rules="false" /> {% block sw_bulk_edit_product_content_advanced_prices_modal_footer %} <template #modal-footer> <slot name="sw-bulk-edit-modal-cancel"> <sw-button size="small" @click="displayAdvancePricesModal = false" > {{ $tc('global.default.close') }} </sw-button> </slot> </template> {% endblock %} </sw-modal> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_property_card %} <sw-card class="sw-bulk-edit-product-base__property" position-identifier="sw-bulk-edit-product-property" :title="$tc('sw-bulk-edit.product.property.cardTitle')" > {% block sw_bulk_edit_product_content_property %} <sw-bulk-edit-change-type-field-renderer :form-fields="propertyFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_deliverability_card %} <sw-card class="sw-bulk-edit-product-base__deliverability" position-identifier="sw-bulk-edit-product-deliverability" :title="$tc('sw-bulk-edit.product.deliverability.cardTitle')" > {% block sw_bulk_edit_product_content_deliverability %} <sw-bulk-edit-change-type-field-renderer :form-fields="deliverabilityFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_assignments_card %} <sw-card class="sw-bulk-edit-product-base__assignment" position-identifier="sw-bulk-edit-product-assignment" :title="$tc('sw-bulk-edit.product.assignment.cardTitle')" > {% block sw_bulk_edit_product_content_assignments %} <sw-bulk-edit-change-type-field-renderer :form-fields="assignmentFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_media_card %} <sw-card class="sw-bulk-edit-product-base__media" position-identifier="sw-bulk-edit-product-media" :title="$tc('sw-bulk-edit.product.media.cardTitle')" > {% block media %} <sw-bulk-edit-change-type-field-renderer :form-fields="mediaFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_labelling_card %} <sw-card class="sw-bulk-edit-product-base__labelling" position-identifier="sw-bulk-edit-product-labelling" :title="$tc('sw-bulk-edit.product.labelling.cardTitle')" > {% block sw_bulk_edit_product_content_labelling %} <sw-bulk-edit-change-type-field-renderer :form-fields="labellingFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_seo_card %} <sw-card class="sw-bulk-edit-product-base__seo" position-identifier="sw-bulk-edit-product-seo" :title="$tc('sw-bulk-edit.product.seo.cardTitle')" > {% block sw_bulk_edit_product_content_seo %} <sw-bulk-edit-change-type-field-renderer :form-fields="seoFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> {% endblock %} </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_meansures_packaging_card %} <sw-card class="sw-bulk-edit-product-base__measures" position-identifier="sw-bulk-edit-product-measures" :title="$tc('sw-bulk-edit.product.measuresAndPackaging.cardTitle')" > <sw-bulk-edit-change-type-field-renderer :form-fields="measuresPackagingFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_essential_card %} <sw-card class="sw-bulk-edit-product-base___essential" position-identifier="sw-bulk-edit-product-essential" :title="$tc('sw-bulk-edit.product.featureSets.cardTitle')" > <sw-bulk-edit-change-type-field-renderer :form-fields="essentialCharacteristicsFormFields" :bulk-edit-data="bulkEditProduct" :entity="product" @inheritance-restore="onInheritanceRestore" @inheritance-remove="onInheritanceRemove" /> </sw-card> {% endblock %} {% block sw_bulk_edit_product_content_meansures_custom_field_card %} <sw-card v-if="customFieldSets.length > 0" class="sw-bulk-edit-product-base__custom_fields" position-identifier="sw-bulk-edit-product-custom-fields" :title="$tc('sw-bulk-edit.product.customFields.cardTitle')" > <sw-bulk-edit-custom-fields class="sw-bulk-edit__custom-fields" :sets="customFieldSets" :entity="product" :parent-entity="parentProduct" @change="onCustomFieldsChange" /> </sw-card> {% endblock %} </sw-card-view> <sw-empty-state v-if="!isLoading && selectedIds.length == 0" :title="$tc('sw-bulk-edit.product.messageEmptyTitle')" :subline="$tc('sw-bulk-edit.product.messageEmptySubline')" /> {% block sw_bulk_edit_product_save_modal %} <router-view v-slot="{ Component }" > <component :is="Component" :item-total="selectedIds.length" :is-loading="isLoading" :process-status="processStatus" @modal-close="closeModal" @bulk-save="onSave" /> </router-view> {% endblock %} </template> {% endblock %} </sw-page> {% endblock %}`,{Context:_}=Shopware,{Criteria:a}=Shopware.Data,{types:k}=Shopware.Utils,{chunk:I}=Shopware.Utils.array,{cloneDeep:P}=Shopware.Utils.object,E={template:y,inject:["feature","bulkEditApiFactory","repositoryFactory"],data(){return{isLoading:!1,isLoadedData:!1,isSaveSuccessful:!1,displayAdvancePricesModal:!1,isDisabledListPrice:!0,isDisabledRegulationPrice:!0,bulkEditProduct:{},bulkEditSelected:[],taxRate:{},currency:{},customFieldSets:[],processStatus:"",rules:[],parentProductFrozen:null,isComponentMounted:!0}},metaInfo(){return{title:this.$createTitle()}},computed:{product(){return Shopware.Store.get("swProductDetail").product},parentProduct(){return Shopware.Store.get("swProductDetail").parentProduct},taxes(){return Shopware.Store.get("swProductDetail").taxes},defaultCurrency(){return Shopware.Store.get("swProductDetail").defaultCurrency},defaultPrice(){return Shopware.Store.get("swProductDetail").defaultPrice},selectedIds(){return Shopware.Store.get("shopwareApps").selectedIds},customFieldSetRepository(){return this.repositoryFactory.create("custom_field_set")},currencyRepository(){return this.repositoryFactory.create("currency")},taxRepository(){return this.repositoryFactory.create("tax")},productRepository(){return this.repositoryFactory.create("product")},hasSelectedChanges(){return Object.values(this.bulkEditProduct).some(e=>e.isChanged)||this.bulkEditSelected.length>0},customFieldSetCriteria(){const e=new a(1,null);return e.addFilter(a.equals("relations.entityName","product")),e},taxCriteria(){const e=new a(1,500);return e.addSorting(a.sort("position")),e},productCriteria(){const e=new a(1,25);return e.getAssociation("media").addSorting(a.sort("position","ASC")),e.getAssociation("properties").addSorting(a.sort("name","ASC",!0)),e.getAssociation("prices").addSorting(a.sort("quantityStart","ASC",!0)),e.getAssociation("tags").addSorting(a.sort("name","ASC")),e.getAssociation("seoUrls").addFilter(a.equals("isCanonical",!0)),e.getAssociation("crossSellings").addSorting(a.sort("position","ASC")).getAssociation("assignedProducts").addSorting(a.sort("position","ASC")).addAssociation("product").getAssociation("product").addAssociation("options.group"),e.addAssociation("cover").addAssociation("categories").addAssociation("visibilities.salesChannel").addAssociation("options").addAssociation("configuratorSettings.option").addAssociation("unit").addAssociation("productReviews").addAssociation("seoUrls").addAssociation("mainCategories").addAssociation("options.group").addAssociation("customFieldSets").addAssociation("featureSet").addAssociation("cmsPage").addAssociation("featureSet"),e.getAssociation("manufacturer").addAssociation("media"),e},isChild(){return this.$route.params.parentId!=="null"},restrictedFields(){let e=[];const t=this.$route.params.includesDigital;return(t==="1"||t==="2")&&(e=["isCloseout","restockTime","maxPurchase","purchaseSteps","minPurchase","shippingFree"]),t==="1"&&e.push("stock"),e},generalFormFields(){var e,t,i,r,s,c,d,l;return[{name:"description",type:"html",canInherit:this.isChild,config:{componentName:"sw-bulk-edit-product-description",changeLabel:this.$tc("sw-bulk-edit.product.generalInformation.description.changeLabel"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.description)==null?void 0:t.isInherited}},{name:"manufacturerId",canInherit:this.isChild,config:{componentName:"sw-entity-single-select",entity:"product_manufacturer",changeLabel:this.$tc("sw-bulk-edit.product.generalInformation.manufacturer.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.generalInformation.manufacturer.placeholderManufacturer"),disabled:(r=(i=this.bulkEditProduct)==null?void 0:i.manufacturerId)==null?void 0:r.isInherited}},{name:"active",type:"bool",canInherit:this.isChild,config:{type:"switch",label:this.$tc("sw-bulk-edit.product.generalInformation.active.switchLabel"),changeLabel:this.$tc("sw-bulk-edit.product.generalInformation.active.changeLabel"),disabled:(c=(s=this.bulkEditProduct)==null?void 0:s.active)==null?void 0:c.isInherited}},{name:"markAsTopseller",type:"bool",canInherit:this.isChild,config:{type:"switch",label:this.$tc("sw-bulk-edit.product.generalInformation.productPromotion.switchLabel"),changeLabel:this.$tc("sw-bulk-edit.product.generalInformation.productPromotion.changeLabel"),disabled:(l=(d=this.bulkEditProduct)==null?void 0:d.markAsTopseller)==null?void 0:l.isInherited}}]},pricesFormFields(){var t,i,r,s,c,d,l,o,n,u,h,p,b,m;const e=[{name:"taxId",canInherit:this.isChild,config:{componentName:"sw-entity-single-select",entity:"tax",changeLabel:this.$tc("sw-bulk-edit.product.prices.taxRate.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.prices.taxRate.placeholderTax"),disabled:(i=(t=this.bulkEditProduct)==null?void 0:t.taxId)==null?void 0:i.isInherited}},{name:"price",config:{componentName:"sw-price-field",price:(r=this.product)==null?void 0:r.price,taxRate:this.taxRate,currency:this.currency,changeLabel:this.isChild?this.$tc("sw-bulk-edit.product.prices.price.label"):this.$tc("sw-bulk-edit.product.prices.price.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.prices.price.placeholderPrice"),disabled:this.isChild?(c=(s=this.bulkEditProduct)==null?void 0:s.isPriceInherited)==null?void 0:c.isInherited:!1}},{name:"purchasePrices",config:{componentName:"sw-price-field",price:(d=this.product)==null?void 0:d.purchasePrices,taxRate:this.taxRate,currency:this.currency,changeLabel:this.isChild?this.$tc("sw-bulk-edit.product.prices.purchasePrices.label"):this.$tc("sw-bulk-edit.product.prices.purchasePrices.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.prices.purchasePrices.placeholderPurchasePrices"),disabled:this.isChild?(o=(l=this.bulkEditProduct)==null?void 0:l.isPriceInherited)==null?void 0:o.isInherited:!1}},{name:"listPrice",config:{componentName:"sw-price-field",price:(n=this.product)==null?void 0:n.listPrice,taxRate:this.taxRate,currency:this.currency,changeLabel:this.isChild?this.$tc("sw-bulk-edit.product.prices.listPrice.label"):this.$tc("sw-bulk-edit.product.prices.listPrice.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.prices.listPrice.placeholderListPrice"),disabled:this.isChild?(h=(u=this.bulkEditProduct)==null?void 0:u.isPriceInherited)==null?void 0:h.isInherited:this.isDisabledListPrice}},{name:"regulationPrice",config:{componentName:"sw-price-field",price:(p=this.product)==null?void 0:p.regulationPrice,taxRate:this.taxRate,currency:this.currency,changeLabel:this.isChild?this.$tc("sw-bulk-edit.product.prices.regulationPrice.label"):this.$tc("sw-bulk-edit.product.prices.regulationPrice.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.prices.regulationPrice.placeholderRegulationPrice"),disabled:this.isChild?(m=(b=this.bulkEditProduct)==null?void 0:b.isPriceInherited)==null?void 0:m.isInherited:this.isDisabledRegulationPrice}}];if(this.isChild){const g={name:"isPriceInherited",canInherit:this.isChild,config:{componentName:"",changeLabel:this.$tc("sw-bulk-edit.product.prices.isPriceInherited.changeLabel")}};e.splice(1,0,g)}return e},advancedPricesFormFields(){return[{name:"prices",canInherit:this.isChild,config:{allowOverwrite:!0,allowClear:!0,allowAdd:!0,allowRemove:!0,changeLabel:this.$tc("sw-bulk-edit.product.advancedPrices.changeLabel")}}]},propertyFormFields(){var e,t;return[{name:"properties",canInherit:this.isChild,config:{componentName:"sw-product-properties",allowOverwrite:!0,allowClear:!0,allowAdd:!0,allowRemove:!0,changeLabel:this.$tc("sw-bulk-edit.product.property.changeLabel"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.properties)==null?void 0:t.isInherited,isAssociation:!1,showInheritanceSwitcher:!1}}]},deliverabilityFormFields(){var t,i,r,s,c,d,l,o,n,u,h,p,b,m;return[{name:"stock",type:"int",canInherit:!1,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.stock.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.stock.placeholderStock"),numberType:"int",allowEmpty:!0,allowOverwrite:!0,allowClear:!0,min:0}},{name:"isCloseout",type:"bool",canInherit:this.isChild,config:{type:"switch",label:this.$tc("sw-bulk-edit.product.deliverability.isCloseout.switchLabel"),changeLabel:this.$tc("sw-bulk-edit.product.deliverability.isCloseout.changeLabel"),disabled:(i=(t=this.bulkEditProduct)==null?void 0:t.isCloseout)==null?void 0:i.isInherited}},{name:"deliveryTimeId",canInherit:this.isChild,config:{componentName:"sw-entity-single-select",entity:"delivery_time",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.deliveryTime.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.deliveryTime.placeholderDeliveryTime"),disabled:(s=(r=this.bulkEditProduct)==null?void 0:r.deliveryTimeId)==null?void 0:s.isInherited}},{name:"restockTime",type:"int",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.restockTime.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.restockTime.placeholderRestockTime"),numberType:"int",allowEmpty:!0,allowOverwrite:!0,allowClear:!0,min:0,disabled:(d=(c=this.bulkEditProduct)==null?void 0:c.restockTime)==null?void 0:d.isInherited}},{name:"shippingFree",type:"bool",canInherit:this.isChild,config:{type:"switch",label:this.$tc("sw-bulk-edit.product.deliverability.freeShipping.switchLabel"),changeLabel:this.$tc("sw-bulk-edit.product.deliverability.freeShipping.changeLabel"),disabled:(o=(l=this.bulkEditProduct)==null?void 0:l.shippingFree)==null?void 0:o.isInherited}},{name:"minPurchase",type:"int",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.minOrderQuantity.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.minOrderQuantity.placeholderMinOrderQuantity"),numberType:"int",allowOverwrite:!0,allowClear:!0,allowEmpty:!0,min:1,disabled:(u=(n=this.bulkEditProduct)==null?void 0:n.minPurchase)==null?void 0:u.isInherited}},{name:"purchaseSteps",type:"int",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.purchaseSteps.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.purchaseSteps.placeholderPurchaseSteps"),numberType:"int",allowOverwrite:!0,allowClear:!0,allowEmpty:!0,min:1,disabled:(p=(h=this.bulkEditProduct)==null?void 0:h.purchaseSteps)==null?void 0:p.isInherited}},{name:"maxPurchase",type:"int",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.deliverability.maxOrderQuantity.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.deliverability.maxOrderQuantity.placeholderMaxOrderQuantity"),numberType:"int",allowOverwrite:!0,allowClear:!0,allowEmpty:!0,min:0,disabled:(m=(b=this.bulkEditProduct)==null?void 0:b.maxPurchase)==null?void 0:m.isInherited}}].filter(g=>!this.restrictedFields.includes(g.name))},assignmentFormFields(){var e,t,i,r,s,c,d,l,o,n,u;return[{name:"visibilities",canInherit:this.isChild,config:{componentName:"sw-bulk-edit-product-visibility",bulkEditProduct:this.bulkEditProduct,allowOverwrite:!0,allowClear:!0,allowAdd:!0,allowRemove:!0,changeLabel:this.$tc("sw-bulk-edit.product.assignment.visibilities.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.assignment.visibilities.placeholder"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.visibilities)==null?void 0:t.isInherited}},{name:"categories",canInherit:this.isChild,config:{componentName:"sw-category-tree-field",categoriesCollection:(i=this.product)==null?void 0:i.categories,allowOverwrite:!0,allowClear:!0,allowAdd:!0,allowRemove:!0,changeLabel:this.$tc("sw-bulk-edit.product.assignment.categories.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.assignment.categories.placeholder"),disabled:(s=(r=this.bulkEditProduct)==null?void 0:r.categories)==null?void 0:s.isInherited}},{name:"tags",canInherit:this.isChild,config:{componentName:"sw-entity-tag-select",entityCollection:(c=this.product)==null?void 0:c.tags,entityName:"tag",allowOverwrite:!0,allowClear:!0,allowAdd:!0,allowRemove:!0,changeLabel:this.$tc("sw-bulk-edit.product.assignment.tags.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.assignment.tags.placeholder"),disabled:(l=(d=this.bulkEditProduct)==null?void 0:d.tags)==null?void 0:l.isInherited}},{name:"searchKeywords",canInherit:this.isChild,config:{componentName:"sw-multi-tag-select",value:(o=this.product)==null?void 0:o.searchKeywords,allowOverwrite:!0,allowClear:!0,allowAdd:!1,allowRemove:!1,changeLabel:this.$tc("sw-bulk-edit.product.assignment.searchKeywords.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.assignment.searchKeywords.placeholder"),disabled:(u=(n=this.bulkEditProduct)==null?void 0:n.searchKeywords)==null?void 0:u.isInherited}}]},mediaFormFields(){var e,t;return[{name:"media",canInherit:this.isChild,config:{componentName:"sw-bulk-edit-product-media",allowOverwrite:!0,allowClear:!0,allowAdd:!0,changeLabel:this.$tc("sw-bulk-edit.product.media.changeLabel"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.media)==null?void 0:t.isInherited}}]},labellingFormFields(){var e,t;return[{name:"releaseDate",type:"datetime",canInherit:this.isChild,config:{type:"date",dateType:"datetime-local",changeLabel:this.$tc("sw-bulk-edit.product.labelling.releaseDate.changeLabel"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.releaseDate)==null?void 0:t.isInherited}}]},seoFormFields(){var e,t,i,r,s,c;return[{name:"metaTitle",type:"text",canInherit:this.isChild,config:{componentName:"sw-field",type:"text",changeLabel:this.$tc("sw-bulk-edit.product.seo.metaTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.seo.metaTitle.placeholderMetaTitle"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.metaTitle)==null?void 0:t.isInherited}},{name:"metaDescription",type:"text",canInherit:this.isChild,config:{componentName:"sw-field",type:"textarea",changeLabel:this.$tc("sw-bulk-edit.product.seo.metaDescription.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.seo.metaDescription.placeholderMetaDescription"),disabled:(r=(i=this.bulkEditProduct)==null?void 0:i.metaDescription)==null?void 0:r.isInherited}},{name:"keywords",type:"text",canInherit:this.isChild,config:{componentName:"sw-field",type:"text",changeLabel:this.$tc("sw-bulk-edit.product.seo.seoKeywords.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.seo.seoKeywords.placeholderSeoKeywords"),disabled:(c=(s=this.bulkEditProduct)==null?void 0:s.keywords)==null?void 0:c.isInherited}}]},measuresPackagingFields(){var e,t,i,r,s,c,d,l,o,n,u,h,p,b,m,g,w,f;return[{name:"width",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.widthTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.widthTitle.placeholder"),numberType:"float",suffixLabel:"mm",min:0,disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.width)==null?void 0:t.isInherited}},{name:"height",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.heightTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.heightTitle.placeholder"),numberType:"float",suffixLabel:"mm",min:0,disabled:(r=(i=this.bulkEditProduct)==null?void 0:i.height)==null?void 0:r.isInherited}},{name:"length",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.lengthTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.lengthTitle.placeholder"),numberType:"float",suffixLabel:"mm",min:0,disabled:(c=(s=this.bulkEditProduct)==null?void 0:s.length)==null?void 0:c.isInherited}},{name:"weight",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.weightTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.weightTitle.placeholder"),numberType:"float",suffixLabel:"kg",min:0,disabled:(l=(d=this.bulkEditProduct)==null?void 0:d.weight)==null?void 0:l.isInherited}},{name:"purchaseUnit",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",numberType:"float",min:0,changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.sellingUnitTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.sellingUnitTitle.placeholder"),disabled:(n=(o=this.bulkEditProduct)==null?void 0:o.purchaseUnit)==null?void 0:n.isInherited}},{name:"unitId",canInherit:this.isChild,config:{componentName:"sw-entity-single-select",entity:"unit",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.scaleUnitTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.scaleUnitTitle.placeholder"),disabled:(h=(u=this.bulkEditProduct)==null?void 0:u.unitId)==null?void 0:h.isInherited}},{name:"packUnit",type:"text",canInherit:this.isChild,config:{componentName:"sw-field",type:"text",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.packUnitTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.packUnitTitle.placeholder"),disabled:(b=(p=this.bulkEditProduct)==null?void 0:p.packUnit)==null?void 0:b.isInherited}},{name:"packUnitPlural",type:"text",canInherit:this.isChild,config:{componentName:"sw-field",type:"text",changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.packUnitPluralTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.packUnitPluralTitle.placeholder"),disabled:(g=(m=this.bulkEditProduct)==null?void 0:m.packUnitPlural)==null?void 0:g.isInherited}},{name:"referenceUnit",type:"float",canInherit:this.isChild,config:{componentName:"sw-number-field",numberType:"float",min:0,changeLabel:this.$tc("sw-bulk-edit.product.measuresAndPackaging.basicUnitTitle.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.measuresAndPackaging.basicUnitTitle.placeholder"),disabled:(f=(w=this.bulkEditProduct)==null?void 0:w.referenceUnit)==null?void 0:f.isInherited}}]},essentialCharacteristicsFormFields(){var e,t;return[{name:"featureSetId",canInherit:this.isChild,config:{componentName:"sw-entity-single-select",entity:"product_feature_set",changeLabel:this.$tc("sw-bulk-edit.product.featureSets.changeLabel"),placeholder:this.$tc("sw-bulk-edit.product.featureSets.placeholder"),disabled:(t=(e=this.bulkEditProduct)==null?void 0:e.featureSetId)==null?void 0:t.isInherited}}]},ruleRepository(){return this.repositoryFactory.create("rule")},priceRepository(){var e,t,i;return(e=this.product)!=null&&e.prices?this.repositoryFactory.create((t=this.product)==null?void 0:t.prices.entity,(i=this.product)==null?void 0:i.prices.source):null},ruleCriteria(){const e=new a(1,500);return e.addFilter(a.multi("OR",[a.contains("rule.moduleTypes.types","price"),a.equals("rule.moduleTypes",null)])),e},priceRuleGroups(){var e,t;return(e=this.product)!=null&&e.prices?(t=this.product)==null?void 0:t.prices.reduce((i,r)=>(i[r.ruleId]=[...i[r.ruleId]||[],r],i),{}):{}}},watch:{"bulkEditProduct.prices.type"(e){var i,r,s,c;if(!((r=(i=this.product)==null?void 0:i.prices)!=null&&r.length)||e!=="remove")return;((c=(s=this.product)==null?void 0:s.prices)==null?void 0:c.getIds()).forEach(d=>{var l;return(l=this.product)==null?void 0:l.prices.remove(d)})},"product.visibilities":{handler(e){this.isChild&&(this.bulkEditProduct.visibilities.value=e)}},"bulkEditProduct.isPriceInherited.isChanged":{handler(e){this.isChild&&(this.bulkEditProduct.price.isChanged=e,this.bulkEditProduct.purchasePrices.isChanged=e,this.bulkEditProduct.listPrice.isChanged=e,this.bulkEditProduct.regulationPrice.isChanged=e)}},"bulkEditProduct.isPriceInherited.isInherited":{handler(e){this.isChild&&(this.bulkEditProduct.price.isInherited=e,this.bulkEditProduct.purchasePrices.isInherited=e,this.bulkEditProduct.listPrice.isInherited=e,this.bulkEditProduct.regulationPrice.isInherited=e)}},"product.listPrice":{deep:!0,handler(e){var t,i,r,s,c,d;this.isChild&&(r=(i=(t=this.bulkEditProduct)==null?void 0:t.price)==null?void 0:i.value)!=null&&r.length&&((d=(c=(s=this.bulkEditProduct)==null?void 0:s.price)==null?void 0:c.value[0])!=null&&d.listPrice||(this.bulkEditProduct.price.value[0].listPrice=e[0]))}},"product.regulationPrice":{deep:!0,handler(e){var t,i,r,s,c,d;this.isChild&&(r=(i=(t=this.bulkEditProduct)==null?void 0:t.price)==null?void 0:i.value)!=null&&r.length&&((d=(c=(s=this.bulkEditProduct)==null?void 0:s.price)==null?void 0:c.value[0])!=null&&d.regulationPrice||(this.bulkEditProduct.price.value[0].regulationPrice=e[0]))}}},created(){this.createdComponent()},methods:{async createdComponent(){this.setRouteMetaModule(),this.isLoading=!0,this.isChild&&await this.getParentProduct();const e=[this.loadCurrencies(),this.loadTaxes(),this.loadCustomFieldSets(),this.loadDefaultCurrency(),this.loadRules()];Promise.all(e).then(()=>{this.loadBulkEditData();const t=this.isChild?this.parentProduct:this.productRepository.create();Shopware.Store.get("swProductDetail").product=t,this.definePricesBulkEdit(),this.isChild&&this.setBulkEditProductValue(),this.isLoading=!1,this.isLoadedData=!0})},setRouteMetaModule(){this.$route.meta.$module.color="#57D9A3",this.$route.meta.$module.icon="regular-products"},setBulkEditProductValue(){Object.keys(this.bulkEditProduct).forEach(e=>{var t;this.bulkEditProduct[e].value=P((t=this.parentProduct)==null?void 0:t[e]),e==="searchKeywords"&&this.setProductSearchKeywords()})},getParentProduct(){return this.productRepository.get(this.$route.params.parentId,Shopware.Context.api,this.productCriteria).then(e=>{e.stock=null,Shopware.Store.get("swProductDetail").parentProduct=e,this.parentProductFrozen=JSON.stringify(e)}).catch(()=>{Shopware.Store.get("swProductDetail").parentProduct={}})},loadDefaultCurrency(){return this.currencyRepository.get(_.app.systemCurrencyId).then(e=>{this.currency=e})},defineBulkEditData(e,t=null,i="overwrite",r=!1){if(!this.bulkEditProduct[e]){if(e==="stock"){this.bulkEditProduct[e]={value:t,type:i,isChanged:r,isInherited:!1};return}this.bulkEditProduct[e]={isChanged:r,type:i,value:t,isInherited:this.isChild}}},loadBulkEditData(){[this.generalFormFields,this.deliverabilityFormFields,this.pricesFormFields,this.advancedPricesFormFields,this.propertyFormFields,this.assignmentFormFields,this.mediaFormFields,this.labellingFormFields,this.seoFormFields,this.measuresPackagingFields,this.essentialCharacteristicsFormFields].forEach(t=>{t.forEach(i=>{this.defineBulkEditData(i.name)})})},loadCustomFieldSets(){return this.customFieldSetRepository.search(this.customFieldSetCriteria).then(e=>{this.customFieldSets=e})},loadTaxes(){return this.taxRepository.search(this.taxCriteria).then(e=>{var t;this.taxRate=this.isChild?(t=this.parentProduct)==null?void 0:t.tax:e[0],Shopware.Store.get("swProductDetail").setTaxes(e)})},productTaxRate(){return this.taxes?this.taxes.find(e=>{var t;return e.id===((t=this.product)==null?void 0:t.taxId)}):{}},loadCurrencies(){return this.currencyRepository.search(new a(1,500)).then(e=>{Shopware.Store.get("swProductDetail").currencies=e})},definePricesBulkEdit(){var e,t;if(this.isComponentMounted){if(this.isChild&&!k.isEmpty(this.parentProduct)){this.product.price=this.parentProduct.price,this.product.purchasePrices=this.parentProduct.purchasePrices,this.setProductPrice("listPrice"),this.setProductPrice("regulationPrice");return}(e=this.product).price??(e.price=[{currencyId:this.currency.id,net:null,linked:!0,gross:null}]),(t=this.product).purchasePrices??(t.purchasePrices=[{currencyId:this.currency.id,net:null,linked:!0,gross:null}]),this.product.listPrice=[{currencyId:this.currency.id,net:null,linked:!0,gross:null}],this.product.regulationPrice=[{currencyId:this.currency.id,net:null,linked:!0,gross:null}]}},setProductPrice(e){var i;const t=[{currencyId:this.currency.id,net:null,linked:!0,gross:null}];k.isEmpty((i=this.parentProduct.price)==null?void 0:i[0][e])?this.product[e]=t:this.product[e]=[this.parentProduct.price[0][e]]},onChangePrices(e,t=null){if(e==="taxId"){this.taxRate=this.productTaxRate();return}e==="price"&&(this.isDisabledListPrice=!this.bulkEditProduct.price.isChanged,this.isDisabledRegulationPrice=!this.bulkEditProduct.price.isChanged),t&&typeof t!="boolean"&&(this.product[e]=[t])},onCustomFieldsChange(e){if(Object.keys(e).length<=0){this.bulkEditSelected=this.bulkEditSelected.filter(i=>i.field!=="customFields");return}const t={field:"customFields",type:"overwrite",value:e};this.bulkEditSelected.push(t)},onProcessData(){let e=!1,t=!1;Object.keys(this.bulkEditProduct).forEach(i=>{const r=P(this.bulkEditProduct[i]);if(!r.isChanged)return;if(i==="listPrice"){e=!0;return}if(i==="regulationPrice"){t=!0;return}let s=this.product[i];["minPurchase","maxPurchase","purchaseSteps","restockTime"].includes(i)&&r.type==="clear"?(s=null,r.type="overwrite"):i==="searchKeywords"&&(i="customSearchKeywords"),r.isInherited&&(s=null);const c={field:i,type:r.type,value:s};i==="visibilities"?c.mappingReferenceField="salesChannelId":i==="media"?c.mappingReferenceField="mediaId":i==="prices"&&(c.mappingReferenceField="ruleId"),this.isChild&&c.value!==null&&k.isArray(c.value)&&c.value.forEach(d=>{delete d.id}),this.bulkEditSelected.push(c)}),e&&this.processListPrice(),t&&this.processRegulationPrice()},processListPrice(){var t;const e=this.bulkEditSelected.find(i=>i.field==="price"&&!k.isEmpty(i.value));e&&(e.value[0].listPrice=(t=this.product)==null?void 0:t.listPrice[0])},processRegulationPrice(){var t;const e=this.bulkEditSelected.find(i=>i.field==="price"&&!k.isEmpty(i.value));e&&(e.value[0].regulationPrice=(t=this.product)==null?void 0:t.regulationPrice[0])},openModal(){this.isComponentMounted=!1,this.$router.push({name:"sw.bulk.edit.product.save",params:{parentId:this.$route.params.parentId}})},async onSave(){this.isLoading=!0,this.onProcessData();const t=I(this.selectedIds,50).map(i=>this.bulkEditApiFactory.getHandler("product").bulkEdit(i,this.bulkEditSelected));return this.bulkEditSelected=[],Promise.all(t).then(i=>{const r=i.every(s=>s.data);this.processStatus=r?"success":"fail"}).catch(()=>{this.processStatus="fail"}).finally(()=>{this.isLoading=!1})},closeModal(){this.$router.push({name:"sw.bulk.edit.product"})},onChangeLanguage(e){Shopware.Store.get("context").setApiLanguageId(e)},loadRules(){return this.ruleRepository.search(this.ruleCriteria).then(e=>{this.rules=e})},onRuleChange(e){var t,i,r;if(e.length>((t=this.product)==null?void 0:t.prices.length)){const s=this.priceRepository.create();s.productId=(i=this.product)==null?void 0:i.id,s.quantityStart=1,s.quantityEnd=null,s.currencyId=this.defaultCurrency.id,s.price=[{currencyId:this.defaultCurrency.id,gross:0,linked:this.defaultPrice.linked,net:0,listPrice:null,regulationPrice:null}],this.defaultPrice.listPrice&&(s.price[0].listPrice={currencyId:this.defaultCurrency.id,gross:this.defaultPrice.listPrice.gross,linked:this.defaultPrice.listPrice.linked,net:this.defaultPrice.listPrice.net}),this.defaultPrice.regulationPrice&&(s.price[0].regulationPrice={currencyId:this.defaultCurrency.id,gross:this.defaultPrice.regulationPrice.gross,linked:this.defaultPrice.regulationPrice.linked,net:this.defaultPrice.regulationPrice.net}),e.forEach(c=>{var d,l;(d=this.product)!=null&&d.prices.some(o=>o.ruleId===c.ruleId)||(s.ruleId=c.id,s.ruleName=c.name,(l=this.product)==null||l.prices.add(s))});return}(r=this.product)==null||r.prices.forEach(s=>{var c;e.some(d=>s.ruleId===d.ruleId)||(c=this.product)==null||c.prices.remove(s.id)})},onInheritanceRestore(e){const t=JSON.parse(this.parentProductFrozen);if(this.bulkEditProduct[e.name].isInherited=!0,this.bulkEditProduct[e.name].value=t[e.name],e.name==="taxId"){this.taxRate=t.tax,this.product.taxId=t.taxId;return}if(e.name==="isPriceInherited"){this.product.price[0]=t.price[0],this.product.purchasePrices[0]=t.purchasePrices[0];const i=k.isEmpty(t.price[0].listPrice)?{currencyId:this.currency.id,net:null,linked:!0,gross:null}:t.price[0].listPrice;this.product.listPrice=[i],this.product.price[0].listPrice=i;const r=k.isEmpty(t.price[0].regulationPrice)?{currencyId:this.currency.id,net:null,linked:!0,gross:null}:t.price[0].regulationPrice;this.product.regulationPrice=[r],this.product.price[0].regulationPrice=r;return}if(e.name==="categories"){this.setProductAssociation(e.name,t);return}if(e.name==="media"){this.product.media=t.media;return}if(e.name==="prices"){this.setProductAssociation(e.name,t);return}if(e.name==="properties"){this.setProductAssociation(e.name,t);return}if(e.name==="searchKeywords"){this.setProductSearchKeywords();return}this.$set(this.product,e.name,t[e.name])},onInheritanceRemove(e){["properties","prices"].includes(e.name)&&this.setProductAssociation(e.name),this.bulkEditProduct[e.name].isInherited=!1},setProductSearchKeywords(){var e;if(k.isEmpty((e=this.parentProduct)==null?void 0:e.customSearchKeywords)){this.bulkEditProduct.searchKeywords.value=[],this.product.searchKeywords=[];return}this.bulkEditProduct.searchKeywords.value=this.parentProduct.customSearchKeywords,this.product.searchKeywords=this.parentProduct.customSearchKeywords},setProductAssociation(e,t=null){if(this.product[e].getIds().forEach(r=>this.product[e].remove(r)),!t){this.bulkEditProduct[e].value=[];return}t[e].forEach(r=>this.product[e].add(r))}}};export{E as default};
