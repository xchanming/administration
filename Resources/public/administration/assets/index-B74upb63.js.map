{"version":3,"file":"index-B74upb63.js","sources":["../../../app/administration/src/module/sw-product/component/sw-product-price-form/sw-product-price-form.html.twig","../../../app/administration/src/module/sw-product/component/sw-product-price-form/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_product_price_form %}\n<div class=\"sw-product-price-form\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_price_form_fields %}\n    <sw-container\n        columns=\"1fr 2fr\"\n        gap=\"0px 30px\"\n        class=\"sw-product-price-form__prices\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_price_form_tax_field %}\n        <sw-inherit-wrapper\n            ref=\"taxIdInheritation\"\n            v-model:value=\"product.taxId\"\n            :inherited-value=\"parentProduct.taxId\"\n            :has-parent=\"!!parentProduct.taxId\"\n            :help-text=\"taxRateHelpText\"\n            :label=\"$tc('sw-product.priceForm.labelTaxRate')\"\n            class=\"sw-product-price-form__tax-rate\"\n            required\n        >\n            <template #content=\"{ currentValue, updateCurrentValue, isInherited }\">\n\n                <sw-select-field\n                    name=\"sw-field--product-taxId\"\n                    :placeholder=\"$tc('sw-product.priceForm.placeholderTaxRate')\"\n                    validation=\"required\"\n                    :disabled=\"isInherited || !allowEdit || undefined\"\n                    :value=\"currentValue\"\n                    :error=\"productTaxIdError\"\n                    @update:value=\"updateCurrentValue\"\n                >\n                    <option\n                        v-for=\"tax in taxes\"\n                        :key=\"tax.id\"\n                        :value=\"tax.id\"\n                        :selected=\"currentValue === tax.id\"\n                    >\n                        {{ getTaxLabel(tax) }}\n                    </option>\n                </sw-select-field>\n\n            </template>\n        </sw-inherit-wrapper>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_price_form_price_field %}\n        <sw-inherit-wrapper\n            v-if=\"!isLoading\"\n            v-model:value=\"prices\"\n            label=\" \"\n            class=\"sw-product-price-form__price-list\"\n            :has-parent=\"!!parentProduct.id\"\n            :inherited-value=\"parentPrices\"\n            :custom-remove-inheritance-function=\"removePriceInheritation\"\n            :custom-inheritation-check-function=\"inheritationCheckFunction\"\n        >\n            <template #content=\"{ currentValue, isInherited }\">\n                <sw-list-price-field\n                    vertical\n                    :price=\"currentValue.price\"\n                    :purchase-prices=\"currentValue.purchasePrices\"\n                    :tax-rate=\"productTaxRate\"\n                    :disabled=\"isInherited || !allowEdit || undefined\"\n                    :error=\"productPriceError ? productPriceError[0] : null\"\n                    :currency=\"defaultCurrency\"\n                    :show-setting-price=\"showModeSetting\"\n                />\n            </template>\n        </sw-inherit-wrapper>\n        {% endblock %}\n\n    </sw-container>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_price_form_link %}\n    <sw-container\n        columns=\"1fr\"\n        justify=\"end\"\n        class=\"sw-product-price-form__links\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_price_form_advanced_prices_link %}\n        <router-link\n            v-if=\"!product._isNew\"\n            :to=\"{ name: 'sw.product.detail.prices', params: { id: $route.params.id } }\"\n            class=\"sw-card__quick-link\"\n        >\n            {{ $tc('sw-product.detailBase.linkAdvancedPrices') }} <sw-icon\n                name=\"regular-long-arrow-right\"\n                small\n            />\n        </router-link>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_price_form_maintain_currencies_link %}\n        <a\n            v-if=\"product.price\"\n            class=\"sw-card__quick-link\"\n            role=\"button\"\n            tabindex=\"0\"\n            @click.prevent=\"displayMaintainCurrencies = true\"\n            @keydown.enter.prevent=\"displayMaintainCurrencies = true\"\n        >\n            {{ $tc('sw-product.detailBase.linkMaintainCurrencyPrices') }} <sw-icon\n                name=\"regular-long-arrow-right\"\n                small\n            />\n        </a>\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_price_form_maintain_currencies_modal %}\n    <sw-maintain-currencies-modal\n        v-if=\"displayMaintainCurrencies\"\n        :currencies=\"currencies\"\n        :prices=\"product.price\"\n        :default-price=\"defaultPrice\"\n        :tax-rate=\"productTaxRate\"\n        :disabled=\"!allowEdit || undefined\"\n        @modal-close=\"onMaintainCurrenciesClose\"\n        @update-prices=\"updatePrices\"\n    />\n    {% endblock %}\n</div>\n{% endblock %}\n","/*\n * @package inventory\n */\n\nimport template from './sw-product-price-form.html.twig';\nimport './sw-product-price-form.scss';\n\nconst { Mixin } = Cicada;\nconst { mapPropertyErrors, mapState, mapGetters } = Cicada.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    mixins: [\n        Mixin.getByName('placeholder'),\n    ],\n\n    props: {\n        allowEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            displayMaintainCurrencies: false,\n        };\n    },\n\n    computed: {\n        ...mapGetters('swProductDetail', [\n            'isLoading',\n            'defaultPrice',\n            'defaultCurrency',\n            'productTaxRate',\n            'showModeSetting',\n        ]),\n\n        ...mapState('swProductDetail', [\n            'product',\n            'parentProduct',\n            'taxes',\n            'currencies',\n        ]),\n\n        ...mapPropertyErrors('product', [\n            'taxId',\n            'price',\n            'purchasePrices',\n        ]),\n\n        taxRateHelpText() {\n            const link = {\n                name: 'sw.settings.tax.index',\n            };\n\n            return this.$tc('sw-product.priceForm.taxRateHelpText.label', 0, {\n                link: `<sw-internal-link\n                           :router-link=${JSON.stringify(link)}\n                           :inline=\"true\">\n                           ${this.$tc('sw-product.priceForm.taxRateHelpText.linkText')}\n                      </sw-internal-link>`,\n            });\n        },\n\n        prices: {\n            get() {\n                const prices = {\n                    price: [],\n                    purchasePrices: [],\n                };\n\n                if (this.product && Array.isArray(this.product.price)) {\n                    prices.price = [...this.product.price];\n                }\n\n                if (this.product && Array.isArray(this.product.purchasePrices)) {\n                    prices.purchasePrices = [...this.product.purchasePrices];\n                }\n\n                return prices;\n            },\n\n            set(newValue) {\n                this.product.price = newValue?.price || null;\n                this.product.purchasePrices = newValue?.purchasePrices || null;\n            },\n        },\n\n        parentPrices() {\n            return {\n                price: this.product.price || this.parentProduct.price,\n                purchasePrices: this.product.purchasePrices || this.parentProduct.purchasePrices,\n            };\n        },\n    },\n\n    methods: {\n        removePriceInheritation(refPrice) {\n            const defaultRefPrice = refPrice.price?.find((price) => price.currencyId === this.defaultCurrency.id);\n            const defaultRefPurchasePrice = refPrice.purchasePrices?.find(\n                (price) => price.currencyId === this.defaultCurrency.id,\n            );\n\n            const prices = {\n                price: [],\n                purchasePrices: [],\n            };\n\n            if (defaultRefPrice) {\n                prices.price.push({\n                    currencyId: defaultRefPrice.currencyId,\n                    gross: defaultRefPrice.gross,\n                    net: defaultRefPrice.net,\n                    linked: defaultRefPrice.linked,\n                    listPrice: defaultRefPrice.listPrice ? defaultRefPrice.listPrice : null,\n                    regulationPrice: defaultRefPrice.regulationPrice ? defaultRefPrice.regulationPrice : null,\n                });\n            }\n\n            if (defaultRefPurchasePrice) {\n                prices.purchasePrices.push({\n                    currencyId: defaultRefPurchasePrice.currencyId,\n                    gross: defaultRefPurchasePrice.gross,\n                    net: defaultRefPurchasePrice.net,\n                    linked: defaultRefPurchasePrice.linked,\n                });\n            }\n\n            return prices;\n        },\n\n        inheritationCheckFunction() {\n            return !this.prices.price.length && !this.prices.purchasePrices.length;\n        },\n\n        onMaintainCurrenciesClose(prices) {\n            this.product.price = prices;\n\n            this.displayMaintainCurrencies = false;\n        },\n\n        /**\n         * @deprecated tag:v6.7.0 - Will be removed without replacement\n         */\n        keymonitor(event) {\n            if (event.key === ',') {\n                const value = event.currentTarget.value;\n                event.currentTarget.value = value.replace(/.$/, '.');\n            }\n        },\n\n        getTaxLabel(tax) {\n            if (this.$te(`global.tax-rates.${tax.name}`)) {\n                return this.$tc(`global.tax-rates.${tax.name}`);\n            }\n\n            return tax.name;\n        },\n\n        updatePrices(index) {\n            this.product.price.splice(index, 1);\n        },\n    },\n};\n"],"names":["template","Mixin","mapPropertyErrors","mapState","mapGetters","index","link","prices","newValue","refPrice","_a","_b","defaultRefPrice","price","defaultRefPurchasePrice","event","value","tax"],"mappings":"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"}