const a='{% block sw_bulk_edit_product_media %} <div class="sw-bulk-edit-product-media"> {% block sw_bulk_edit_product_media_form %} <sw-bulk-edit-product-media-form :disabled="disabled || undefined" @media-open="showMediaModal = true" /> {% endblock %} {% block sw_bulk_edit_product_media_modal %} <sw-media-modal-v2 v-if="showMediaModal" :initial-folder-id="mediaDefaultFolderId" :entity-context="product.getEntityName()" @media-modal-selection-change="onAddMedia" @modal-close="showMediaModal = false" /> {% endblock %} </div> {% endblock %}',{Context:o,Utils:r,Mixin:l}=Cicada,{Criteria:i}=Cicada.Data,{mapState:s}=Cicada.Component.getComponentHelper(),{isEmpty:n}=r.types,c={template:a,compatConfig:Cicada.compatConfig,inject:["repositoryFactory"],mixins:[l.getByName("notification")],props:{disabled:{type:Boolean,required:!1,default:!1}},data(){return{showMediaModal:!1,mediaDefaultFolderId:null}},computed:{...s("swProductDetail",["product"]),productMediaRepository(){return this.repositoryFactory.create("product_media")},mediaDefaultFolderRepository(){return this.repositoryFactory.create("media_default_folder")},mediaDefaultFolderCriteria(){const e=new i(1,1);return e.addAssociation("folder"),e.addFilter(i.equals("entity","product")),e}},created(){this.createdComponent()},methods:{createdComponent(){this.loadMediaDefaultFolder()},loadMediaDefaultFolder(){this.getMediaDefaultFolderId().then(e=>{this.mediaDefaultFolderId=e})},getMediaDefaultFolderId(){return this.mediaDefaultFolderRepository.search(this.mediaDefaultFolderCriteria,o.api).then(e=>{var d;const t=e.first();return t===null?null:(d=t.folder)!=null&&d.id?t.folder.id:null})},onAddMedia(e){n(e)||e.forEach(t=>{this.addMedia(t).catch(({fileName:d})=>{this.createNotificationError({message:this.$tc("sw-product.mediaForm.errorMediaItemDuplicated",0,{fileName:d})})})})},addMedia(e){if(this.isExistingMedia(e))return Promise.reject(e);const t=this.productMediaRepository.create(Cicada.Context.api);return t.mediaId=e.id,t.media={url:e.url,id:e.id},this.product.media.add(t),Promise.resolve()},isExistingMedia(e){return this.product.media.some(({id:t,mediaId:d})=>t===e.id||d===e.id)}}};export{c as default};
//# sourceMappingURL=index-CtNz1SvQ.js.map
