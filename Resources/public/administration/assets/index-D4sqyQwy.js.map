{"version":3,"file":"index-D4sqyQwy.js","sources":["../../../app/administration/src/module/sw-order/component/sw-order-create-options/sw-order-create-options.html.twig","../../../app/administration/src/module/sw-order/component/sw-order-create-options/index.ts"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_order_create_options %}\n<div class=\"sw-order-create-options\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_container %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_order %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_order_headline %}\n    <h3 class=\"sw-order-create-options__headline\">\n        {{ $tc('sw-order.initialModal.options.textHeadlineOrder') }}\n    </h3>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_order_switch_disable_auto_promotion %}\n    <sw-switch-field\n        class=\"sw-order-create-options__disable-auto-promotion\"\n        :value=\"disabledAutoPromotion\"\n        :label=\"$tc('sw-order.createBase.labelToggleAutomaticPromotions')\"\n        @update:value=\"onToggleAutoPromotion\"\n    />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_order_field_container %}\n    <sw-container\n        class=\"sw-order-create-options__order-container\"\n        gap=\"0px 32px\"\n        columns=\"1fr 1fr\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_order_language %}\n        <sw-entity-single-select\n            v-model:value=\"context.languageId\"\n            entity=\"language\"\n            class=\"sw-order-create-options__order-language\"\n            :criteria=\"salesChannelCriteria\"\n            :label=\"$tc('sw-order.createBase.labelOrderLanguage')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderOrderLanguage')\"\n            show-clearable-button\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_promotions %}\n        <sw-multi-tag-select\n            class=\"sw-order-create-options__promotion-code\"\n            :value=\"promotionCodes\"\n            :label=\"$tc('sw-order.createBase.labelPromotions')\"\n            :validate=\"validatePromotions\"\n            @update:value=\"changePromotionCodes\"\n        >\n            <template #message-add-data>\n                <span>{{ $tc('sw-order.initialModal.options.placeholderAddPromotion') }}</span>\n            </template>\n            <template #message-enter-valid-data>\n                <span>{{ $tc('sw-order.createBase.placeholderAddPromotion') }}</span>\n            </template>\n        </sw-multi-tag-select>\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_payment %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_payment_headline %}\n    <h3>{{ $tc('sw-order.initialModal.options.textHeadlinePayment') }}</h3>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_payment_container %}\n    <sw-container\n        class=\"sw-order-create-options__payment-container\"\n        gap=\"0px 32px\"\n        columns=\"1fr 1fr\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_payment_method %}\n        <sw-entity-single-select\n            v-model:value=\"context.paymentMethodId\"\n            entity=\"payment_method\"\n            label-property=\"distinguishableName\"\n            class=\"sw-order-create-options__payment-method\"\n            :criteria=\"paymentMethodCriteria\"\n            :label=\"$tc('sw-order.createBase.labelPaymentMethod')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderPaymentMethod')\"\n            show-clearable-button\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_billing_address %}\n        <sw-order-customer-address-select\n            v-model:value=\"context.billingAddressId\"\n            class=\"sw-order-create-options__billing-address\"\n            :label=\"$tc('sw-order.createBase.labelBillingAddress')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderBillingAddress')\"\n            :same-address-value=\"context.shippingAddressId\"\n            :customer=\"customer\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_order_currency %}\n        <sw-entity-single-select\n            v-model:value=\"context.currencyId\"\n            class=\"sw-order-create-options__currency-select\"\n            entity=\"currency\"\n            :criteria=\"salesChannelCriteria\"\n            :label=\"$tc('sw-order.createBase.labelCurrency')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderCurrency')\"\n            show-clearable-button\n        />\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_shipment %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_create_options_shipment_headline %}\n    <h3>{{ $tc('sw-order.initialModal.options.textHeadlineShipment') }}</h3>\n    {% endblock %}\n\n    <sw-container\n        class=\"sw-order-create-options__shipping-container\"\n        gap=\"0px 32px\"\n        columns=\"1fr 1fr\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_shipping_method %}\n        <sw-entity-single-select\n            v-model:value=\"context.shippingMethodId\"\n            class=\"sw-order-create-options__shipping-method\"\n            entity=\"shipping_method\"\n            show-clearable-button\n            :criteria=\"shippingMethodCriteria\"\n            :label=\"$tc('sw-order.createBase.labelShippingMethod')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderShippingMethod')\"\n        />\n        {% endblock %}\n\n        <sw-number-field\n            v-model:value=\"shippingCost\"\n            class=\"sw-order-create-options__shipping-cost\"\n            :label=\"$tc('sw-order.initialModal.options.labelShippingCosts')\"\n            @update:value=\"onChangeShippingCost\"\n        >\n            <template #suffix>\n                {{ currency.symbol }}\n            </template>\n        </sw-number-field>\n\n        <sw-switch-field\n            v-model:value=\"isSameAsBillingAddress\"\n            name=\"sw-field--isSameAsBillingAddress\"\n            :label=\"$tc('sw-order.initialModal.options.labelSameAsBillingAddress')\"\n        />\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_order_create_options_shipping_address %}\n        <sw-order-customer-address-select\n            v-model:value=\"context.shippingAddressId\"\n            class=\"sw-order-create-options__shipping-address\"\n            :label=\"$tc('sw-order.createBase.labelShippingAddress')\"\n            :placeholder=\"$tc('sw-order.createBase.placeholderShippingAddress')\"\n            :same-address-label=\"$tc('sw-order.initialModal.options.textSameAsBillingAddress')\"\n            :same-address-value=\"context.billingAddressId\"\n            :customer=\"customer\"\n            :disabled=\"isSameAsBillingAddress\"\n        />\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n    {% endblock %}\n</div>\n{% endblock %}\n","import type { Entity } from '@cicada-ag/meteor-admin-sdk/es/_internals/data/Entity';\nimport type { PropType } from 'vue';\nimport type CriteriaType from 'src/core/data/criteria.data';\n\nimport template from './sw-order-create-options.html.twig';\nimport './sw-order-create-options.scss';\n\nimport type { ContextSwitchParameters, Cart, CartDelivery } from '../../order.types';\n\n/**\n * @package checkout\n */\n\nconst { Component, State } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default Component.wrapComponentConfig({\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    props: {\n        promotionCodes: {\n            type: Array as PropType<string[]>,\n            required: true,\n        },\n\n        disabledAutoPromotion: {\n            type: Boolean,\n            required: true,\n        },\n\n        context: {\n            type: Object as PropType<ContextSwitchParameters>,\n            required: true,\n        },\n    },\n\n    data(): {\n        shippingCost: number;\n        promotionCodeTags: string[];\n        isSameAsBillingAddress: boolean;\n    } {\n        return {\n            shippingCost: 0,\n            isSameAsBillingAddress: false,\n            promotionCodeTags: [],\n        };\n    },\n\n    computed: {\n        salesChannelId(): string {\n            return State.get('swOrder').context?.salesChannel?.id ?? '';\n        },\n\n        salesChannelCriteria(): CriteriaType {\n            const criteria = new Criteria();\n\n            if (this.salesChannelId) {\n                criteria.addFilter(Criteria.equals('salesChannels.id', this.salesChannelId));\n            }\n\n            return criteria;\n        },\n\n        shippingMethodCriteria(): CriteriaType {\n            const criteria = new Criteria();\n            criteria.addFilter(Criteria.equals('active', 1));\n\n            if (this.salesChannelId) {\n                criteria.addFilter(Criteria.equals('salesChannels.id', this.salesChannelId));\n            }\n\n            return criteria;\n        },\n\n        paymentMethodCriteria(): CriteriaType {\n            const criteria = new Criteria();\n            criteria.addFilter(Criteria.equals('active', 1));\n\n            if (this.salesChannelId) {\n                criteria.addFilter(Criteria.equals('salesChannels.id', this.salesChannelId));\n            }\n\n            return criteria;\n        },\n\n        customer(): Entity<'customer'> | null {\n            return State.get('swOrder').customer;\n        },\n\n        currency(): Entity<'currency'> {\n            return State.get('swOrder').context.currency;\n        },\n\n        cart(): Cart {\n            return State.get('swOrder').cart;\n        },\n\n        cartDelivery(): CartDelivery | null {\n            return this.cart?.deliveries[0] as CartDelivery | null;\n        },\n    },\n\n    watch: {\n        cartDelivery: {\n            immediate: true,\n            handler(value): void {\n                // eslint-disable-next-line max-len\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-assignment\n                this.shippingCost = value?.shippingCosts?.totalPrice ?? 0;\n            },\n        },\n\n        'context.currencyId': {\n            async handler(): Promise<void> {\n                // await this.getCurrency();\n                await this.updateCartContext();\n            },\n        },\n\n        'context.shippingAddressId': {\n            handler(): void {\n                this.updateSameAsBillingAddressToggle();\n            },\n        },\n\n        'context.billingAddressId': {\n            handler(): void {\n                this.updateSameAsBillingAddressToggle();\n            },\n        },\n\n        'context.shippingMethodId': {\n            async handler(): Promise<void> {\n                await this.updateCartContext();\n            },\n        },\n\n        'context.languageId'(languageId: string) {\n            if (!languageId) {\n                return;\n            }\n\n            State.commit('context/setLanguageId', languageId);\n        },\n\n        isSameAsBillingAddress(value): void {\n            if (!value) {\n                return;\n            }\n\n            this.context.shippingAddressId = this.context.billingAddressId;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        updateSameAsBillingAddressToggle(): void {\n            this.isSameAsBillingAddress = this.context.shippingAddressId === this.context.billingAddressId;\n        },\n\n        createdComponent(): void {\n            this.promotionCodeTags = [...this.promotionCodes];\n            this.isSameAsBillingAddress = this.context.shippingAddressId === this.context.billingAddressId;\n        },\n\n        validatePromotions(searchTerm: string): boolean {\n            const promotionCode = searchTerm.trim();\n\n            if (promotionCode.length <= 0) {\n                return false;\n            }\n\n            const isExist = this.promotionCodes.find((code: string) => code === promotionCode);\n            return !isExist;\n        },\n\n        onToggleAutoPromotion(value: boolean): void {\n            this.$emit('auto-promotion-toggle', value);\n        },\n\n        changePromotionCodes(value: string[]): void {\n            this.$emit('promotions-change', value);\n        },\n\n        async updateCartContext(): Promise<void> {\n            if (!this.salesChannelId) {\n                return;\n            }\n\n            await this.updateOrderContext();\n            await this.loadCart();\n        },\n\n        updateOrderContext(): Promise<void> {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n            return State.dispatch('swOrder/updateOrderContext', {\n                context: this.context,\n                salesChannelId: this.salesChannelId,\n                contextToken: this.cart.token,\n            });\n        },\n\n        loadCart(): Promise<void> {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n            return State.dispatch('swOrder/getCart', {\n                salesChannelId: this.salesChannelId,\n                contextToken: this.cart.token,\n            });\n        },\n\n        onChangeShippingCost(value: number): void {\n            this.$emit('shipping-cost-change', value);\n        },\n    },\n});\n"],"names":["template","Component","State","Criteria","index","_a","_b","criteria","value","languageId","searchTerm","promotionCode","code"],"mappings":"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"}