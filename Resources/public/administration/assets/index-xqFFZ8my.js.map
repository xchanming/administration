{"version":3,"file":"index-xqFFZ8my.js","sources":["../../../app/administration/src/module/sw-product/view/sw-product-detail-reviews/sw-product-detail-reviews.html.twig","../../../app/administration/src/module/sw-product/view/sw-product-detail-reviews/index.js"],"sourcesContent":["<div class=\"sw-product-detail-reviews\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_detail_reviews %}\n    <div v-if=\"isLoading\">\n        <sw-skeleton />\n        <sw-skeleton />\n    </div>\n\n    <sw-card\n        v-if=\"!isLoading\"\n        class=\"sw-product-detail-reviews__list\"\n        position-identifier=\"sw-product-detail-reviews\"\n        :title=\"cardTitle\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_detail_reviews_data %}\n        <template\n            v-if=\"total\"\n            #grid\n        >\n            <sw-data-grid\n                ref=\"gridReview\"\n                :data-source=\"dataSource\"\n                :columns=\"reviewColumns\"\n                :is-loading=\"isLoading\"\n                :show-selection=\"false\"\n                :show-actions=\"true\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_data_stars %}\n                <template #column-points=\"{ item }\">\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_product_detail_reviews_data_stars_content %}\n\n                    <sw-rating-stars :value=\"item.points\" />\n\n                    {% endblock %}\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_data_status %}\n                <template #column-status=\"{ item }\">\n                    <sw-data-grid-column-boolean\n                        v-model:value=\"item.status\"\n                        :is-inline-edit=\"false\"\n                    />\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_data_created_at %}\n                <template #column-createdAt=\"{ item }\">\n                    {{ dateFilter(item.createdAt, { hour: '2-digit', minute: '2-digit', second: '2-digit' }) }}\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_data_action %}\n                <template #actions=\"{ item }\">\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_product_detail_reviews_data_action_edit %}\n                    <sw-context-menu-item\n                        class=\"sw-product-detail-reviews__action-edit\"\n                        :disabled=\"!acl.can('product.editor') || undefined\"\n                        :router-link=\"{ name: 'sw.review.detail', params: { id: item.id } }\"\n                    >\n                        {{ $tc('sw-product.reviewForm.contextMenuEdit') }}\n                    </sw-context-menu-item>\n                    {% endblock %}\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_product_detail_reviews_data_action_delete %}\n                    <sw-context-menu-item\n                        class=\"sw-product-detail-reviews__action-delete\"\n                        variant=\"danger\"\n                        :disabled=\"!acl.can('product.editor') || undefined\"\n                        @click=\"onStartReviewDelete(item)\"\n                    >\n                        {{ $tc('sw-product.reviewForm.contextMenuDelete') }}\n                    </sw-context-menu-item>\n                    {% endblock %}\n                </template>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_data_pagination %}\n                <template #pagination>\n                    <sw-pagination\n                        :total=\"total\"\n                        :limit=\"limit\"\n                        :page=\"page\"\n                        :total-visible=\"7\"\n                        :steps=\"[10]\"\n                        @page-change=\"onChangePage\"\n                    />\n                </template>\n                {% endblock %}\n            </sw-data-grid>\n        </template>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_detail_reviews_empty_state %}\n\n        <sw-empty-state\n            v-if=\"!total\"\n            :title=\"$tc('sw-product.reviewForm.messageEmptyTitle')\"\n            :subline=\"$tc('sw-product.reviewForm.messageEmptySubline')\"\n            :absolute=\"false\"\n            empty-module\n        >\n            <template #icon>\n                <img\n                    :src=\"assetFilter('/administration/static/img/empty-states/products-empty-state.svg')\"\n                    :alt=\"$tc('sw-product.reviewForm.messageEmptyTitle')\"\n                >\n            </template>\n\n            <template #actions>\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_empty_state_button %}\n                <sw-button\n                    variant=\"ghost\"\n                    :router-link=\"{ name: 'sw.review.index' }\"\n                >\n                    {{ $tc('sw-product.reviewForm.emptyStateButton') }}\n                </sw-button>\n                {% endblock %}\n            </template>\n        </sw-empty-state>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_detail_reviews_modal_delete %}\n        <sw-modal\n            v-if=\"showReviewDeleteModal\"\n            variant=\"small\"\n            :title=\"$tc('sw-product.reviewForm.modal.confirmTitle')\"\n            @modal-close=\"onCancelReviewDelete\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_reviews_modal_delete_body %}\n            <p>{{ $tc('sw-product.reviewForm.modal.confirmText') }}</p>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_reviews_modal_delete_footer %}\n            <template #modal-footer>\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_modal_delete_button_cancel %}\n                <sw-button\n                    size=\"small\"\n                    @click=\"onCancelReviewDelete\"\n                >\n                    {{ $tc('global.default.cancel') }}\n                </sw-button>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_product_detail_reviews_modal_delete_button_confirm %}\n                <sw-button\n                    size=\"small\"\n                    variant=\"danger\"\n                    @click=\"onConfirmReviewDelete\"\n                >\n                    {{ $tc('sw-product.reviewForm.modal.buttonDelete') }}\n                </sw-button>\n                {% endblock %}\n            </template>\n            {% endblock %}\n        </sw-modal>\n        {% endblock %}\n    </sw-card>\n    {% endblock %}\n</div>\n","/*\n * @package inventory\n */\n\nimport template from './sw-product-detail-reviews.html.twig';\nimport './sw-product-detail-reviews.scss';\n\nconst { Component, Data, Context } = Cicada;\nconst { Criteria } = Data;\nconst { mapState, mapGetters } = Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    data() {\n        return {\n            showReviewDeleteModal: false,\n            deleteReviewId: null,\n            dataSource: [],\n            page: 1,\n            limit: 10,\n            total: 0,\n        };\n    },\n\n    computed: {\n        ...mapState('swProductDetail', [\n            'product',\n        ]),\n\n        ...mapGetters('swProductDetail', [\n            'isLoading',\n        ]),\n\n        cardTitle() {\n            return this.total ? this.$tc('sw-product.reviews.cardTitleReviews') : null;\n        },\n\n        reviewRepository() {\n            return this.repositoryFactory.create('product_review');\n        },\n\n        reviewCriteria() {\n            const criteria = new Criteria(this.page, this.limit);\n\n            criteria.addFilter(Criteria.equals('productId', this.product.id));\n            criteria.setTotalCountMode(1);\n\n            return criteria;\n        },\n\n        reviewColumns() {\n            return [\n                {\n                    property: 'points',\n                    dataIndex: 'points',\n                    label: this.$tc('sw-product.reviewForm.labelPoints'),\n                },\n                {\n                    property: 'status',\n                    dataIndex: 'status',\n                    label: this.$tc('sw-product.reviewForm.labelStatus'),\n                    align: 'center',\n                },\n                {\n                    property: 'createdAt',\n                    dataIndex: 'createdAt',\n                    label: this.$tc('sw-product.reviewForm.labelCreatedAt'),\n                },\n                {\n                    property: 'title',\n                    dataIndex: 'title',\n                    label: this.$tc('sw-product.reviewForm.labelTitle'),\n                    routerLink: 'sw.review.detail',\n                },\n            ];\n        },\n\n        assetFilter() {\n            return Cicada.Filter.getByName('asset');\n        },\n\n        dateFilter() {\n            return Cicada.Filter.getByName('date');\n        },\n    },\n\n    watch: {\n        'product.id': {\n            immediate: true,\n            handler(newValue) {\n                if (!newValue) {\n                    return;\n                }\n\n                this.getReviews();\n            },\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.getReviews();\n        },\n\n        getReviews() {\n            if (!this.product || !this.product.id) {\n                return;\n            }\n\n            this.reviewRepository.search(this.reviewCriteria, Context.api).then((reviews) => {\n                this.total = reviews.total;\n                this.dataSource = reviews;\n\n                if (this.total > 0 && this.dataSource.length <= 0) {\n                    this.page = this.page === 1 ? 1 : this.page - 1;\n                    this.getReviews();\n                }\n            });\n        },\n\n        onStartReviewDelete(review) {\n            this.deleteReviewId = review.id;\n            this.onShowReviewDeleteModal();\n        },\n\n        onCancelReviewDelete() {\n            this.deleteReviewId = null;\n            this.onCloseReviewDeleteModal();\n        },\n\n        onShowReviewDeleteModal() {\n            this.showReviewDeleteModal = true;\n        },\n\n        onCloseReviewDeleteModal() {\n            this.showReviewDeleteModal = false;\n        },\n\n        onConfirmReviewDelete() {\n            this.onCloseReviewDeleteModal();\n\n            this.reviewRepository.delete(this.deleteReviewId, Context.api).then(() => {\n                this.deleteReviewId = null;\n                this.getReviews();\n            });\n        },\n\n        onChangePage(data) {\n            this.page = data.page;\n            this.limit = data.limit;\n            this.getReviews();\n        },\n    },\n};\n"],"names":["template","Component","Data","Context","Criteria","mapState","mapGetters","index","criteria","newValue","reviews","review","data"],"mappings":"AAAA,MAAeA,EAAA,0rHCOT,CAAE,UAAAC,EAAW,KAAAC,EAAM,QAAAC,CAAO,EAAK,OAC/B,CAAE,SAAAC,CAAU,EAAGF,EACf,CAAE,SAAAG,EAAU,WAAAC,CAAU,EAAKL,EAAU,mBAAkB,EAG9CM,EAAA,CACX,SAAAP,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,KACH,EAED,MAAO,CACH,MAAO,CACH,sBAAuB,GACvB,eAAgB,KAChB,WAAY,CAAE,EACd,KAAM,EACN,MAAO,GACP,MAAO,CACnB,CACK,EAED,SAAU,CACN,GAAGK,EAAS,kBAAmB,CAC3B,SACZ,CAAS,EAED,GAAGC,EAAW,kBAAmB,CAC7B,WACZ,CAAS,EAED,WAAY,CACR,OAAO,KAAK,MAAQ,KAAK,IAAI,qCAAqC,EAAI,IACzE,EAED,kBAAmB,CACf,OAAO,KAAK,kBAAkB,OAAO,gBAAgB,CACxD,EAED,gBAAiB,CACb,MAAME,EAAW,IAAIJ,EAAS,KAAK,KAAM,KAAK,KAAK,EAEnD,OAAAI,EAAS,UAAUJ,EAAS,OAAO,YAAa,KAAK,QAAQ,EAAE,CAAC,EAChEI,EAAS,kBAAkB,CAAC,EAErBA,CACV,EAED,eAAgB,CACZ,MAAO,CACH,CACI,SAAU,SACV,UAAW,SACX,MAAO,KAAK,IAAI,mCAAmC,CACtD,EACD,CACI,SAAU,SACV,UAAW,SACX,MAAO,KAAK,IAAI,mCAAmC,EACnD,MAAO,QACV,EACD,CACI,SAAU,YACV,UAAW,YACX,MAAO,KAAK,IAAI,sCAAsC,CACzD,EACD,CACI,SAAU,QACV,UAAW,QACX,MAAO,KAAK,IAAI,kCAAkC,EAClD,WAAY,kBACf,CACjB,CACS,EAED,aAAc,CACV,OAAO,OAAO,OAAO,UAAU,OAAO,CACzC,EAED,YAAa,CACT,OAAO,OAAO,OAAO,UAAU,MAAM,CACxC,CACJ,EAED,MAAO,CACH,aAAc,CACV,UAAW,GACX,QAAQC,EAAU,CACTA,GAIL,KAAK,WAAU,CAClB,CACJ,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,WAAU,CAClB,EAED,YAAa,CACL,CAAC,KAAK,SAAW,CAAC,KAAK,QAAQ,IAInC,KAAK,iBAAiB,OAAO,KAAK,eAAgBN,EAAQ,GAAG,EAAE,KAAMO,GAAY,CAC7E,KAAK,MAAQA,EAAQ,MACrB,KAAK,WAAaA,EAEd,KAAK,MAAQ,GAAK,KAAK,WAAW,QAAU,IAC5C,KAAK,KAAO,KAAK,OAAS,EAAI,EAAI,KAAK,KAAO,EAC9C,KAAK,WAAU,EAEnC,CAAa,CACJ,EAED,oBAAoBC,EAAQ,CACxB,KAAK,eAAiBA,EAAO,GAC7B,KAAK,wBAAuB,CAC/B,EAED,sBAAuB,CACnB,KAAK,eAAiB,KACtB,KAAK,yBAAwB,CAChC,EAED,yBAA0B,CACtB,KAAK,sBAAwB,EAChC,EAED,0BAA2B,CACvB,KAAK,sBAAwB,EAChC,EAED,uBAAwB,CACpB,KAAK,yBAAwB,EAE7B,KAAK,iBAAiB,OAAO,KAAK,eAAgBR,EAAQ,GAAG,EAAE,KAAK,IAAM,CACtE,KAAK,eAAiB,KACtB,KAAK,WAAU,CAC/B,CAAa,CACJ,EAED,aAAaS,EAAM,CACf,KAAK,KAAOA,EAAK,KACjB,KAAK,MAAQA,EAAK,MAClB,KAAK,WAAU,CAClB,CACJ,CACL"}