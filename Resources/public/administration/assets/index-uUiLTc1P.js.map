{"version":3,"file":"index-uUiLTc1P.js","sources":["../../../app/administration/src/module/sw-cms/component/sw-cms-slot/sw-cms-slot.html.twig","../../../app/administration/src/module/sw-cms/component/sw-cms-slot/index.ts"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_cms_slot %}\n<div\n    :id=\"slotElementId\"\n    class=\"sw-cms-slot\"\n    :class=\"componentClasses\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content_component %}\n    <component\n        :is=\"elementConfig.component\"\n        v-if=\"elementConfig?.component\"\n        v-model:element=\"element\"\n        :element-data=\"elementConfig\"\n        :disabled=\"disabled || undefined\"\n    />\n    {% endblock %}\n\n    {# This is just a quick inline design which needs to be refactored for a real design implementation #}\n    <div\n        v-else-if=\"elementNotFound\"\n        class=\"sw-cms-slot__element-not-found\"\n        style=\"\n            width: 100%;\n            min-height: 250px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            background-color: #fbe5ea;\n            border: 1px solid #de294c;\n            border-radius: 4px;\n            gap: 16px;\n        \"\n    >\n        <sw-icon\n            name=\"regular-exclamation-circle\"\n            color=\"#de294c\"\n        />\n\n        <div>\n            <p style=\"color: #de294c;\">\n                <strong>Element could not be load</strong>\n            </p>\n            <p style=\"color: #de294c; margin-top: 6px;\">\n                Please try again or select another element.\n            </p>\n        </div>\n    </div>\n\n    <div v-else>\n        <sw-skeleton-bar style=\"width: 100%; min-height: 250px;\" />\n    </div>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content_preview_overlay %}\n    <div\n        v-if=\"!active\"\n        class=\"sw-cms-slot__preview-overlay\"\n    ></div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content_overlay %}\n    <div\n        v-if=\"active\"\n        class=\"sw-cms-slot__overlay\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_slot_content_overlay_content %}\n        <div class=\"sw-cms-slot__actions\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_slot_content_overlay_action_settings %}\n            <div\n                v-tooltip.bottom=\"tooltipDisabled\"\n                class=\"sw-cms-slot__settings-action\"\n                :class=\"cmsSlotSettingsClasses\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"onSettingsButtonClick\"\n                @keydown.enter=\"onSelectElement(element.name)\"\n            >\n                <sw-icon\n                    name=\"regular-cog\"\n                    size=\"16\"\n                />\n            </div>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_slot_content_overlay_action_swap %}\n            <div\n                v-if=\"elementConfig?.removable !== false\"\n                class=\"sw-cms-slot__element-action\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"onElementButtonClick\"\n                @keydown.enter=\"onSelectElement(element.name)\"\n            >\n                <sw-icon\n                    name=\"regular-repeat\"\n                    size=\"16\"\n                />\n            </div>\n            {% endblock %}\n        </div>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content_settings_modal %}\n    <sw-modal\n        v-if=\"showElementSettings\"\n        class=\"sw-cms-slot__config-modal\"\n        :variant=\"modalVariant\"\n        :title=\"$tc('sw-cms.detail.title.elementSettingsModal')\"\n        @modal-close=\"onCloseSettingsModal\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_slot_content_settings_modal_component %}\n        <component\n            :is=\"elementConfig.configComponent\"\n            ref=\"elementComponentRef\"\n            v-model:element=\"element\"\n            :element-data=\"elementConfig\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_slot_content_settings_modal_footer %}\n        <template #modal-footer>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_slot_content_settings_modal_action_confirm %}\n            <sw-button\n                variant=\"primary\"\n                @click=\"onCloseSettingsModal\"\n            >\n                {{ $tc('sw-cms.detail.label.buttonElementSettingsConfirm') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_slot_content_element_modal %}\n    <sw-modal\n        v-if=\"showElementSelection\"\n        :title=\"$tc('sw-cms.detail.title.elementChangeModal')\"\n        @modal-close=\"onCloseElementModal\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_slot_content_element_modal_selection %}\n        <div class=\"sw-cms-slot__modal-container\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_slot_content_element_modal_selection_groups %}\n            <sw-sidebar-collapse\n                v-for=\"cmsElementGroup in groupedCmsElements\"\n                :key=\"cmsElementGroup.title\"\n                expand-on-loading\n                expand-chevron-direction=\"up\"\n            >\n                <template #header>\n                    {{ $tc(cmsElementGroup.title) }}\n                </template>\n\n                <template #content>\n                    <div class=\"sw-cms-slot__element-selection\">\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_cms_slot_content_element_modal_selection_element %}\n                        <template\n                            v-for=\"element in cmsElementGroup.items\"\n                            :key=\"element.name\"\n                        >\n                            <div\n                                v-if=\"!element.hidden && element.previewComponent\"\n                                class=\"element-selection__element-wrapper\"\n                            >\n                                <div class=\"element-selection__element\">\n                                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                    {% block sw_cms_slot_content_element_modal_selection_element_component %}\n                                    <component\n                                        :is=\"element.previewComponent\"\n                                        class=\"sw-cms-slot__element-preview\"\n                                        :element-data=\"element\"\n                                    />\n                                    {% endblock %}\n\n                                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                    {% block sw_cms_slot_content_element_modal_selection_element_overlay %}\n                                    <div\n                                        class=\"element-selection__overlay element-selection__overlay-action-select\"\n                                        role=\"button\"\n                                        tabindex=\"0\"\n                                        @click=\"onSelectElement(element)\"\n                                        @keydown.enter=\"onSelectElement(element)\"\n                                    >\n                                        <sw-icon\n                                            name=\"regular-repeat\"\n                                            size=\"28\"\n                                        />\n                                    </div>\n                                    {% endblock %}\n\n                                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                    {% block sw_cms_slot_content_element_modal_selection_element_overlay_favorite %}\n                                    <div\n                                        class=\"element-selection__overlay element-selection__overlay-action-favorite\"\n                                        role=\"button\"\n                                        tabindex=\"0\"\n                                        @click=\"onToggleElementFavorite(element.name)\"\n                                        @keydown.enter=\"onToggleElementFavorite(element.name)\"\n                                    >\n                                        <sw-icon\n                                            v-if=\"cmsElementFavorites.isFavorite(element.name)\"\n                                            name=\"solid-heart\"\n                                            size=\"28\"\n                                        />\n                                        <sw-icon\n                                            v-else\n                                            name=\"regular-heart\"\n                                            size=\"28\"\n                                        />\n                                    </div>\n                                {% endblock %}\n                                </div>\n\n                                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                {% block sw_cms_slot_content_element_modal_selection_element_label %}\n                                <span class=\"element-selection__label\">{{ $tc(element.label) }}</span>\n                            {% endblock %}\n                            </div>\n                        </template>\n                        {% endblock %}\n                    </div>\n                </template>\n            </sw-sidebar-collapse>\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_slot_content_element_modal_footer %}\n        <template #modal-footer>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_slot_content_element_modal_action_abort %}\n            <sw-button @click=\"onCloseElementModal\">\n                {{ $tc('global.default.cancel') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n    {% endblock %}\n</div>\n{% endblock %}\n","import { type PropType } from 'vue';\nimport template from './sw-cms-slot.html.twig';\nimport './sw-cms-slot.scss';\nimport { type CmsElementConfig } from '../../service/cms.service';\n\nconst { deepCopyObject } = Cicada.Utils.object;\n\n/**\n * @private since v6.5.0\n * @package discovery\n */\nexport default Cicada.Component.wrapComponentConfig({\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'cmsService',\n        'cmsElementFavorites',\n    ],\n\n    props: {\n        element: {\n            type: Object as PropType<EntitySchema.Entity<'cms_slot'>>,\n            required: true,\n        },\n\n        active: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        disabled: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            showElementSettings: false,\n            showElementSelection: false,\n            elementNotFound: false,\n        };\n    },\n\n    computed: {\n        slotElementId() {\n            return this.element.id;\n        },\n\n        cmsServiceState() {\n            return this.cmsService.getCmsServiceState();\n        },\n\n        elementConfig() {\n            return this.cmsServiceState.elementRegistry[this.element.type];\n        },\n\n        cmsElements() {\n            const currentPageType = Cicada.Store.get('cmsPage').currentPageType;\n\n            if (!currentPageType) {\n                return {};\n            }\n\n            const elements = Object.entries(this.cmsService.getCmsElementRegistry()).filter(([name]) =>\n                this.cmsService.isElementAllowedInPageType(name, currentPageType),\n            );\n\n            return Object.fromEntries(elements);\n        },\n\n        groupedCmsElements() {\n            const result = [];\n            const elements = Object.values(this.cmsElements).sort((a, b) => {\n                if (!a || !b) {\n                    return 0;\n                }\n\n                return a.name.localeCompare(b.name);\n            });\n            const favorites = elements.filter((element) => element && this.cmsElementFavorites.isFavorite(element.name));\n            const nonFavorites = elements.filter(\n                (element) => !element || !this.cmsElementFavorites.isFavorite(element.name),\n            );\n\n            if (favorites.length) {\n                result.push({\n                    title: 'sw-cms.elements.general.switch.groups.favorites',\n                    items: favorites,\n                });\n            }\n\n            result.push({\n                title: 'sw-cms.elements.general.switch.groups.all',\n                items: nonFavorites,\n            });\n\n            return result;\n        },\n\n        componentClasses() {\n            const componentClass = `sw-cms-slot-${this.element.slot}`;\n\n            return {\n                'is--disabled': this.disabled,\n                [componentClass]: !!this.element.slot,\n            };\n        },\n\n        cmsSlotSettingsClasses() {\n            if (this.elementConfig?.defaultConfig && !this.element?.locked) {\n                return null;\n            }\n\n            return 'is--disabled';\n        },\n\n        tooltipDisabled() {\n            if (this.elementConfig?.disabledConfigInfoTextKey) {\n                return {\n                    message: this.$tc(this.elementConfig.disabledConfigInfoTextKey),\n                    disabled: !!this.elementConfig.defaultConfig && !this.element.locked,\n                };\n            }\n\n            return {\n                message: this.$tc('sw-cms.elements.general.config.tab.settings'),\n                disabled: true,\n            };\n        },\n\n        modalVariant() {\n            return this.element.type === 'html' ? 'full' : 'large';\n        },\n    },\n\n    mounted() {\n        this.mountedComponent();\n    },\n\n    methods: {\n        mountedComponent() {\n            // Show a \"Not found\" error after 10 seconds, when no element has been found\n            setTimeout(() => {\n                if (!this.elementConfig) {\n                    this.elementNotFound = true;\n                }\n            }, 10000);\n        },\n\n        onSettingsButtonClick() {\n            if (!this.elementConfig?.defaultConfig || this.element?.locked) {\n                return;\n            }\n            this.showElementSettings = true;\n        },\n\n        onCloseSettingsModal() {\n            const childComponent = this.$refs.elementComponentRef as {\n                handleUpdateContent: () => void;\n            };\n\n            if (childComponent?.handleUpdateContent) {\n                childComponent.handleUpdateContent();\n            }\n\n            this.showElementSettings = false;\n        },\n\n        onElementButtonClick() {\n            this.showElementSelection = true;\n        },\n\n        onCloseElementModal() {\n            this.showElementSelection = false;\n        },\n\n        onSelectElement(element: CmsElementConfig) {\n            this.element.data = deepCopyObject(element?.defaultData || {});\n            this.element.config = deepCopyObject(element?.defaultConfig || {});\n            this.element.type = element.name;\n            this.element.locked = false;\n\n            if (this.element.translated?.config) {\n                this.element.translated.config = {};\n            }\n\n            this.showElementSelection = false;\n        },\n\n        onToggleElementFavorite(elementName: string) {\n            this.cmsElementFavorites.update(!this.cmsElementFavorites.isFavorite(elementName), elementName);\n        },\n\n        elementInElementGroup(element: CmsElementConfig, elementGroup: string) {\n            if (elementGroup === 'favorite') {\n                return this.cmsElementFavorites.isFavorite(element.name);\n            }\n\n            return true;\n        },\n    },\n});\n"],"names":["template","deepCopyObject","index","currentPageType","elements","name","result","a","b","favorites","element","nonFavorites","componentClass","_a","_b","childComponent","elementName","elementGroup"],"mappings":"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"}