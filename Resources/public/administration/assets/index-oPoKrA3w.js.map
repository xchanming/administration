{"version":3,"file":"index-oPoKrA3w.js","sources":["../../../app/administration/src/module/sw-settings-search/component/sw-settings-search-live-search/sw-settings-search-live-search.html.twig","../../../app/administration/src/module/sw-settings-search/component/sw-settings-search-live-search/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_search_view_live_search_card %}\n<sw-card\n    class=\"sw-settings-search-live-search\"\n    position-identifier=\"sw-settings-search-live-search\"\n    :title=\"$tc('sw-settings-search.liveSearchTab.titleCard')\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_search_view_live_search_rebuild_index_row %}\n    <div class=\"sw-settings-search-live-search__rebuild-index-row\">\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_view_live_search_description %}\n        <div class=\"sw-settings-search-live-search__description\">\n            {{ $tc('sw-settings-search.liveSearchTab.textDescription') }}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_view_live_search_show_example_link %}\n        <sw-container\n            columns=\"1fr\"\n            justify=\"end\"\n        >\n            <!-- eslint-disable-next-line vuejs-accessibility/click-events-have-key-events -->\n            <a\n                class=\"sw-settings-search-live-search__show-example-link\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"onShowExampleModal\"\n            >\n                {{ $tc('sw-settings-search.generalTab.linkExample') }}\n                <sw-icon\n                    name=\"regular-long-arrow-right\"\n                    small\n                />\n            </a>\n        </sw-container>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_searchable_show_example_modal %}\n        <sw-settings-search-example-modal\n            v-if=\"showExampleModal\"\n            @modal-close=\"onCloseExampleModal\"\n        />\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_search_view_live_search_sales_channel %}\n    <sw-single-select\n        class=\"sw-settings-search-live-search__sales-channel-select\"\n        value-property=\"id\"\n        label-property=\"translated.name\"\n        :placeholder=\"$tc('sw-settings-search.liveSearchTab.textPlaceholderSalesChannel')\"\n        :label=\"$tc('sw-settings-search.liveSearchTab.labelSalesChannelSelect')\"\n        :value=\"salesChannelId\"\n        :options=\"salesChannels\"\n        show-clearable-button\n        @update:value=\"changeSalesChannel\"\n    />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_search_view_live_search_input %}\n    <sw-simple-search-field\n        v-model:value=\"liveSearchTerm\"\n        class=\"sw-settings-search-live-search__search_box\"\n        variant=\"form\"\n        :delay=\"1000\"\n        :disabled=\"!isSearchEnable || undefined\"\n        @search-term-change=\"searchOnStorefront\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_view_live_search_search_icon_wrapper %}\n        <template #sw-simple-search-field-icon>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_search_view_live_search_search_icon %}\n            <sw-icon\n                class=\"sw-settings-search-live-search__search-icon\"\n                name=\"regular-search-s\"\n                small\n                @click=\"searchOnStorefront\"\n            />\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n    </sw-simple-search-field>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_search_view_live_search_results %}\n    <div class=\"sw-settings-search-live-search__search-results\">\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_search_bar_results_empty_state %}\n        <sw-loader v-if=\"searchInProgress\" />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_view_live_search_results_no_result %}\n        <div\n            v-if=\"products && products.length === 0\"\n            class=\"sw-settings-search-live-search__no-result\"\n        >\n            {{ $tc('sw-settings-search.liveSearchTab.textNoResult') }}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_search_view_live_search_results_search_grid %}\n        <sw-data-grid\n            v-if=\"products && products.length > 0\"\n            class=\"sw-settings-search-live-search__grid-result\"\n            :plain-appearance=\"true\"\n            :show-selection=\"false\"\n            :show-actions=\"false\"\n            :data-source=\"products\"\n            :is-loading=\"searchInProgress\"\n            :columns=\"searchColumns\"\n        >\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_search_view_live_search_results_search_grid_columns %}\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_search_view_live_search_results_search_grid_name %}\n            <template #column-name=\"{ item }\">\n                <sw-product-variant-info\n                    :variations=\"item.variation\"\n                    :show-tooltip=\"false\"\n                >\n                    <sw-settings-search-live-search-keyword\n                        :text=\"(item.name || item.translated.name)\"\n                        :search-term=\"liveSearchTerm\"\n                    />\n                </sw-product-variant-info>\n            </template>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_search_view_live_search_results_search_grid_score %}\n            <template #column-score=\"{ item }\">\n                <span class=\"sw-settings-search-live-search__grid-result__score\">\n                    {{ Math.round(parseFloat(item.extensions.search._score)) }}\n                </span>\n            </template>\n            {% endblock %}\n            {% endblock %}\n\n        </sw-data-grid>\n        {% endblock %}\n\n    </div>\n    {% endblock %}\n</sw-card>\n{% endblock %}\n","/**\n * @package buyers-experience\n */\nimport template from './sw-settings-search-live-search.html.twig';\nimport './sw-settings-search-live-search.scss';\nimport '../sw-settings-search-live-search-keyword';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'liveSearchService',\n    ],\n\n    emits: [\n        'live-search-results-change',\n        'sales-channel-change',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        currentSalesChannelId: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        searchTerms: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        searchResults: {\n            type: Object,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            liveSearchTerm: '',\n            salesChannels: [],\n            salesChannelId: this.currentSalesChannelId,\n            liveSearchResults: null,\n            searchInProgress: false,\n            showExampleModal: false,\n        };\n    },\n\n    computed: {\n        salesChannelRepository() {\n            return this.repositoryFactory.create('sales_channel');\n        },\n\n        isSearchEnable() {\n            return this.salesChannelId !== null;\n        },\n\n        searchColumns() {\n            return [\n                {\n                    property: 'name',\n                    label: this.$tc('sw-settings-search.liveSearchTab.labelName'),\n                    rawData: true,\n                },\n                {\n                    property: 'score',\n                    label: this.$tc('sw-settings-search.liveSearchTab.labelScore'),\n                    rawData: true,\n                },\n            ];\n        },\n\n        products() {\n            return this.liveSearchResults && this.liveSearchResults.elements;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchSalesChannels();\n            this.liveSearchTerm = this.searchTerms;\n            this.liveSearchResults = this.searchResults;\n        },\n\n        searchOnStorefront() {\n            if (!this.liveSearchTerm.length) {\n                return;\n            }\n\n            this.searchInProgress = true;\n            this.liveSearchService\n                .search(\n                    {\n                        salesChannelId: this.salesChannelId,\n                        search: this.liveSearchTerm,\n                    },\n                    {},\n                    {},\n                    { 'sw-language-id': Cicada.Context.api.languageId },\n                )\n                .then((data) => {\n                    this.liveSearchResults = data.data;\n                    this.searchInProgress = false;\n                    this.$emit('live-search-results-change', {\n                        searchTerms: this.liveSearchTerm,\n                        searchResults: this.liveSearchResults,\n                    });\n                })\n                .catch((error) => {\n                    const message =\n                        error.response.status === 500\n                            ? this.$tc('sw-settings-search.notification.notSupportedLanguageError')\n                            : error.message;\n\n                    this.createNotificationError({\n                        message,\n                    });\n                })\n                .finally(() => {\n                    this.searchInProgress = false;\n                });\n        },\n\n        fetchSalesChannels() {\n            this.salesChannelRepository.search(new Criteria(1, 25)).then((response) => {\n                this.salesChannels = response;\n            });\n        },\n\n        changeSalesChannel(salesChannelId) {\n            this.salesChannelId = salesChannelId;\n            this.$emit('sales-channel-change', salesChannelId);\n        },\n\n        onShowExampleModal() {\n            this.showExampleModal = true;\n        },\n\n        onCloseExampleModal() {\n            this.showExampleModal = false;\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","index","data","error","message","response","salesChannelId"],"mappings":"4BAAA,MAAeA,EAAA,yuHCOT,CAAE,MAAAC,CAAO,EAAG,OACZ,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAGbC,EAAA,CACX,SAAAH,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,mBACH,EAED,MAAO,CACH,6BACA,sBACH,EAED,OAAQ,CACJC,EAAM,UAAU,cAAc,CACjC,EAED,MAAO,CACH,sBAAuB,CACnB,KAAM,OACN,SAAU,GACV,QAAS,IACZ,EAED,YAAa,CACT,KAAM,OACN,SAAU,GACV,QAAS,IACZ,EAED,cAAe,CACX,KAAM,OACN,SAAU,GACV,QAAS,IACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,eAAgB,GAChB,cAAe,CAAE,EACjB,eAAgB,KAAK,sBACrB,kBAAmB,KACnB,iBAAkB,GAClB,iBAAkB,EAC9B,CACK,EAED,SAAU,CACN,wBAAyB,CACrB,OAAO,KAAK,kBAAkB,OAAO,eAAe,CACvD,EAED,gBAAiB,CACb,OAAO,KAAK,iBAAmB,IAClC,EAED,eAAgB,CACZ,MAAO,CACH,CACI,SAAU,OACV,MAAO,KAAK,IAAI,4CAA4C,EAC5D,QAAS,EACZ,EACD,CACI,SAAU,QACV,MAAO,KAAK,IAAI,6CAA6C,EAC7D,QAAS,EACZ,CACjB,CACS,EAED,UAAW,CACP,OAAO,KAAK,mBAAqB,KAAK,kBAAkB,QAC3D,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,mBAAkB,EACvB,KAAK,eAAiB,KAAK,YAC3B,KAAK,kBAAoB,KAAK,aACjC,EAED,oBAAqB,CACZ,KAAK,eAAe,SAIzB,KAAK,iBAAmB,GACxB,KAAK,kBACA,OACG,CACI,eAAgB,KAAK,eACrB,OAAQ,KAAK,cAChB,EACD,CAAE,EACF,CAAE,EACF,CAAE,iBAAkB,OAAO,QAAQ,IAAI,UAAY,CACtD,EACA,KAAMG,GAAS,CACZ,KAAK,kBAAoBA,EAAK,KAC9B,KAAK,iBAAmB,GACxB,KAAK,MAAM,6BAA8B,CACrC,YAAa,KAAK,eAClB,cAAe,KAAK,iBAC5C,CAAqB,CACrB,CAAiB,EACA,MAAOC,GAAU,CACd,MAAMC,EACFD,EAAM,SAAS,SAAW,IACpB,KAAK,IAAI,2DAA2D,EACpEA,EAAM,QAEhB,KAAK,wBAAwB,CACzB,QAAAC,CACxB,CAAqB,CACrB,CAAiB,EACA,QAAQ,IAAM,CACX,KAAK,iBAAmB,EAC5C,CAAiB,EACR,EAED,oBAAqB,CACjB,KAAK,uBAAuB,OAAO,IAAIJ,EAAS,EAAG,EAAE,CAAC,EAAE,KAAMK,GAAa,CACvE,KAAK,cAAgBA,CACrC,CAAa,CACJ,EAED,mBAAmBC,EAAgB,CAC/B,KAAK,eAAiBA,EACtB,KAAK,MAAM,uBAAwBA,CAAc,CACpD,EAED,oBAAqB,CACjB,KAAK,iBAAmB,EAC3B,EAED,qBAAsB,CAClB,KAAK,iBAAmB,EAC3B,CACJ,CACL"}