{"version":3,"file":"index-6GTRJ3XM.js","sources":["../../../app/administration/src/app/component/structure/sw-desktop/sw-desktop.html.twig","../../../app/administration/src/app/component/structure/sw-desktop/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_desktop %}\n<div\n    class=\"sw-desktop\"\n    :class=\"desktopClasses\"\n>\n    <div\n        v-if=\"isStaging\"\n        class=\"sw-staging-bar\"\n    >\n        {{ $tc('global.sw-desktop.stagingBarText') }}\n    </div>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_desktop_sidebar %}\n    <sw-admin-menu v-if=\"!noNavigation\" />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_desktop_content %}\n    <div class=\"sw-desktop__content\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_desktop_content_view %}\n        <sw-error-boundary>\n            <router-view />\n        </sw-error-boundary>\n        {% endblock %}\n    </div>\n    <sw-app-app-url-changed-modal\n        v-if=\"urlDiff !== null\"\n        :url-diff=\"urlDiff\"\n        @modal-close=\"closeModal\"\n    />\n    {% endblock %}\n</div>\n{% endblock %}\n","import template from './sw-desktop.html.twig';\nimport './sw-desktop.scss';\n\nconst { Component } = Cicada;\nconst { hasOwnProperty } = Cicada.Utils.object;\n\n/**\n * @package admin\n *\n * @private\n */\nComponent.register('sw-desktop', {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'feature',\n        'appUrlChangeService',\n        'userActivityApiService',\n    ],\n\n    data() {\n        return {\n            noNavigation: false,\n            urlDiff: null,\n        };\n    },\n\n    computed: {\n        desktopClasses() {\n            return {\n                'sw-desktop--no-nav': this.noNavigation,\n                'sw-desktop--staging': this.isStaging,\n            };\n        },\n\n        currentUser() {\n            return Cicada.State.get('session').currentUser;\n        },\n\n        isStaging() {\n            return Cicada.State.get('context').app.config.settings.enableStagingMode === true;\n        },\n    },\n\n    watch: {\n        $route() {\n            this.checkRouteSettings();\n        },\n\n        '$route.name': {\n            handler(to, from) {\n                if (from === undefined || to === from) {\n                    return;\n                }\n\n                this.onUpdateSearchFrequently();\n            },\n            immediate: true,\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.checkRouteSettings();\n            this.updateShowUrlChangedModal();\n        },\n\n        checkRouteSettings() {\n            if (this.$route.meta && hasOwnProperty(this.$route.meta, 'noNav')) {\n                this.noNavigation = this.$route.meta.noNav;\n            } else {\n                this.noNavigation = false;\n            }\n        },\n\n        updateShowUrlChangedModal() {\n            if (!Cicada.State.get('context').app.config.settings.appsRequireAppUrl) {\n                this.urlDiff = null;\n                return;\n            }\n\n            this.appUrlChangeService.getUrlDiff().then((diff) => {\n                this.urlDiff = diff;\n            });\n        },\n\n        closeModal() {\n            this.urlDiff = null;\n        },\n\n        onUpdateSearchFrequently() {\n            const metadata = this.getModuleMetadata();\n\n            if (!metadata || !metadata?.route?.name) {\n                return false;\n            }\n\n            const data = {\n                key: `${metadata.name}@${metadata.route.name}`,\n                cluster: this.currentUser.id,\n            };\n\n            return this.userActivityApiService.increment(data);\n        },\n\n        getModuleMetadata() {\n            const { $module } = this.$route.meta;\n            const routeName = this.$route?.name;\n\n            if (!$module) {\n                return false;\n            }\n\n            const { name, icon, color, entity, routes, title } = $module;\n\n            if (!this.$te(title) || !routes?.index) {\n                return false;\n            }\n\n            // special cases with searchMatcher function at the current module\n            const searchMatcher = this.getModuleMetadataWithSearchMatcher($module, routeName);\n            if (searchMatcher) {\n                const { components, children, meta, props, ...route } = searchMatcher.route;\n                return {\n                    ...searchMatcher,\n                    route,\n                };\n            }\n\n            if (routes?.index?.name === routeName || routes.index?.children?.some((child) => child.name === routeName)) {\n                const { components, children, meta, props, ...route } = routes.index;\n                return {\n                    name,\n                    icon,\n                    color,\n                    title,\n                    entity,\n                    privilege: meta?.privilege,\n                    route,\n                };\n            }\n\n            if (routes?.create?.name === routeName || routes.create?.children?.some((child) => child.name === routeName)) {\n                const { components, children, meta, props, ...route } = routes.create;\n                return {\n                    name,\n                    icon,\n                    color,\n                    entity,\n                    privilege: meta?.privilege,\n                    route,\n                    action: true,\n                };\n            }\n\n            return false;\n        },\n\n        getModuleMetadataWithSearchMatcher(module, routeName) {\n            if (typeof module.searchMatcher !== 'function') {\n                return false;\n            }\n\n            const { title } = module;\n\n            // get metadata in searchMatcher\n            const metadata = module.searchMatcher(\n                new RegExp(`^${this.$tc(title).toLowerCase()}(.*)`),\n                this.$tc(title, 2),\n                module,\n            );\n\n            return metadata.find(\n                (item) => item.route.name === routeName || item.route?.children?.some((child) => child.name === routeName),\n            );\n        },\n    },\n});\n"],"names":["template","Component","hasOwnProperty","to","from","diff","_a","metadata","data","_b","_c","_d","_e","_f","_g","$module","routeName","name","icon","color","entity","routes","title","searchMatcher","components","children","meta","props","route","child","module","item"],"mappings":"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"}