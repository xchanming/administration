{"version":3,"file":"index-BG83J-dz.js","sources":["../../../app/administration/src/module/sw-order/component/sw-order-product-select/sw-order-product-select.html.twig","../../../app/administration/src/module/sw-order/component/sw-order-product-select/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_order_product_select %}\n<span class=\"sw-order-product-select\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_product_select_blank_item %}\n    <sw-text-field\n        v-if=\"isShownItemLabelInput\"\n        v-model:value=\"item.label\"\n        v-bind=\"$attrs\"\n        size=\"small\"\n        :placeholder=\"$tc('sw-order.detailBase.columnProductName')\"\n    />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_product_select_existing_product %}\n    <!-- eslint-disable vue/valid-v-else-if -->\n    <sw-entity-single-select\n        v-else-if=\"isShownProductSelect\"\n        v-model:value=\"product\"\n        class=\"sw-order-product-select__single-select\"\n        :context=\"contextWithInheritance\"\n        :criteria=\"productCriteria\"\n        entity=\"product\"\n        size=\"small\"\n        show-clearable-button\n        @update:value=\"onItemChanged\"\n    >\n        <template #selection-label-property=\"{ item }\">\n            <slot\n                name=\"selection-label-property\"\n                v-bind=\"{ item }\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_order_product_select_results_variant_info %}\n                <sw-product-variant-info :variations=\"item.variation\">\n                    {{ item.translated.name || item.name }}\n                </sw-product-variant-info>\n                {% endblock %}\n            </slot>\n        </template>\n\n        <template #result-item=\"{ item, index }\">\n            <slot\n                name=\"result-item\"\n                v-bind=\"{ item, index }\"\n            >\n                <sw-select-result\n                    v-bind=\"{ item, index }\"\n                >\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_order_product_select_results_list_result_label %}\n                    <sw-product-variant-info :variations=\"item.variation\">\n                        {{ item.translated.name || item.name }}\n                    </sw-product-variant-info>\n                    {% endblock %}\n                </sw-select-result>\n            </slot>\n        </template>\n    </sw-entity-single-select>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_order_product_show_product %}\n    <template v-else>\n        <span class=\"sw-order-product-select__label\">\n            {{ item.label }}\n        </span>\n    </template>\n    {% endblock %}\n</span>\n{% endblock %}\n","import template from './sw-order-product-select.html.twig';\nimport { LineItemType, PriceType } from '../../order.types';\nimport './sw-order-product-select.scss';\n\n/**\n * @package checkout\n */\n\nconst { Service } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    props: {\n        item: {\n            type: Object,\n            required: true,\n        },\n\n        salesChannelId: {\n            type: String,\n            required: true,\n            default: '',\n        },\n\n        taxStatus: {\n            type: String,\n            required: true,\n            default: '',\n        },\n    },\n\n    data() {\n        return {\n            product: null,\n        };\n    },\n\n    computed: {\n        productRepository() {\n            return Service('repositoryFactory').create('product');\n        },\n\n        lineItemTypes() {\n            return LineItemType;\n        },\n\n        lineItemPriceTypes() {\n            return PriceType;\n        },\n\n        isShownProductSelect() {\n            return this.item._isNew && this.item.type === this.lineItemTypes.PRODUCT;\n        },\n\n        isShownItemLabelInput() {\n            return this.item.type !== this.lineItemTypes.PRODUCT;\n        },\n\n        contextWithInheritance() {\n            return { ...Cicada.Context.api, inheritance: true };\n        },\n\n        productCriteria() {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addAssociation('options.group');\n            criteria.addAssociation('tax');\n\n            criteria.addFilter(\n                Criteria.multi('OR', [\n                    Criteria.equals('childCount', 0),\n                    Criteria.equals('childCount', null),\n                ]),\n            );\n\n            criteria.addFilter(Criteria.equals('visibilities.salesChannelId', this.salesChannelId));\n            criteria.addFilter(Criteria.equals('active', true));\n\n            return criteria;\n        },\n    },\n\n    methods: {\n        onItemChanged(newProductId) {\n            const criteria = new Criteria(1, 1);\n            criteria.addAssociation('tax');\n\n            this.productRepository.get(newProductId, this.contextWithInheritance, criteria).then((newProduct) => {\n                this.item.identifier = newProduct.id;\n                this.item.label = newProduct.name;\n                this.item.priceDefinition.price =\n                    this.taxStatus === 'gross' ? newProduct.price[0].gross : newProduct.price[0].net;\n                this.item.priceDefinition.type = this.lineItemPriceTypes.QUANTITY;\n                this.item.price.taxRules[0].taxRate = newProduct.tax.taxRate;\n                this.item.price.unitPrice = '...';\n                this.item.price.totalPrice = '...';\n                this.item.price.quantity = 1;\n                this.item.unitPrice = '...';\n                this.item.totalPrice = '...';\n                this.item.precision = 2;\n                this.item.priceDefinition.taxRules[0].taxRate = newProduct.tax.taxRate;\n            });\n        },\n    },\n};\n"],"names":["template","Service","Criteria","index","LineItemType","PriceType","criteria","newProductId","newProduct"],"mappings":"qDAAA,MAAeA,EAAA,+gDCQT,CAAE,QAAAC,CAAS,EAAG,OACd,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAGbC,EAAA,CACX,SAAAH,EAEA,aAAc,OAAO,aAErB,MAAO,CACH,KAAM,CACF,KAAM,OACN,SAAU,EACb,EAED,eAAgB,CACZ,KAAM,OACN,SAAU,GACV,QAAS,EACZ,EAED,UAAW,CACP,KAAM,OACN,SAAU,GACV,QAAS,EACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,QAAS,IACrB,CACK,EAED,SAAU,CACN,mBAAoB,CAChB,OAAOC,EAAQ,mBAAmB,EAAE,OAAO,SAAS,CACvD,EAED,eAAgB,CACZ,OAAOG,CACV,EAED,oBAAqB,CACjB,OAAOC,CACV,EAED,sBAAuB,CACnB,OAAO,KAAK,KAAK,QAAU,KAAK,KAAK,OAAS,KAAK,cAAc,OACpE,EAED,uBAAwB,CACpB,OAAO,KAAK,KAAK,OAAS,KAAK,cAAc,OAChD,EAED,wBAAyB,CACrB,MAAO,CAAE,GAAG,OAAO,QAAQ,IAAK,YAAa,GAChD,EAED,iBAAkB,CACd,MAAMC,EAAW,IAAIJ,EAAS,EAAG,EAAE,EAEnC,OAAAI,EAAS,eAAe,eAAe,EACvCA,EAAS,eAAe,KAAK,EAE7BA,EAAS,UACLJ,EAAS,MAAM,KAAM,CACjBA,EAAS,OAAO,aAAc,CAAC,EAC/BA,EAAS,OAAO,aAAc,IAAI,CACtD,CAAiB,CACjB,EAEYI,EAAS,UAAUJ,EAAS,OAAO,8BAA+B,KAAK,cAAc,CAAC,EACtFI,EAAS,UAAUJ,EAAS,OAAO,SAAU,EAAI,CAAC,EAE3CI,CACV,CACJ,EAED,QAAS,CACL,cAAcC,EAAc,CACxB,MAAMD,EAAW,IAAIJ,EAAS,EAAG,CAAC,EAClCI,EAAS,eAAe,KAAK,EAE7B,KAAK,kBAAkB,IAAIC,EAAc,KAAK,uBAAwBD,CAAQ,EAAE,KAAME,GAAe,CACjG,KAAK,KAAK,WAAaA,EAAW,GAClC,KAAK,KAAK,MAAQA,EAAW,KAC7B,KAAK,KAAK,gBAAgB,MACtB,KAAK,YAAc,QAAUA,EAAW,MAAM,CAAC,EAAE,MAAQA,EAAW,MAAM,CAAC,EAAE,IACjF,KAAK,KAAK,gBAAgB,KAAO,KAAK,mBAAmB,SACzD,KAAK,KAAK,MAAM,SAAS,CAAC,EAAE,QAAUA,EAAW,IAAI,QACrD,KAAK,KAAK,MAAM,UAAY,MAC5B,KAAK,KAAK,MAAM,WAAa,MAC7B,KAAK,KAAK,MAAM,SAAW,EAC3B,KAAK,KAAK,UAAY,MACtB,KAAK,KAAK,WAAa,MACvB,KAAK,KAAK,UAAY,EACtB,KAAK,KAAK,gBAAgB,SAAS,CAAC,EAAE,QAAUA,EAAW,IAAI,OAC/E,CAAa,CACJ,CACJ,CACL"}