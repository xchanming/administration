const l='{% block sw_product_variants_delivery_order %} <div class="sw-product-variants-delivery-order"> {% block sw_product_variants_delivery_order_groups %} <div class="sw-product-variants-delivery-order__groups"> {% block sw_product_variants_delivery_order_groups_sw_tree %} <sw-tree v-if="orderObjects.length" :items="orderObjects" :searchable="false" :disable-context-menu="true" bind-items-to-folder @drag-end="orderChanged" > <template #items="{ treeItems, sortable, draggedItem, disableContextMenu, onChangeRoute }" > <sw-tree-item v-for="item in treeItems" :key="item.id" :item="item" :disable-context-menu="true" :sortable="true" /> </template> </sw-tree> {% endblock %} {% block sw_product_variants_delivery_order_loader %} <sw-loader v-else /> {% endblock %} </div> {% endblock %} </div> {% endblock %}',f={template:l,compatConfig:Cicada.compatConfig,props:{product:{type:Object,required:!0},selectedGroups:{type:Array,required:!0}},data(){return{groups:[],orderObjects:[]}},mounted(){this.mountedComponent()},methods:{mountedComponent(){this.createOrderObjects()},createOrderObjects(){let e=[];const o=[...this.selectedGroups];this.product.variantListingConfig.configuratorGroupConfig&&this.product.variantListingConfig.configuratorGroupConfig.length>0&&(e=this.product.variantListingConfig.configuratorGroupConfig.reduce((r,d)=>{const t=o.find(n=>n.id===d.id);return t&&(r.push(t),o.splice(o.indexOf(t),1)),r},[])),e=[...e,...o];const a=e.map((r,d)=>{const t=this.getOptionsForGroup(r.id);return{id:r.id,name:r.translated.name,childCount:t.length,parentId:null,afterId:d>0?e[d-1].id:null,storeObject:r}}),u=a.reduce((r,d)=>{const t=this.getOptionsForGroup(d.id),n=t.sort((i,s)=>i.position-s.position).map((i,s)=>{const p=i.option;let c=null;return s>0&&(c=t[s-1].option.id),{id:p.id,name:p.translated.name,childCount:0,parentId:p.groupId,afterId:c,storeObject:i}});return[...r,...n]},[]);this.orderObjects=[...a,...u]},getOptionsForGroup(e){return this.product.configuratorSettings.filter(o=>!o.isDeleted&&o.option.groupId===e)},orderChanged(){const e=this.orderObjects.filter(t=>t.parentId===null);this.product.variantListingConfig.configuratorGroupConfig||(this.product.variantListingConfig.configuratorGroupConfig=[]);const o=[];let a=e.find(t=>t.afterId===null);e.forEach(()=>{a!==void 0&&(o.push(a.id),a=e.find(t=>t.afterId===a.id))});const u=[],r=this.product.variantListingConfig.configuratorGroupConfig??[];r.length?o.forEach(t=>{const n=r.find(i=>i.id===t);n?u.push(n):u.push({id:t,expressionForListings:!1,representation:"box"})}):o.forEach(t=>{u.push({id:t,expressionForListings:!1,representation:"box"})}),this.product.variantListingConfig.configuratorGroupConfig=u;const d=this.orderObjects.filter(t=>t.parentId);e.forEach(t=>{const n=d.filter(s=>s.parentId===t.id);let i=n.find(s=>s.afterId===null);n.forEach((s,p)=>{i!==void 0&&(i.storeObject.position=p+1,i=n.find(c=>c.afterId===i.id))})})}}};export{f as default};
//# sourceMappingURL=index-DO9myRBX.js.map
