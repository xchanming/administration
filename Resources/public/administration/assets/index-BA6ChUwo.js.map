{"version":3,"file":"index-BA6ChUwo.js","sources":["../../../app/administration/src/app/component/form/sw-file-input/sw-file-input.html.twig","../../../app/administration/src/app/component/form/sw-file-input/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_file_input %}\n<div class=\"sw-file-input\">\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_file_input_regular %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_file_input_regular_header %}\n    <div class=\"sw-file-input__header\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_file_input_regular_header_label %}\n        <!-- eslint-disable-next-line vuejs-accessibility/label-has-for -->\n        <label\n            v-if=\"label\"\n            :for=\"id\"\n            class=\"sw-file-input__label\"\n        >\n            {{ label }}\n        </label>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_file_input_regular_drop_zone %}\n    <div\n        ref=\"dropzone\"\n        class=\"sw-file-input__dropzone\"\n        :class=\"isDragActiveClass\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_file_input_caption %}\n        <div\n            v-if=\"selectedFile === null\"\n            class=\"sw-file-input__upload-caption\"\n        >\n            <sw-icon name=\"regular-cloud-upload\" />\n            <slot name=\"caption-label\">\n                {{ $tc('global.sw-file-input.caption') }}\n            </slot>\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_file_input_actions %}\n        <div\n            class=\"sw-file-input__actions\"\n            :class=\"{ 'has--source': selectedFile }\"\n        >\n\n            <div\n                v-if=\"selectedFile\"\n                class=\"sw-file-input__file-info\"\n            >\n                <span class=\"sw-file-input__file-headline\">\n                    {{ selectedFile.name }}\n                </span>\n                <sw-icon\n                    class=\"sw-file-input__remove-icon\"\n                    name=\"regular-times-xs\"\n                    small\n                    @click=\"onRemoveIconClick\"\n                />\n            </div>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_file_input_regular_choose_button %}\n            <sw-button\n                class=\"sw-file-input__button\"\n                variant=\"ghost\"\n                size=\"small\"\n                :disabled=\"disabled || undefined\"\n                @click=\"onChooseButtonClick\"\n            >\n                {{ $tc('global.sw-file-input.buttonChoose') }}\n            </sw-button>\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n    </div>\n    {% endblock %}\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_file_input_hidden_form %}\n    <form\n        ref=\"fileForm\"\n        class=\"sw-file-input__file-form\"\n    >\n        <!-- eslint-disable-next-line vuejs-accessibility/form-control-has-label -->\n        <input\n            :id=\"id\"\n            ref=\"fileInput\"\n            class=\"sw-file-input__file-input\"\n            type=\"file\"\n            @change=\"onFileInputChange\"\n        >\n    </form>\n    {% endblock %}\n</div>\n{% endblock %}\n","/* eslint-disable vue/require-default-prop */\nimport template from './sw-file-input.html.twig';\nimport './sw-file-input.scss';\n\nconst { Component, Mixin } = Cicada;\nconst { fileSize } = Cicada.Utils.format;\nconst utils = Cicada.Utils;\n\n/**\n * @package admin\n *\n * @private\n * @description The <u>sw-file-input</u> component can be used wherever a file input is needed.\n * @example-type code-only\n * @component-example\n * <sw-file-input\n *     v-model=\"selectedFile\"\n *     label=\"My file input\"\n *     :allowedMimeTypes=\"['text/csv','text/xml']\"\n *     :maxFileSize=\"8*1024*1024\">\n * </sw-file-input>\n */\nComponent.register('sw-file-input', {\n    template,\n\n    inject: ['feature'],\n\n    compatConfig: Cicada.compatConfig,\n\n    emits: ['update:value'],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        maxFileSize: {\n            type: Number,\n            required: false,\n            default: null,\n        },\n\n        allowedMimeTypes: {\n            type: Array,\n            required: false,\n            default: null,\n        },\n\n        label: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        // eslint-disable-next-line vue/require-prop-types\n        value: {\n            required: false,\n        },\n\n        disabled: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            selectedFile: null,\n            utilsId: utils.createId(),\n            isDragActive: false,\n        };\n    },\n\n    computed: {\n        id() {\n            return `sw-file-input--${this.utilsId}`;\n        },\n\n        isDragActiveClass() {\n            return {\n                'is--active': this.isDragActive,\n            };\n        },\n    },\n\n    mounted() {\n        this.mountedComponent();\n    },\n\n    methods: {\n        mountedComponent() {\n            if (this.$refs.dropzone) {\n                [\n                    'dragover',\n                    'drop',\n                ].forEach((event) => {\n                    window.addEventListener(event, this.stopEventPropagation, false);\n                });\n                this.$refs.dropzone.addEventListener('drop', this.onDrop);\n\n                window.addEventListener('dragenter', this.onDragEnter);\n                window.addEventListener('dragleave', this.onDragLeave);\n            }\n        },\n\n        onChooseButtonClick() {\n            this.$refs.fileInput.click();\n        },\n\n        onRemoveIconClick() {\n            this.setSelectedFile(null);\n        },\n\n        onFileInputChange() {\n            const newFiles = Array.from(this.$refs.fileInput.files);\n\n            if (newFiles.length) {\n                const newFile = newFiles[0];\n                if (this.checkFileSize(newFile) && this.checkFileType(newFile)) {\n                    this.setSelectedFile(newFile);\n                }\n            }\n            this.$refs.fileForm.reset();\n        },\n\n        setSelectedFile(newFile) {\n            this.selectedFile = newFile;\n\n            this.$emit('update:value', this.selectedFile);\n        },\n\n        checkFileSize(file) {\n            if (this.maxFileSize === null || file.size <= this.maxFileSize) {\n                return true;\n            }\n\n            this.createNotificationError({\n                title: this.$tc('global.default.error'),\n                message: this.$tc('global.sw-file-input.notification.invalidFileSize.message', 0, {\n                    name: file.name,\n                    limit: fileSize(this.maxFileSize),\n                }),\n            });\n            return false;\n        },\n\n        checkFileType(file) {\n            if (!this.allowedMimeTypes || !this.allowedMimeTypes.length || this.allowedMimeTypes.indexOf(file.type) >= 0) {\n                return true;\n            }\n\n            this.createNotificationError({\n                title: this.$tc('global.default.error'),\n                message: this.$tc('global.sw-file-input.notification.invalidFileType.message', 0, {\n                    name: file.name,\n                    supportedTypes: this.allowedMimeTypes.join(', '),\n                }),\n            });\n            return false;\n        },\n\n        onDragEnter() {\n            if (this.disabled) {\n                return;\n            }\n\n            this.isDragActive = true;\n        },\n\n        onDragLeave(event) {\n            if (event.screenX === 0 && event.screenY === 0) {\n                this.isDragActive = false;\n                return;\n            }\n\n            const target = event.target;\n\n            if (target.closest('.sw-file-input__dropzone')) {\n                return;\n            }\n\n            this.isDragActive = false;\n        },\n\n        stopEventPropagation(event) {\n            event.preventDefault();\n            event.stopPropagation();\n        },\n\n        onDrop(event) {\n            if (this.disabled) {\n                return;\n            }\n\n            const newFiles = Array.from(event.dataTransfer.files);\n            this.isDragActive = false;\n\n            if (newFiles.length === 0) {\n                return;\n            }\n\n            const newFile = newFiles[0];\n\n            if (this.checkFileSize(newFile) && this.checkFileType(newFile)) {\n                this.setSelectedFile(newFile);\n            }\n\n            this.$refs.fileForm.reset();\n        },\n    },\n});\n"],"names":["template","Component","Mixin","fileSize","utils","event","newFiles","newFile","file"],"mappings":"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"}