const l=`{% block sw_settings_salutation_detail %} <sw-page class="sw-settings-salutation-detail"> {% block sw_settings_salutation_detail_search_bar %} <template #search-bar></template> {% endblock %} {% block sw_settings_salutation_detail_smart_bar_header %} <template #smart-bar-header> {% block sw_settings_salutation_detail_smart_bar_header_title %} <h2> {% block sw_settings_salutation_detail_smart_bar_header_title_text %} {{ placeholder(salutation, 'salutationKey', $tc('sw-settings-salutation.detail.placeholderNewSalutation')) }} {% endblock %} </h2> {% endblock %} </template> {% endblock %} {% block sw_settings_salutation_detail_language_switch %} <template #language-switch> <sw-language-switch :disabled="salutationId == null || undefined" @on-change="onChangeLanguage" /> </template> {% endblock %} {% block sw_settings_salutation_detail_actions %} <template #smart-bar-actions> {% block sw_settings_salutation_detail_actions_cancel %} <sw-button v-tooltip.bottom="tooltipCancel" class="sw-settings-salutation-detail__cancel" @click="onCancel" > {{ $tc('global.default.cancel') }} </sw-button> {% endblock %} {% block sw_settings_salutation_detail_actions_save %} <sw-button-process v-tooltip.bottom="tooltipSave" class="sw-settings-salutation-detail__save" :is-loading="isLoading" :process-success="isSaveSuccessful" :disabled="invalidKey || isKeyChecking || !allowSave || undefined" variant="primary" @update:process-success="saveFinish" @click="onSave" > {{ $tc('sw-settings-salutation.general.buttonSave') }} </sw-button-process> {% endblock %} </template> {% endblock %} {% block sw_settings_salutation_detail_cardview %} <template #content> <sw-card-view> <sw-skeleton v-if="isLoading" /> <template v-else> {% block sw_settings_salutation_detail_content_language_info %} <sw-language-info :entity-description="entityDescription" /> {% endblock %} {% block sw_settings_salutation_detail_content_card %} <sw-card position-identifier="sw-settings-salutation-detail-content" :is-loading="isLoading" :title="$tc('sw-settings-salutation.detail.cardTitle')" > <template v-if="salutation"> {% block sw_settings_salutation_detail_content_card_salutation_key %} <sw-text-field v-model:value="salutation.salutationKey" name="sw-field--salutation-salutationKey" class="sw-settings-salutation-detail__salutation_key" :label="$tc('sw-settings-salutation.detail.fieldSalutationKeyLabel')" :placeholder="$tc('sw-settings-salutation.detail.fieldSalutationKeyPlaceholder')" :help-text="$tc('sw-settings-salutation.detail.fieldSalutationKeyTooltip')" :error="salutationSalutationKeyError" validation="required" required :disabled="!acl.can('salutation.editor') || undefined" @update:value="onChange" /> {% endblock %} {% block sw_settings_salutation_detail_content_card_display_name %} <sw-text-field v-model:value="salutation.displayName" name="sw-field--salutation-displayName" required class="sw-settings-salutation-detail__displayName" :label="$tc('sw-settings-salutation.detail.fieldDisplayNameLabel')" :error="salutationDisplayNameError" :disabled="!acl.can('salutation.editor') || undefined" :placeholder="placeholder(salutation, 'displayName', $tc('sw-settings-salutation.detail.fieldDisplayNamePlaceholder'))" /> {% endblock %} {% block sw_settings_salutation_detail_content_card_letter_name %} <sw-text-field v-model:value="salutation.letterName" name="sw-field--salutation-letterName" required class="sw-settings-salutation-detail__letterName" :label="$tc('sw-settings-salutation.detail.fieldLetterNameLabel')" :error="salutationLetterNameError" :disabled="!acl.can('salutation.editor') || undefined" :placeholder="placeholder(salutation, 'letterName', $tc('sw-settings-salutation.detail.fieldLetterNamePlaceholder'))" /> {% endblock %} </template> </sw-card> {% endblock %} {% block sw_settings_salutation_detail_custom_field_sets %} <sw-card v-if="showCustomFields" position-identifier="sw-settings-salutation-detail-custom-fields" :title="$tc('sw-settings-custom-field.general.mainMenuItemGeneral')" :is-loading="isLoading" > <sw-custom-field-set-renderer :entity="salutation" :disabled="!acl.can('salutation.editor') || undefined" :sets="customFieldSets" /> </sw-card> {% endblock %} </template> </sw-card-view> </template> {% endblock %} </sw-page> {% endblock %}`,{Mixin:a}=Cicada,{Criteria:e}=Cicada.Data,n=Cicada.Classes.CicadaError,{mapPropertyErrors:o}=Cicada.Component.getComponentHelper(),d=Cicada.Utils,c={template:l,compatConfig:Cicada.compatConfig,inject:["repositoryFactory","acl","customFieldDataProviderService"],mixins:[a.getByName("notification"),a.getByName("placeholder"),a.getByName("discard-detail-page-changes")("salutation")],props:{salutationId:{type:String,required:!1,default:null}},shortcuts:{"SYSTEMKEY+S":{active(){return this.allowSave},method:"onSave"},ESCAPE:"onCancel"},data(){return{entityName:"salutation",isLoading:!1,salutation:null,invalidKey:!1,isKeyChecking:!1,isSaveSuccessful:!1,customFieldSets:null}},metaInfo(){return{title:this.$createTitle(this.identifier)}},computed:{identifier(){return this.placeholder(this.salutation,"displayName")},salutationRepository(){return this.repositoryFactory.create("salutation")},entityDescription(){return this.placeholder(this.salutation,"salutationKey",this.$tc("sw-settings-salutation.detail.placeholderNewSalutation"))},invalidKeyError(){return this.invalidKey&&!this.isKeyChecking?new n({code:"DUPLICATED_SALUTATION_KEY"}):null},allowSave(){return this.salutation&&this.salutation.isNew()?this.acl.can("salutation.creator"):this.acl.can("salutation.editor")},tooltipSave(){return this.allowSave?{message:`${this.$device.getSystemKey()} + S`,appearance:"light"}:{message:this.$tc("sw-privileges.tooltip.warning"),disabled:this.allowSave,showOnDisabledElements:!0}},tooltipCancel(){return{message:"ESC",appearance:"light"}},...o("salutation",["displayName","letterName","salutationKey"]),showCustomFields(){return this.salutation&&this.customFieldSets&&this.customFieldSets.length>0}},watch:{salutationId(){this.salutationId||this.createdComponent()}},created(){this.createdComponent()},methods:{createdComponent(){if(this.isLoading=!0,this.salutationId){this.salutationRepository.get(this.salutationId).then(t=>{this.salutation=t,this.isLoading=!1}),this.loadCustomFieldSets();return}Cicada.State.commit("context/resetLanguageToDefault"),this.salutation=this.salutationRepository.create(),this.isLoading=!1},loadCustomFieldSets(){this.customFieldDataProviderService.getCustomFieldSets("salutation").then(t=>{this.customFieldSets=t})},onChangeLanguage(){this.createdComponent()},saveFinish(){this.isSaveSuccessful=!1},onSave(){return this.isLoading=!0,this.isSaveSuccessful=!1,this.salutationRepository.save(this.salutation).then(()=>{this.isSaveSuccessful=!0,this.salutationId||this.$router.push({name:"sw.settings.salutation.detail",params:{id:this.salutation.id}}),this.salutationRepository.get(this.salutation.id).then(t=>{this.salutation=t,this.isLoading=!1})}).catch(()=>{this.isLoading=!1,this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("sw-settings-salutation.detail.notificationErrorMessage")})})},onCancel(){this.$router.push({name:"sw.settings.salutation.index"})},onChange(){this.isKeyChecking=!0,this.onChangeDebounce()},onChangeDebounce:d.debounce(function(){if(!this.salutation)return;if(typeof this.salutation.salutationKey!="string"||this.salutation.salutationKey.trim()===""){this.invalidKey=!1,this.isKeyChecking=!1;return}const s=new e(1,1);s.addFilter(e.multi("AND",[e.equals("salutationKey",this.salutation.salutationKey),e.not("AND",[e.equals("id",this.salutation.id)])])),this.salutationRepository.search(s).then(({total:i})=>{this.invalidKey=i>0,this.isKeyChecking=!1}).catch(()=>{this.invalidKey=!0,this.isKeyChecking=!1})},500)}};export{c as default};
//# sourceMappingURL=index-CkaEB_dH.js.map
