const i=`{% block sw_extension_review_creation %} <div class="sw-extension-review-creation"> {% block sw_extension_review_creation_inputs %} <sw-extension-review-creation-inputs :errors="errors" @changed="onChange" /> {% endblock %} {% block sw_extension_review_creation_gtc_checkbox %} <sw-gtc-checkbox v-model:value="tocAccepted" /> {% endblock %} {% block sw_extension_review_creation_buttons %} <div class="sw-extension-review-creation__buttons"> {% block sw_extension_review_creation_buttons_submit_button %} <sw-button-process class="sw-extension-review-creation__submit" variant="primary" size="small" :is-loading="isLoading" :process-success="isCreatedSuccessful" :disabled="disabled" @update:process-success="emitCreated" @click="handleCreateReview" > {{ $tc('sw-extension-store.component.sw-extension-ratings.sw-extension-review-creation.submitBtn') }} </sw-button-process> {% endblock %} </div> {% endblock %} </div> {% endblock %}`,{ShopwareError:s}=Shopware.Classes,r={template:i,inject:["extensionStoreActionService"],emits:["created"],mixins:["sw-extension-error"],props:{extension:{type:Object,required:!0}},data(){return{tocAccepted:!1,isLoading:!1,isCreatedSuccessful:!1,headline:null,rating:null,text:null,errors:{headlineError:null,ratingError:null}}},computed:{currentUser(){return Shopware.Store.get("session").currentUser},userName(){return this.currentUser?`${this.currentUser.firstName} ${this.currentUser.lastName}`.trim():""},installedVersion(){return Shopware.Store.get("shopwareExtensions").myExtensions.data.find(t=>t.name===this.extension.name).version},hasError(){return this.errors.headlineError!==null||this.errors.ratingError!==null},disabled(){return this.hasError||!this.tocAccepted}},watch:{headline(){this.validateHeadline()},rating(){this.validateRating()}},methods:{async handleCreateReview(){if(this.isLoading=!0,this.validateInputs(),this.hasError){this.isLoading=!1;return}const e={extensionId:this.extension.id,authorName:this.userName,headline:this.headline,rating:this.rating,text:this.text,tocAccepted:this.tocAccepted,version:this.installedVersion};await this.createReview(e),this.isLoading=!1},async createReview(e){try{await this.extensionStoreActionService.rateExtension(e),this.isCreatedSuccessful=!0}catch(t){this.showExtensionErrors(t)}},validateInputs(){this.validateHeadline(),this.validateRating()},validateHeadline(){if(this.headline===null||this.headline===""){this.errors.headlineError=new s({code:"c1051bb4-d103-4f74-8988-acbcafc7fdc3"});return}this.errors.headlineError=null},validateRating(){if(this.rating===null||this.rating===0){this.errors.ratingError=new s({code:"c1051bb4-d103-4f74-8988-acbcafc7fdc3"});return}this.errors.ratingError=null},onChange(e,t){this[e]=t},emitCreated(){this.$emit("created"),this.isCreatedSuccessful=!1}}};export{r as default};
