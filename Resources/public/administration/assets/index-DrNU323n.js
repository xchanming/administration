const p=`{% block sw_import_export_view_profile %} <div class="sw-import-export-view-profiles"> {% block sw_import_export_view_profile_profiles %} <sw-card :title="$tc('sw-import-export.page.profileTab')" class="sw-import-export-view-profiles__grid-card" position-identifier="sw-import-export-view-profiles" > {% block sw_import_export_view_profile_profiles_toolbar %} <div class="sw-import-export-view-profiles__toolbar"> {% block sw_import_export_view_profile_profiles_toolbar_search_field %} <sw-simple-search-field v-model:value="searchTerm" class="sw-import-export-view-profiles__search" size="small" variant="form" @search-term-change="onSearch" /> {% endblock %} {% block sw_import_export_view_profile_profiles_toolbar_add_new_profile %} <sw-button v-tooltip="createTooltip" class="sw-import-export-view-profiles__create-action" variant="ghost" :disabled="isLoading || isNotSystemLanguage" size="small" @click="onAddNewProfile" > {{ $tc('sw-import-export.profile.addNewProfileLabel') }} </sw-button> {% endblock %} </div> {% endblock %} {% block sw_import_export_view_profile_profiles_listing %} <template #grid> <sw-entity-listing ref="listing" class="sw-import-export-view-profiles__listing" :repository="profileRepository" :items="profiles" :is-loading="isLoading" :columns="profilesColumns" :sort-by="sortBy" :sort-direction="sortDirection" :show-settings="false" :show-selection="false" :allow-column-edit="false" > {% block sw_import_export_view_profile_profiles_listing_column_label %} <template #column-label="{ item }"> <a href="#" @click.prevent="onEditProfile(item.id)" > {{ item.translated.label || item.label }} </a> </template> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_column_system_default %} <template #column-systemDefault="{ item }"> {{ getTypeLabel(item.systemDefault) }} </template> {% endblock %} <template #actions="{ item }"> {% block sw_import_export_view_profile_profiles_listing_edit %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-open-action" @click="onEditProfile(item.id)" > {{ $tc('sw-import-export.profile.openLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_duplicate %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-duplicate-action" @click="onDuplicateProfile(item)" > {{ $tc('sw-import-export.profile.duplicateLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_download_template %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-download-template-action" @click="onDownloadTemplate(item)" > {{ $tc('sw-import-export.profile.downloadTemplateLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_delete %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-delete-action" variant="danger" :disabled="item.systemDefault" @click="onDeleteProfile(item.id)" > {{ $tc('sw-import-export.profile.deleteLabel') }} </sw-context-menu-item> {% endblock %} </template> </sw-entity-listing> </template> {% endblock %} </sw-card> {% endblock %} {% block sw_import_export_view_profile_modal %} <sw-import-export-edit-profile-modal :show="showProfileEditModal" :profile="selectedProfile" @profile-save="saveSelectedProfile" @profile-close="closeSelectedProfile" /> {% endblock %} {% block sw_import_export_view_new_profile_wizard %} <sw-import-export-new-profile-wizard v-if="showNewProfileWizard" :profile="selectedProfile" @profile-save="saveSelectedProfile" @close="onCloseNewProfileWizard" /> {% endblock %} </div> {% endblock %}`,{Mixin:n}=Shopware,{Criteria:s}=Shopware.Data,c={template:p,inject:["repositoryFactory","importExport","feature"],mixins:[n.getByName("notification")],data(){return{isLoading:!1,selectedProfile:null,profiles:null,searchTerm:null,sortBy:"label",sortDirection:"ASC",showProfileEditModal:!1,showNewProfileWizard:!1}},metaInfo(){return{title:this.$createTitle()}},computed:{profileRepository(){return this.repositoryFactory.create("import_export_profile")},profileCriteria(){const e=new s(1,25);return e.setTerm(this.searchTerm),e.addAssociation("importExportLogs"),e.addSorting(s.sort(this.sortBy,this.sortDirection)),e},profilesColumns(){return[{property:"label",dataIndex:"label",label:"sw-import-export.profile.nameColumn",allowResize:!0,primary:!0},{property:"technicalName",dataIndex:"technicalName",label:"sw-import-export.profile.technicalNameColumn",allowResize:!0},{property:"systemDefault",dataIndex:"systemDefault",label:"sw-import-export.profile.typeColumn",allowResize:!0}]},isNotSystemLanguage(){return Shopware.Context.api.systemLanguageId!==Shopware.Context.api.languageId},createTooltip(){return{showDelay:300,message:this.$tc("sw-import-export.profile.addNewProfileTooltipLanguage"),disabled:!this.isNotSystemLanguage}}},created(){this.createdComponent()},methods:{createdComponent(){this.loadProfiles()},async loadProfiles(){this.isLoading=!0,this.profiles=await this.profileRepository.search(this.profileCriteria),this.isLoading=!1},reloadContent(){this.loadProfiles()},onSearch(){this.loadProfiles()},onAddNewProfile(){const e=this.profileRepository.create();e.fileType="text/csv",e.mapping=[],e.config={},e.config.createEntities=!0,e.config.updateEntities=!0,e.type="import-export",e.translated={},e.delimiter=";",e.enclosure='"',this.selectedProfile=null,this.selectedProfile=e,this.showNewProfileWizard=!0},async onEditProfile(e){var o,t;const i=await this.profileRepository.get(e);Array.isArray(i.config)&&i.config.length<=0&&(this.profile.config={}),((o=i.config)==null?void 0:o.createEntities)===void 0&&(i.config.createEntities=!0),((t=i.config)==null?void 0:t.updateEntities)===void 0&&(i.config.updateEntities=!0),this.selectedProfile=i,this.showProfileEditModal=!0},onDuplicateProfile(e){const i={cloneChildren:!1,overwrites:{label:`${this.$tc("sw-import-export.profile.copyOfLabel")} ${e.label||e.translated.label}`,technicalName:`${e.technicalName}-copy-${Date.now()}`,systemDefault:!1}};return this.profileRepository.clone(e.id,i,Shopware.Context.api).then(o=>{const t=new s(1,25);return t.setIds([o.id]),this.profileRepository.search(t)}).then(o=>{var r,l;const t=o[0];return((r=t.config)==null?void 0:r.createEntities)===void 0&&(t.config.createEntities=!0),((l=t.config)==null?void 0:l.updateEntities)===void 0&&(t.config.updateEntities=!0),this.selectedProfile=t,this.showProfileEditModal=!0,this.loadProfiles()}).catch(()=>{this.createNotificationError({message:this.$tc("global.notification.unspecifiedSaveErrorMessage")})})},async onDownloadTemplate(e){return window.open(await this.importExport.getTemplateFileDownloadUrl(e.id),"_blank")},onDeleteProfile(e){this.$refs.listing.showDelete(e)},closeSelectedProfile(){this.showProfileEditModal=!1,this.selectedProfile=null},saveSelectedProfile(){return this.isLoading=!0,this.profileRepository.save(this.selectedProfile,Shopware.Context.api).then(()=>(this.showProfileEditModal=!1,this.selectedProfile=null,this.onCloseNewProfileWizard(),this.createNotificationSuccess({message:this.$tc("sw-import-export.profile.messageSaveSuccess",0)}),this.loadProfiles())).catch(e=>{this.onError(e)}).finally(()=>{this.isLoading=!1})},onError(e){var t,r,l,a;const i=((a=(l=(r=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:r.errors)==null?void 0:l[0])==null?void 0:a.code)??null;let o="";i!==null&&this.$te(`sw-import-export.errors.${i}`)&&(o=this.$tc(`sw-import-export.errors.${i}`)),this.createNotificationError({message:`${this.$tc("sw-import-export.profile.messageSaveError",0)} ${o}`})},getTypeLabel(e){return e?this.$tc("sw-import-export.profile.defaultTypeLabel"):this.$tc("sw-import-export.profile.customTypeLabel")},onCloseNewProfileWizard(){this.showNewProfileWizard=!1,this.selectedProfile=null}}};export{c as default};
