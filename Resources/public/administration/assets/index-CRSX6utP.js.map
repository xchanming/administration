{"version":3,"file":"index-CRSX6utP.js","sources":["../../../app/administration/src/module/sw-extension/component/sw-ratings/sw-extension-ratings-card/sw-extension-ratings-card.html.twig","../../../app/administration/src/module/sw-extension/component/sw-ratings/sw-extension-ratings-card/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_extension_ratings_card %}\n<sw-meteor-card\n    class=\"sw-extension-ratings-card\"\n    :is-loading=\"isLoading\"\n    :title=\"$tc('sw-extension-store.component.sw-extension-ratings.sw-extension-ratings-card.cardTitle')\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_extension_ratings_card_has_reviews %}\n    <template v-if=\"hasReviews\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_extension_ratings_card_has_reviews_summary %}\n        <sw-extension-ratings-summary :summary=\"summary\" />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_extension_ratings_card_has_reviews_wrapper %}\n        <div class=\"sw-extension-ratings-card__reviews\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_extension_ratings_card_has_reviews_wrapper_review %}\n            <sw-extension-review\n                v-for=\"(review, index) in reviews\"\n                :key=\"`sw-extension-ratings-card__reviews-review-${index}`\"\n                :producer-name=\"producerName\"\n                :review=\"review\"\n            />\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_extension_ratings_card_has_reviews_wrapper_more_button %}\n            <sw-button\n                v-if=\"canShowMore\"\n                size=\"small\"\n                @click=\"loadMoreReviews\"\n            >\n                {{ $tc('sw-extension-store.component.sw-extension-ratings.sw-extension-ratings-card.labelMoreReviewsBtn') }}\n            </sw-button>\n            {% endblock %}\n        </div>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_extension_ratings_card_empty_state %}\n    <template v-else>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_extension_ratings_card_empty_state_content %}\n        {{ $tc('sw-extension-store.component.sw-extension-ratings.sw-extension-ratings-card.labelNoReviews') }}\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_extension_ratings_card_installed_and_licensed_headline %}\n    <h3\n        v-if=\"isInstalledAndLicensed && !isLoading\"\n        class=\"sw-extension-ratings-card__footer-headline\"\n    >\n        {{ $tc('sw-extension-store.component.sw-extension-ratings.sw-extension-ratings-card.footerHeadline') }}\n    </h3>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_extension_ratings_card_footer %}\n    <template\n        v-if=\"isInstalledAndLicensed && !isLoading\"\n        #footer\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_extension_ratings_card_footer_review_creation %}\n        <sw-extension-review-creation\n            :extension=\"extension\"\n            @created=\"$emit('update-extension')\"\n        />\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-meteor-card>\n{% endblock %}\n","import template from './sw-extension-ratings-card.html.twig';\nimport './sw-extension-ratings-card.scss';\n\n/**\n * @package checkout\n * @private\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    emits: ['update-extension'],\n\n    mixins: ['sw-extension-error'],\n\n    props: {\n        extension: {\n            type: Object,\n            required: true,\n        },\n        producerName: {\n            type: String,\n            required: true,\n        },\n        isInstalledAndLicensed: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            reviews: [],\n            isLoading: false,\n            criteriaPage: 1,\n            criteriaLimit: 4,\n            summary: null,\n            numberOfRatings: 0,\n        };\n    },\n\n    computed: {\n        canShowMore() {\n            return this.summary.numberOfRatings > this.reviews.length;\n        },\n\n        numberOfRatingsHasChanged() {\n            return this.numberOfRatings !== this.summary.numberOfRatings;\n        },\n\n        extensionStoreDataService() {\n            return Cicada.Service('extensionStoreDataService');\n        },\n\n        hasReviews() {\n            return this.reviews.length > 0;\n        },\n    },\n\n    watch: {\n        extension() {\n            this.fetchReviews();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchReviews();\n        },\n\n        async fetchReviews(isLoadingMore = false) {\n            this.isLoading = true;\n\n            try {\n                const { reviews, summary } = await this.getReviews();\n                this.summary = summary;\n\n                if (isLoadingMore && this.numberOfRatingsHasChanged) {\n                    this.criteriaPage = 1;\n                    this.criteriaLimit = 4;\n                    this.reviews = [];\n                    await this.fetchReviews();\n\n                    return;\n                }\n\n                this.numberOfRatings = this.summary.numberOfRatings;\n                this.reviews = this.reviews.concat(reviews);\n            } catch (e) {\n                if (typeof this.showExtensionErrors === 'function') {\n                    this.showExtensionErrors(e);\n                }\n            } finally {\n                this.isLoading = false;\n            }\n        },\n\n        async loadMoreReviews() {\n            this.criteriaPage += 1;\n            await this.fetchReviews(true);\n        },\n\n        async getReviews() {\n            return this.extensionStoreDataService.getReviews(this.criteriaPage, this.criteriaLimit, this.extension.id);\n        },\n    },\n};\n"],"names":["template","index","isLoadingMore","reviews","summary"],"mappings":"AAAA,MAAeA,EAAA,09DCOAC,EAAA,CACX,SAAAD,EAEA,aAAc,OAAO,aAErB,MAAO,CAAC,kBAAkB,EAE1B,OAAQ,CAAC,oBAAoB,EAE7B,MAAO,CACH,UAAW,CACP,KAAM,OACN,SAAU,EACb,EACD,aAAc,CACV,KAAM,OACN,SAAU,EACb,EACD,uBAAwB,CACpB,KAAM,QACN,SAAU,GACV,QAAS,EACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,QAAS,CAAE,EACX,UAAW,GACX,aAAc,EACd,cAAe,EACf,QAAS,KACT,gBAAiB,CAC7B,CACK,EAED,SAAU,CACN,aAAc,CACV,OAAO,KAAK,QAAQ,gBAAkB,KAAK,QAAQ,MACtD,EAED,2BAA4B,CACxB,OAAO,KAAK,kBAAoB,KAAK,QAAQ,eAChD,EAED,2BAA4B,CACxB,OAAO,OAAO,QAAQ,2BAA2B,CACpD,EAED,YAAa,CACT,OAAO,KAAK,QAAQ,OAAS,CAChC,CACJ,EAED,MAAO,CACH,WAAY,CACR,KAAK,aAAY,CACpB,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,aAAY,CACpB,EAED,MAAM,aAAaE,EAAgB,GAAO,CACtC,KAAK,UAAY,GAEjB,GAAI,CACA,KAAM,CAAE,QAAAC,EAAS,QAAAC,CAAO,EAAK,MAAM,KAAK,WAAU,EAGlD,GAFA,KAAK,QAAUA,EAEXF,GAAiB,KAAK,0BAA2B,CACjD,KAAK,aAAe,EACpB,KAAK,cAAgB,EACrB,KAAK,QAAU,GACf,MAAM,KAAK,eAEX,MACH,CAED,KAAK,gBAAkB,KAAK,QAAQ,gBACpC,KAAK,QAAU,KAAK,QAAQ,OAAOC,CAAO,CAC7C,OAAQ,EAAG,CACJ,OAAO,KAAK,qBAAwB,YACpC,KAAK,oBAAoB,CAAC,CAE9C,QAAsB,CACN,KAAK,UAAY,EACpB,CACJ,EAED,MAAM,iBAAkB,CACpB,KAAK,cAAgB,EACrB,MAAM,KAAK,aAAa,EAAI,CAC/B,EAED,MAAM,YAAa,CACf,OAAO,KAAK,0BAA0B,WAAW,KAAK,aAAc,KAAK,cAAe,KAAK,UAAU,EAAE,CAC5G,CACJ,CACL"}