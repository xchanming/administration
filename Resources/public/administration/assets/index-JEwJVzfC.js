const o='{% block sw_image_preview_modal %} <transition name="sw-image-preview-modal-fade" appear > {% block sw_image_preview_modal_element %} <div class="sw-image-preview-modal"> {% block sw_image_preview_modal_action %} <div class="sw-image-preview-modal__action"> {% block sw_image_preview_modal_button_zoom_out %} <button ref="btnZoomOut" class="sw-image-preview-modal__button-action" :class="buttonClass(isDisabledZoomOut)" :disabled="isDisabledZoomOut" @click="onClickZoomOut" > <sw-icon name="regular-minus-circle" /> </button> {% endblock %} {% block sw_image_preview_modal_button_zoom_reset %} <button ref="btnReset" class="sw-image-preview-modal__button-action" :class="buttonClass(isDisabledReset)" :disabled="isDisabledReset" @click="onClickReset" > <sw-icon name="regular-compress-arrows" /> </button> {% endblock %} {% block sw_image_preview_modal_button_zoom_in %} <button ref="btnZoomIn" class="sw-image-preview-modal__button-action" :class="buttonClass(isDisabledZoomIn)" :disabled="isDisabledZoomIn" @click="onClickZoomIn" > <sw-icon name="regular-plus-circle" /> </button> {% endblock %} </div> {% endblock %} {% block sw_image_preview_modal_button_close %} <div class="sw-image-preview-modal__button-close" role="button" tabindex="0" @click="onClickClose" @keydown.enter="onClickClose" > <sw-icon name="regular-times" /> </div> {% endblock %} {% block sw_image_preview_modal_image_slider %} <sw-image-slider class="sw-image-preview-modal__image-slider" overflow="hidden" navigation-type="arrow" arrow-style="outside" display-mode="contain" rewind :images="images" :bordered="false" :rounded="false" :initial-index="activeItemIndex" @image-change="onImageSliderChange" @vue:mounted="afterComponentsMounted" /> {% endblock %} {% block sw_image_preview_modal_divider %} <hr v-if="images.length > 1" class="sw-image-preview-modal__divider" > {% endblock %} {% block sw_image_preview_modal_thumbnail_slider %} <sw-image-slider v-if="images.length > 1" class="sw-image-preview-modal__thumbnail-slider" overflow="hidden" navigation-type="arrow" arrow-style="outside" display-mode="contain" rewind :auto-width="images.length < itemPerPage" :bordered="false" :rounded="false" :initial-index="activeItemIndex" :images="images" :canvas-height="100" :item-per-page="itemPerPage" :element-padding="6" @image-change="onThumbnailSliderChange" @vue:mounted="afterComponentsMounted" /> {% endblock %} </div> {% endblock %} </transition> {% endblock %}',{Component:l}=Shopware;l.register("sw-image-preview-modal",{template:o,emits:["modal-close"],props:{mediaItems:{type:Array,required:!0},activeItemId:{type:String,required:!1,default:""},zoomSteps:{type:Number,required:!1,default:5},itemPerPage:{type:Number,required:!1,default:10}},data(){return{activeItemIndex:0,image:null,scale:1,isDisabledReset:!0,isDisabledZoomIn:!0,isDisabledZoomOut:!0,imageSliderMounted:!1}},computed:{images(){return this.mediaItems.map(e=>{var i;return(i=e==null?void 0:e.media)!=null&&i.url?{...e.media,src:e.media.url}:e})},maxZoomValue(){if(this.image){const{offsetWidth:e,offsetHeight:i,naturalWidth:t,naturalHeight:a}=this.image,s=Math.max(t/e,a/i);return Number.isNaN(s)?1:s}return 1}},created(){this.createdComponent()},updated(){this.updatedComponent()},unmounted(){this.destroyedComponent()},methods:{createdComponent(){this.activeItemId&&(this.activeItemIndex=this.mediaItems.findIndex(e=>e.id===this.activeItemId))},afterComponentsMounted(){this.imageSliderMounted||(this.imageSliderMounted=!0,document.querySelector("body").appendChild(this.$el),this.$el.addEventListener("wheel",this.onMouseWheel),this.getActiveImage().then(()=>{this.setActionButtonState()}))},updatedComponent(){this.getActiveImage().then(()=>{this.setActionButtonState()})},beforeDestroyComponent(){var e;((e=this.$parent)==null?void 0:e.$el)!==this.$el?this.$parent.$el.appendChild(this.$el):this.$el.remove()},destroyedComponent(){this.$el.removeEventListener("wheel",this.onMouseWheel)},buttonClass(e){return{"is--disabled":e}},async getActiveImage(){this.image=this.$el.querySelector(".sw-image-preview-modal__image-slider .sw-image-slider__element-image.is--active"),this.image.complete||(this.image=await this.loadImage(this.image))},loadImage(e){return new Promise((i,t)=>{e.onload=()=>i(e),e.onerror=t})},onClickClose(){this.$emit("modal-close")},onClickZoomIn(){const e=this.maxZoomValue/this.zoomSteps;this.scale=this.scale+e>this.maxZoomValue?this.maxZoomValue:this.scale+e,this.setTransition(),this.updateTransform()},onClickZoomOut(){const e=this.maxZoomValue/this.zoomSteps;this.scale=this.scale-e<1?1:this.scale-e,this.setTransition(),this.updateTransform()},onClickReset(){this.scale=1,this.updateTransform()},onImageSliderChange(e){this.activeItemIndex=e,this.scale=1},onThumbnailSliderChange(e){this.activeItemIndex=e,this.scale=1},setTransition(){const e="all 350ms ease 0s";this.image.style.transition=e,this.image.style.WebkitTransition=e,this.image.style.msTransition=e},updateTransform(){this.setActionButtonState();const e=`scale(${this.scale})`;this.image.style.transform=e,this.image.style.WebkitTransform=e,this.image.style.msTransform=e},setActionButtonState(){this.scale===1&&this.maxZoomValue===1?(this.isDisabledReset=!0,this.isDisabledZoomIn=!0,this.isDisabledZoomOut=!0):this.maxZoomValue<=this.scale?(this.isDisabledReset=!1,this.isDisabledZoomIn=!0,this.isDisabledZoomOut=!1):this.scale===1?(this.isDisabledReset=!0,this.isDisabledZoomIn=!1,this.isDisabledZoomOut=!0):(this.isDisabledReset=!1,this.isDisabledZoomIn=!1,this.isDisabledZoomOut=!1)},onMouseWheel(e){const i=e.wheelDelta/960;this.scale+i>this.maxZoomValue?this.scale=this.maxZoomValue:this.scale+i<1?this.scale=1:this.scale+=i,this.setTransition(),this.updateTransform()}}});
