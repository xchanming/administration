{"version":3,"file":"index-Cnw2L7Cm.js","sources":["../../../app/administration/src/module/sw-sales-channel/view/sw-sales-channel-detail-product-comparison/sw-sales-channel-detail-product-comparison.html.twig","../../../app/administration/src/module/sw-sales-channel/view/sw-sales-channel-detail-product-comparison/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_sales_channel_detail_base %}\n<div class=\"sw-sales-channel-detail-product-comparison\">\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_sales_channel_detail_product_comparison %}\n    <sw-card\n        key=\"edit\"\n        position-identifier=\"sw-sales-channel-detail-product-comparison\"\n        :is-loading=\"isLoading\"\n        :title=\"$tc('sw-sales-channel.detail.titleProductComparisonTemplate')\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sales_channel_detail_product_comparison_header %}\n        <sw-container>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_input_header %}\n            <sw-code-editor\n                v-model:value=\"productExport.headerTemplate\"\n                :label=\"$tc('sw-sales-channel.detail.productComparison.inputHeaderLabel')\"\n                :completer-function=\"outerCompleterFunctionHeader\"\n                :editor-config=\"editorConfig\"\n                completion-mode=\"entity\"\n                mode=\"twig\"\n                :soft-wraps=\"true\"\n                :set-focus=\"false\"\n                :disabled=\"!acl.can('sales_channel.editor')\"\n                @update:value=\"resetValid\"\n                @blur=\"resetValid\"\n            />\n            {% endblock %}\n        </sw-container>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sales_channel_detail_product_comparison_body %}\n        <sw-container>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_input_body %}\n            <sw-code-editor\n                v-model:value=\"productExport.bodyTemplate\"\n                :label=\"$tc('sw-sales-channel.detail.productComparison.inputBodyLabel')\"\n                :completer-function=\"outerCompleterFunctionBody\"\n                :editor-config=\"editorConfig\"\n                completion-mode=\"entity\"\n                mode=\"twig\"\n                :soft-wraps=\"true\"\n                :set-focus=\"false\"\n                :disabled=\"!acl.can('sales_channel.editor')\"\n                @update:value=\"resetValid\"\n                @blur=\"resetValid\"\n            />\n            {% endblock %}\n        </sw-container>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sales_channel_detail_product_comparison_footer %}\n        <sw-container>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_input_footer %}\n            <sw-code-editor\n                v-model:value=\"productExport.footerTemplate\"\n                :label=\"$tc('sw-sales-channel.detail.productComparison.inputFooterLabel')\"\n                :completer-function=\"outerCompleterFunctionFooter\"\n                :editor-config=\"editorConfig\"\n                completion-mode=\"entity\"\n                mode=\"twig\"\n                :soft-wraps=\"true\"\n                :set-focus=\"false\"\n                :disabled=\"!acl.can('sales_channel.editor')\"\n                @update:value=\"resetValid\"\n                @blur=\"resetValid\"\n            />\n            {% endblock %}\n        </sw-container>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_sales_channel_detail_product_comparison_actions %}\n        <div class=\"sw-sales-channel-detail-product-comparison__button-group\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_actions_test_button %}\n            <sw-button-process\n                size=\"small\"\n                variant=\"ghost\"\n                class=\"sw-sales-channel-detail-product-comparison__button sw-sales-channel-detail-product-comparison__test-action\"\n                :is-loading=\"isLoadingValidate\"\n                :disabled=\"isLoadingValidate || (!productExport.headerTemplate && !productExport.bodyTemplate && !productExport.footerTemplate)\"\n                :process-success=\"isValidateSuccessful\"\n                @click=\"validateTemplate\"\n            >\n                {{ $tc('sw-sales-channel.detail.productComparison.buttonTestLabel') }}\n            </sw-button-process>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_actions_preview_button %}\n            <sw-button-process\n                size=\"small\"\n                variant=\"ghost\"\n                class=\"sw-sales-channel-detail-product-comparison__button sw-sales-channel-detail-product-comparison__preview-action\"\n                :is-loading=\"isLoadingPreview\"\n                :disabled=\"isLoadingPreview || (!productExport.headerTemplate && !productExport.bodyTemplate && !productExport.footerTemplate)\"\n                :process-success=\"isPreviewSuccessful\"\n                @click=\"preview\"\n            >\n                {{ $tc('sw-sales-channel.detail.productComparison.buttonPreviewLabel') }}\n            </sw-button-process>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_sales_channel_detail_product_comparison_actions_preview_component %}\n            <sw-sales-channel-detail-product-comparison-preview\n                :content=\"previewContent\"\n                :errors=\"previewErrors\"\n                @close=\"onPreviewClose\"\n            />\n            {% endblock %}\n        </div>\n        {% endblock %}\n    </sw-card>\n    {% endblock %}\n</div>\n{% endblock %}\n","/**\n * @package discovery\n */\n\nimport template from './sw-sales-channel-detail-product-comparison.html.twig';\nimport './sw-sales-channel-detail-product-comparison.scss';\n\nconst { Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\nconst { warn } = Cicada.Utils.debug;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'salesChannelService',\n        'repositoryFactory',\n        'productExportService',\n        'entityMappingService',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n        Mixin.getByName('placeholder'),\n    ],\n\n    props: {\n        // eslint-disable-next-line vue/require-prop-types\n        salesChannel: {\n            required: true,\n        },\n\n        // eslint-disable-next-line vue/require-prop-types\n        productExport: {\n            required: true,\n        },\n\n        isLoading: {\n            type: Boolean,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            showDeleteModal: false,\n            defaultSnippetSetId: '71a916e745114d72abafbfdc51cbd9d0',\n            isLoadingDomains: false,\n            deleteDomain: null,\n            previewContent: null,\n            previewErrors: null,\n            isLoadingPreview: false,\n            isPreviewSuccessful: false,\n            isLoadingValidate: false,\n            isValidateSuccessful: false,\n        };\n    },\n\n    computed: {\n        editorConfig() {\n            return {\n                enableBasicAutocompletion: true,\n            };\n        },\n\n        productExportRepository() {\n            return this.repositoryFactory.create('product_export');\n        },\n\n        domainRepository() {\n            return this.repositoryFactory.create(this.salesChannel.domains.entity, this.salesChannel.domains.source);\n        },\n\n        salesChannelRepository() {\n            return this.repositoryFactory.create('sales_channel');\n        },\n\n        mainNavigationCriteria() {\n            const criteria = new Criteria(1, 10);\n\n            return criteria.addFilter(Criteria.equals('type', 'page'));\n        },\n\n        outerCompleterFunctionHeader() {\n            return this.outerCompleterFunction({\n                productExport: 'product_export',\n            });\n        },\n\n        outerCompleterFunctionBody() {\n            return this.outerCompleterFunction({\n                productExport: 'product_export',\n                product: 'product',\n            });\n        },\n\n        outerCompleterFunctionFooter() {\n            return this.outerCompleterFunction({\n                productExport: 'product_export',\n            });\n        },\n    },\n\n    methods: {\n        validateTemplate() {\n            const notificationValidateSuccess = {\n                message: this.$tc('sw-sales-channel.detail.productComparison.notificationMessageValidateSuccessful'),\n            };\n\n            this.isLoadingValidate = true;\n\n            this.productExportService\n                .validateProductExportTemplate(this.productExport)\n                .then((data) => {\n                    this.isLoadingValidate = false;\n\n                    if (data.errors) {\n                        this.previewContent = data.content;\n                        this.previewErrors = data.errors;\n                        return;\n                    }\n\n                    this.createNotificationSuccess(notificationValidateSuccess);\n                    this.isValidateSuccessful = true;\n                })\n                .catch((exception) => {\n                    this.createNotificationError({\n                        message: exception.response.data.errors[0].detail,\n                    });\n                    warn(this._name, exception.message, exception.response);\n\n                    this.isLoadingValidate = false;\n                    this.isValidateSuccessful = false;\n                });\n        },\n\n        preview() {\n            this.isLoadingPreview = true;\n\n            this.productExportService\n                .previewProductExport(this.productExport)\n                .then((data) => {\n                    this.isLoadingPreview = false;\n                    this.previewContent = data.content;\n\n                    if (data.errors) {\n                        this.previewErrors = data.errors;\n                        return;\n                    }\n\n                    this.isPreviewSuccessful = true;\n                })\n                .catch((exception) => {\n                    this.createNotificationError({\n                        message: exception.response.data.errors[0].detail,\n                    });\n                    warn(this._name, exception.message, exception.response);\n\n                    this.isLoadingPreview = false;\n                });\n        },\n\n        outerCompleterFunction(mapping) {\n            const entityMappingService = this.entityMappingService;\n\n            return function completerFunction(prefix) {\n                const entityMapping = entityMappingService.getEntityMapping(prefix, mapping);\n                return Object.keys(entityMapping).map((val) => {\n                    return { value: val };\n                });\n            };\n        },\n\n        onPreviewClose() {\n            this.previewContent = null;\n            this.previewErrors = null;\n            this.isPreviewSuccessful = false;\n        },\n\n        resetValid() {\n            this.isValidateSuccessful = false;\n        },\n    },\n};\n"],"names":["template","Mixin","Criteria","warn","index","notificationValidateSuccess","data","exception","mapping","entityMappingService","prefix","entityMapping","val"],"mappings":"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"}