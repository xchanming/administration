{"version":3,"file":"index-hQPevdSg.js","sources":["../../../app/administration/src/module/sw-product/component/sw-product-visibility-select/sw-product-visibility-select.html.twig","../../../app/administration/src/module/sw-product/component/sw-product-visibility-select/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_entity_multi_select_base_selection_list_label_inner %}\n<slot\n    name=\"selection-label-property\"\n    v-bind=\"{ item, index, labelProperty, valueProperty }\"\n>\n    {{ item.salesChannel.translated.name }}\n</slot>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_entity_multi_select_base_results_list_result_label %}\n<slot\n    name=\"result-label-property\"\n    v-bind=\"{ item, index, labelProperty, valueProperty: 'id' }\"\n>\n    {{ item.translated.name }}\n</slot>\n{% endblock %}\n","/*\n * @package inventory\n */\n\nimport template from './sw-product-visibility-select.html.twig';\n\nconst { EntityCollection, Criteria } = Cicada.Data;\nconst { mapState } = Cicada.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    emits: ['item-add'],\n\n    props: {\n        criteria: {\n            type: Object,\n            required: false,\n            default(props) {\n                const criteria = new Criteria(1, props.resultLimit);\n                criteria.addSorting(Criteria.sort('name', 'ASC'));\n                return criteria;\n            },\n        },\n    },\n\n    data() {\n        return {\n            defaultVisibility: 30,\n        };\n    },\n\n    computed: {\n        ...mapState('swProductDetail', [\n            'product',\n        ]),\n\n        repository() {\n            return this.repositoryFactory.create('sales_channel');\n        },\n\n        associationRepository() {\n            return this.repositoryFactory.create('product_visibility');\n        },\n    },\n\n    methods: {\n        isSelected(item) {\n            return this.currentCollection.some((entity) => {\n                return entity.salesChannelId === item.id;\n            });\n        },\n\n        addItem(item) {\n            // Remove when already selected\n            if (this.isSelected(item)) {\n                const associationEntity = this.currentCollection.find((entity) => {\n                    return entity.salesChannelId === item.id;\n                });\n                this.remove(associationEntity);\n\n                return;\n            }\n\n            // Create new entity\n            const newSalesChannelAssociation = this.associationRepository.create(this.entityCollection.context);\n            newSalesChannelAssociation.productId = this.product.id;\n            newSalesChannelAssociation.productVersionId = this.product.versionId;\n            newSalesChannelAssociation.salesChannelId = item.id;\n            newSalesChannelAssociation.visibility = this.defaultVisibility;\n            newSalesChannelAssociation.salesChannel = item;\n\n            this.$emit('item-add', item);\n\n            const changedCollection = EntityCollection.fromCollection(this.currentCollection);\n            changedCollection.add(newSalesChannelAssociation);\n\n            this.emitChanges(changedCollection);\n            this.onSelectExpanded();\n        },\n    },\n};\n"],"names":["template","EntityCollection","Criteria","mapState","index","props","criteria","item","entity","associationEntity","newSalesChannelAssociation","changedCollection"],"mappings":"AAAA,MAAeA,EAAA,ybCMT,CAAE,iBAAAC,EAAkB,SAAAC,GAAa,OAAO,KACxC,CAAE,SAAAC,CAAQ,EAAK,OAAO,UAAU,mBAAkB,EAGzCC,EAAA,CACX,SAAAJ,EAEA,MAAO,CAAC,UAAU,EAElB,MAAO,CACH,SAAU,CACN,KAAM,OACN,SAAU,GACV,QAAQK,EAAO,CACX,MAAMC,EAAW,IAAIJ,EAAS,EAAGG,EAAM,WAAW,EAClD,OAAAC,EAAS,WAAWJ,EAAS,KAAK,OAAQ,KAAK,CAAC,EACzCI,CACV,CACJ,CACJ,EAED,MAAO,CACH,MAAO,CACH,kBAAmB,EAC/B,CACK,EAED,SAAU,CACN,GAAGH,EAAS,kBAAmB,CAC3B,SACZ,CAAS,EAED,YAAa,CACT,OAAO,KAAK,kBAAkB,OAAO,eAAe,CACvD,EAED,uBAAwB,CACpB,OAAO,KAAK,kBAAkB,OAAO,oBAAoB,CAC5D,CACJ,EAED,QAAS,CACL,WAAWI,EAAM,CACb,OAAO,KAAK,kBAAkB,KAAMC,GACzBA,EAAO,iBAAmBD,EAAK,EACzC,CACJ,EAED,QAAQA,EAAM,CAEV,GAAI,KAAK,WAAWA,CAAI,EAAG,CACvB,MAAME,EAAoB,KAAK,kBAAkB,KAAMD,GAC5CA,EAAO,iBAAmBD,EAAK,EACzC,EACD,KAAK,OAAOE,CAAiB,EAE7B,MACH,CAGD,MAAMC,EAA6B,KAAK,sBAAsB,OAAO,KAAK,iBAAiB,OAAO,EAClGA,EAA2B,UAAY,KAAK,QAAQ,GACpDA,EAA2B,iBAAmB,KAAK,QAAQ,UAC3DA,EAA2B,eAAiBH,EAAK,GACjDG,EAA2B,WAAa,KAAK,kBAC7CA,EAA2B,aAAeH,EAE1C,KAAK,MAAM,WAAYA,CAAI,EAE3B,MAAMI,EAAoBV,EAAiB,eAAe,KAAK,iBAAiB,EAChFU,EAAkB,IAAID,CAA0B,EAEhD,KAAK,YAAYC,CAAiB,EAClC,KAAK,iBAAgB,CACxB,CACJ,CACL"}