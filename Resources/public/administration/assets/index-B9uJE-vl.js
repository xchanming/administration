const c='{% block sw_bulk_edit_save_modal_process %} <div class="sw-bulk-edit-save-modal-process"> {% block sw_bulk_edit_save_modal_process_icon %} <sw-label class="sw-bulk-edit-save-modal__icon" appearance="pill" variant="info" > <sw-loader class="sw-bulk-edit-save-modal__loading-icon" size="30px" /> </sw-label> {% endblock %} {% block sw_bulk_edit_save_modal_process_generate_document %} <ul v-if="selectedDocumentTypes.length > 0" class="sw-bulk-edit-save-modal-process__generate-document-container" > <li v-for="selectedDocumentType in selectedDocumentTypes" :key="selectedDocumentType.id" class="sw-bulk-edit-save-modal-process__generate-document" :class="`is--${selectedDocumentType.technicalName}`" > <div class="progress"> <div class="progress__label"> <span>{{ selectedDocumentType.translated.name }}</span> <span>{{ `${document[selectedDocumentType.technicalName].isReached}%` }}</span> </div> <div class="progress__bar"> <div class="progress__bar-fill" :style="{ width: `${document[selectedDocumentType.technicalName].isReached}%` }" > </div> </div> </div> </li> </ul> {% endblock %} {% block sw_bulk_edit_save_modal_process_content %} <p class="sw-bulk-edit-save-modal__help-text"> {{ $tc(\'sw-bulk-edit.modal.process.description\') }} <br> <br> {{ $tc(\'sw-bulk-edit.modal.process.helpText\') }} </p> <sw-alert variant="warning" class="sw-bulk-edit-save-modal__warning" > {{ $tc(\'sw-bulk-edit.modal.warningText\') }} </sw-alert> {% endblock %} </div> {% endblock %}',{chunk:o}=Cicada.Utils.array,n={template:c,compatConfig:Cicada.compatConfig,inject:["orderDocumentApiService"],emits:["changes-apply","title-set","buttons-update"],data(){return{requestsPerPayload:5,document:{invoice:{isReached:0},storno:{isReached:0},delivery_note:{isReached:0},credit_note:{isReached:0}}}},computed:{selectedIds(){return Cicada.State.get("cicadaApps").selectedIds},documentTypes(){var e,s,t;return(t=(s=(e=Cicada.State.get("swBulkEdit"))==null?void 0:e.orderDocuments)==null?void 0:s.download)==null?void 0:t.value},documentTypeConfigs(){return Cicada.State.getters["swBulkEdit/documentTypeConfigs"]},selectedDocumentTypes(){if(!this.documentTypeConfigs||this.documentTypeConfigs.length<=0)return[];const e=[];return this.documentTypeConfigs.forEach(s=>{const t=this.documentTypes.find(a=>s.type===a.technicalName);t&&e.push(t)}),e},createDocumentPayload(){const e=[];return this.selectedIds.forEach(s=>{var t;(t=this.documentTypeConfigs)==null||t.forEach(a=>{a&&e.push({...a,orderId:s})})}),e}},created(){this.createdComponent()},methods:{async createdComponent(){this.updateButtons(),this.setTitle(),await this.createDocuments(),this.$emit("changes-apply")},setTitle(){this.$emit("title-set",this.$tc("sw-bulk-edit.modal.process.title"))},updateButtons(){const e=[{key:"cancel",label:this.$tc("global.default.cancel"),position:"left",action:"",disabled:!1},{key:"next",label:this.$tc("global.sw-modal.labelClose"),position:"right",variant:"primary",action:"",disabled:!0}];this.$emit("buttons-update",e)},async createDocuments(){if(this.createDocumentPayload.length<=0)return;const e=this.createDocumentPayload.filter(i=>i.type==="invoice"),s=this.createDocumentPayload.filter(i=>i.type==="storno"),t=this.createDocumentPayload.filter(i=>i.type==="credit_note"),a=this.createDocumentPayload.filter(i=>i.type==="delivery_note");e.length>0&&await this.createDocument("invoice",e),s.length>0&&await this.createDocument("storno",s),t.length>0&&await this.createDocument("credit_note",t),a.length>0&&await this.createDocument("delivery_note",a)},async createDocument(e,s){if(s.length<=this.requestsPerPayload)return await this.orderDocumentApiService.generate(e,s),this.isCompatEnabled("INSTANCE_SET")?this.$set(this.document[e],"isReached",100):this.document[e].isReached=100,Promise.resolve();const t=o(s,this.requestsPerPayload),a=Math.round(100/t.length);return Promise.all(t.map(async i=>{await this.orderDocumentApiService.generate(e,i),this.isCompatEnabled("INSTANCE_SET")?this.$set(this.document[e],"isReached",this.document[e].isReached+a):this.document[e].isReached=this.document[e].isReached+a})).then(()=>{this.isCompatEnabled("INSTANCE_SET")?this.$set(this.document[e],"isReached",100):this.document[e].isReached=100})}}};export{n as default};
//# sourceMappingURL=index-B9uJE-vl.js.map
