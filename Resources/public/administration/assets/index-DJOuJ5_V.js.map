{"version":3,"file":"index-DJOuJ5_V.js","sources":["../../../app/administration/src/app/component/form/select/base/sw-multi-select/sw-multi-select.html.twig","../../../app/administration/src/app/component/form/select/base/sw-multi-select/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_multi_select %}\n<sw-select-base\n    class=\"sw-multi-select\"\n    :is-loading=\"isLoading\"\n    v-bind=\"$attrs\"\n    :label=\"label\"\n    @select-expanded=\"onSelectExpanded\"\n    @select-collapsed=\"onSelectCollapsed\"\n    v-on=\"listeners\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_multi_select_base %}\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_multi_select_base_selection %}\n    <template #sw-select-selection=\"{ identification, error, disabled, size, expand, collapse }\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_multi_select_base_selection_slot %}\n        <sw-select-selection-list\n            ref=\"selectionList\"\n            :selections=\"visibleValues\"\n            :invisible-count=\"invisibleValueCount\"\n            v-bind=\"{ size, valueProperty, labelProperty, placeholder, searchTerm, disabled: disabled || undefined }\"\n            :input-label=\"label\"\n            @total-count-click=\"expandValueLimit\"\n            @item-remove=\"remove\"\n            @last-item-delete=\"removeLastItem\"\n            @search-term-change=\"onSearchTermChange\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_selection_list %}\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_selection_list_label %}\n            <template #label-property=\"{ item, index, labelProperty, valueProperty }\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_multi_select_base_selection_list_label_inner %}\n                <slot\n                    name=\"selection-label-property\"\n                    v-bind=\"{ item, index, labelProperty, valueProperty}\"\n                >\n                    {{ getKey(item, labelProperty) }}\n                </slot>\n                {% endblock %}\n            </template>\n            {% endblock %}\n            {% endblock %}\n        </sw-select-selection-list>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_multi_select_base_results %}\n    <template #results-list>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_multi_select_base_results_slot %}\n        <sw-select-result-list\n            ref=\"swSelectResultList\"\n            :options=\"visibleResults\"\n            :is-loading=\"isLoading\"\n            :empty-message=\"$tc('global.sw-multi-select.messageNoResults', 0, { term: searchTerm })\"\n            :focus-el=\"$refs.selectionList.getFocusEl()\"\n            @paginate=\"$emit('paginate')\"\n            @item-select=\"addItem\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_results_list %}\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_results_list_before %}\n            <template #before-item-list>\n                <slot name=\"before-item-list\"></slot>\n            </template>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_results_list_result %}\n            <template #result-item=\"{ item, index }\">\n                <slot\n                    name=\"result-item\"\n                    v-bind=\"{ item, index, labelProperty, valueProperty, searchTerm, highlightSearchTerm, isSelected, addItem, getKey }\"\n                >\n                    <sw-select-result\n                        :selected=\"isSelected(item)\"\n                        :class=\"'sw-select-option--' + item.value\"\n                        v-bind=\"{ item, index }\"\n                        :aria-label=\"getKey(item, labelProperty)\"\n                        @item-select=\"addItem\"\n                    >\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_multi_select_base_results_list_result_label %}\n                        <slot\n                            name=\"result-label-property\"\n                            v-bind=\"{ item, index, labelProperty, valueProperty, searchTerm, getKey }\"\n                        >\n                            <sw-highlight-text\n                                v-if=\"highlightSearchTerm\"\n                                :text=\"getKey(item, labelProperty)\"\n                                :search-term=\"searchTerm\"\n                            />\n                            <template v-else>\n                                {{ getKey(item, labelProperty) }}\n                            </template>\n                        </slot>\n                        {% endblock %}\n                    </sw-select-result>\n                </slot>\n            </template>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_multi_select_base_results_list_after %}\n            <template #after-item-list>\n                <slot name=\"after-item-list\"></slot>\n            </template>\n            {% endblock %}\n            {% endblock %}\n        </sw-select-result-list>\n        {% endblock %}\n    </template>\n    {% endblock %}\n    {% endblock %}\n\n    <template #label>\n        <slot name=\"label\"></slot>\n    </template>\n\n    <template #hint>\n        <slot name=\"hint\"></slot>\n    </template>\n</sw-select-base>\n{% endblock %}\n","import template from './sw-multi-select.html.twig';\n\nconst { Component, Mixin } = Cicada;\nconst { debounce, get } = Cicada.Utils;\n\n/**\n * @package admin\n *\n * @private\n * @status ready\n * @description Renders a multi select field with a defined list of options. This component uses the sw-field base\n * components. This adds the base properties such as <code>helpText</code>, <code>error</code>, <code>disabled</code> etc.\n * @example-type code-only\n * @component-example\n * <sw-multi-select\n *     label=\"Multi Select\"\n *     :options=\"[\n *         { value 'uuid1', label 'Portia Jobson' },\n *         { value 'uuid2', label 'Baxy Eardley' },\n *         { value 'uuid3', label 'Arturo Staker' },\n *         { value 'uuid4', label 'Dalston Top' },\n *         { value 'uuid5', label 'Neddy Jensen' }\n *     ]\"\n *     value=\"\">\n * </sw-multi-select>\n */\nComponent.register('sw-multi-select', {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inheritAttrs: false,\n\n    inject: ['feature'],\n\n    emits: [\n        'update:value',\n        'item-add',\n        'item-remove',\n        'search-term-change',\n        'display-values-expand',\n        'paginate',\n    ],\n\n    mixins: [\n        Mixin.getByName('remove-api-error'),\n    ],\n\n    props: {\n        options: {\n            type: Array,\n            required: true,\n        },\n        value: {\n            required: true,\n            validator(value) {\n                return Array.isArray(value) || value === null || value === undefined;\n            },\n        },\n        labelProperty: {\n            type: String,\n            required: false,\n            default: 'label',\n        },\n        valueProperty: {\n            type: String,\n            required: false,\n            default: 'value',\n        },\n        placeholder: {\n            type: String,\n            required: false,\n            default: '',\n        },\n        valueLimit: {\n            type: Number,\n            required: false,\n            default: 5,\n        },\n        isLoading: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n        highlightSearchTerm: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n        // Used to implement a custom search function.\n        // Parameters passed: { options, labelProperty, valueProperty, searchTerm }\n        searchFunction: {\n            type: Function,\n            required: false,\n            default({ options, labelProperty, searchTerm }) {\n                return options.filter((option) => {\n                    const label = this.getKey(option, labelProperty);\n                    if (!label) {\n                        return false;\n                    }\n                    return label.toLowerCase().includes(searchTerm.toLowerCase());\n                });\n            },\n        },\n        label: {\n            type: String,\n            required: false,\n            default: undefined,\n        },\n    },\n\n    data() {\n        return {\n            searchTerm: '',\n            limit: this.valueLimit,\n        };\n    },\n\n    computed: {\n        visibleValues() {\n            if (!this.currentValue || this.currentValue.length <= 0) {\n                return [];\n            }\n\n            return this.options\n                .filter((item) => {\n                    return this.currentValue.includes(this.getKey(item, this.valueProperty));\n                })\n                .slice(0, this.limit);\n        },\n\n        totalValuesCount() {\n            if (this.currentValue.length) {\n                return this.currentValue.length;\n            }\n\n            return 0;\n        },\n\n        invisibleValueCount() {\n            if (!this.currentValue) {\n                return 0;\n            }\n\n            return Math.max(0, this.totalValuesCount - this.limit);\n        },\n\n        currentValue: {\n            get() {\n                if (!this.value) {\n                    return [];\n                }\n\n                return this.value;\n            },\n            set(newValue) {\n                this.$emit('update:value', newValue);\n            },\n        },\n\n        visibleResults() {\n            if (this.searchTerm) {\n                return this.searchFunction({\n                    options: this.options,\n                    labelProperty: this.labelProperty,\n                    valueProperty: this.valueProperty,\n                    searchTerm: this.searchTerm,\n                });\n            }\n\n            return this.options;\n        },\n\n        listeners() {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-call,@typescript-eslint/no-unsafe-member-access\n            if (this.isCompatEnabled('INSTANCE_LISTENERS')) {\n                return this.$listeners;\n            }\n\n            return {};\n        },\n    },\n\n    methods: {\n        isSelected(item) {\n            return this.currentValue.includes(this.getKey(item, this.valueProperty));\n        },\n\n        addItem(item) {\n            const identifier = this.getKey(item, this.valueProperty);\n\n            if (this.isSelected(item)) {\n                this.remove(item);\n                return;\n            }\n\n            this.$emit('item-add', item);\n\n            this.currentValue = [\n                ...this.currentValue,\n                identifier,\n            ];\n\n            this.$refs.selectionList.focus();\n            this.$refs.selectionList.select();\n        },\n\n        remove(item) {\n            this.$emit('item-remove', item);\n\n            this.currentValue = this.currentValue.filter((value) => {\n                return value !== this.getKey(item, this.valueProperty);\n            });\n        },\n\n        removeLastItem() {\n            if (!this.visibleValues.length) {\n                return;\n            }\n\n            if (this.invisibleValueCount > 0) {\n                this.expandValueLimit();\n                return;\n            }\n\n            const lastSelection = this.visibleValues[this.visibleValues.length - 1];\n            this.remove(lastSelection);\n        },\n\n        expandValueLimit() {\n            this.$emit('display-values-expand');\n\n            this.limit += this.limit;\n        },\n\n        onSearchTermChange: debounce(function updateSearchTerm(term) {\n            this.searchTerm = term;\n            this.$emit('search-term-change', this.searchTerm);\n            this.resetActiveItem();\n        }, 100),\n\n        resetActiveItem() {\n            this.$refs.swSelectResultList.setActiveItemIndex(0);\n        },\n\n        onSelectExpanded() {\n            this.$refs.selectionList.focus();\n        },\n\n        onSelectCollapsed() {\n            this.searchTerm = '';\n            this.$refs.selectionList.blur();\n\n            // Focus on the input field when the select is collapsed\n            if (this.$refs.selectionList?.$refs?.swSelectInput) {\n                this.$refs.selectionList.$refs.swSelectInput.focus();\n            }\n        },\n\n        getKey(object, keyPath, defaultValue) {\n            return get(object, keyPath, defaultValue);\n        },\n    },\n});\n"],"names":["template","Component","Mixin","debounce","get","value","options","labelProperty","searchTerm","option","label","item","newValue","identifier","lastSelection","term","_a","_b","object","keyPath","defaultValue"],"mappings":"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"}