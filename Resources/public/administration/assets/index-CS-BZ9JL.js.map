{"version":3,"file":"index-CS-BZ9JL.js","sources":["../../../app/administration/src/module/sw-settings-custom-field/component/sw-custom-field-detail/sw-custom-field-detail.html.twig","../../../app/administration/src/module/sw-settings-custom-field/component/sw-custom-field-detail/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_custom_field_detail %}\n<sw-modal\n    class=\"sw-custom-field-detail\"\n    :title=\"modalTitle\"\n    @modal-close=\"onCancel\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_custom_field_detail_modal %}\n    <sw-container\n        columns=\"1fr 1fr\"\n        gap=\"20px\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_type %}\n        <sw-select-field\n            v-model:value=\"currentCustomField.config.customFieldType\"\n            :label=\"$tc('sw-settings-custom-field.customField.detail.labelCustomFieldType')\"\n            :placeholder=\"$tc('sw-settings-custom-field.customField.detail.placeholderCustomFieldType')\"\n            class=\"sw-custom-field-detail__modal-type\"\n            type=\"select\"\n            :help-text=\"$tc('sw-settings-custom-field.general.tooltipType')\"\n            :disabled=\"!currentCustomField._isNew || !acl.can('custom_field.editor') || undefined\"\n        >\n            <option\n                v-for=\"(option, key) in fieldTypes\"\n                :key=\"key\"\n                :value=\"key\"\n            >\n                {{ $tc(`sw-settings-custom-field.types.${key}`) }}\n            </option>\n        </sw-select-field>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_technical_name %}\n        <sw-text-field\n            v-model:value=\"currentCustomField.name\"\n            class=\"sw-custom-field-detail__technical-name\"\n            :label=\"$tc('sw-settings-custom-field.customField.detail.labelTechnicalName')\"\n            :help-text=\"$tc('sw-settings-custom-field.general.tooltipTechnicalName')\"\n            :disabled=\"!currentCustomField._isNew || !acl.can('custom_field.editor') || undefined\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_position %}\n        <sw-number-field\n            v-model:value=\"currentCustomField.config.customFieldPosition\"\n            class=\"sw-custom-field-detail__modal-position\"\n            :help-text=\"$tc('sw-settings-custom-field.customField.detail.tooltipCustomFieldPosition')\"\n            number-type=\"int\"\n            :label=\"$tc('sw-settings-custom-field.customField.detail.labelCustomFieldPosition')\"\n            :disabled=\"!acl.can('custom_field.editor') || undefined\"\n        />\n        {% endblock %}\n\n        {# @deprecated tag:v6.7.0 - Block will be removed without replacement #}\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_required %}{% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_allow_customer_write %}\n        <sw-switch-field\n            v-model:value=\"currentCustomField.allowCustomerWrite\"\n            bordered\n            :help-text=\"$tc('sw-settings-custom-field.customField.detail.tooltipAllowCustomerWrite')\"\n            class=\"sw-custom-field-detail__allow-customer-write\"\n            :label=\"$tc('sw-settings-custom-field.customField.detail.labelAllowCustomerWrite')\"\n            :disabled=\"!acl.can('custom_field.editor') || undefined\"\n        />\n        {% endblock %}\n\n        <sw-switch-field\n            v-if=\"isProductCustomField\"\n            v-model:value=\"currentCustomField.allowCartExpose\"\n            v-tooltip=\"getCartExposeTooltipConfig()\"\n            bordered\n            :help-text=\"$tc('sw-settings-custom-field.customField.detail.tooltipAllowCartExpose')\"\n            class=\"sw-custom-field-detail__allow-cart-expose\"\n            :label=\"$tc('sw-settings-custom-field.customField.detail.labelAllowCartExpose')\"\n            :disabled=\"!acl.can('custom_field.editor') || disableCartExpose || undefined\"\n        />\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_snippet_info  %}\n        <sw-alert class=\"sw-custom-field-detail__info\">\n            {{ $tc('sw-settings-custom-field.customField.detail.infoText', 0, { name: currentCustomField.name }) }}\n        </sw-alert>\n        {% endblock %}\n    </sw-container>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_custom_field_detail_modal_render_component %}\n    <div v-if=\"currentCustomField.config.customFieldType?.length > 0\">\n        <component\n            :is=\"renderComponentName\"\n            :current-custom-field=\"currentCustomField\"\n            :set=\"set\"\n        />\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_custom_field_detail_modal_footer %}\n    <template #modal-footer>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_footer_cancel %}\n        <sw-button\n            size=\"small\"\n            @click=\"onCancel\"\n        >\n            {{ $tc('global.default.cancel') }}\n        </sw-button>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_custom_field_detail_modal_footer_save %}\n        <sw-button\n            class=\"sw-custom-field-detail__footer-save\"\n            variant=\"primary\"\n            size=\"small\"\n            :disabled=\"!canSave || !acl.can('custom_field.editor') || undefined\"\n            @click=\"onSave\"\n        >\n            {{ labelSaveButton }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n","/**\n * @package services-settings\n */\nimport template from './sw-custom-field-detail.html.twig';\nimport './sw-custom-field-detail.scss';\n\nconst { Mixin, Context } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'customFieldDataProviderService',\n        'SwCustomFieldListIsCustomFieldNameUnique',\n        'acl',\n    ],\n\n    emits: [\n        'custom-field-edit-cancel',\n        'custom-field-edit-save',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        currentCustomField: {\n            type: Object,\n            required: true,\n        },\n\n        set: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            fieldTypes: {},\n            disableCartExpose: true,\n        };\n    },\n\n    computed: {\n        locales() {\n            if (this.set.config.translated && this.set.config.translated === true) {\n                return Object.keys(this.$root.$i18n.messages);\n            }\n\n            return [this.$root.$i18n.fallbackLocale];\n        },\n\n        canSave() {\n            return this.currentCustomField.config.customFieldType;\n        },\n\n        renderComponentName() {\n            return this.fieldTypes[this.currentCustomField.config.customFieldType]?.configRenderComponent;\n        },\n\n        modalTitle() {\n            if (this.currentCustomField._isNew) {\n                return this.$tc('sw-settings-custom-field.customField.detail.titleNewCustomField');\n            }\n\n            return this.$tc('sw-settings-custom-field.customField.detail.titleEditCustomField');\n        },\n\n        labelSaveButton() {\n            if (this.currentCustomField._isNew) {\n                return this.$tc('global.default.add');\n            }\n\n            return this.$tc('sw-settings-custom-field.customField.detail.buttonEditApply');\n        },\n\n        isProductCustomField() {\n            if (!this.set.relations) {\n                return false;\n            }\n\n            return this.set.relations.filter((relation) => relation.entityName === 'product').length !== 0;\n        },\n\n        ruleConditionRepository() {\n            return this.repositoryFactory.create('rule_condition');\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fieldTypes = this.customFieldDataProviderService.getTypes();\n\n            if (!this.currentCustomField.config) {\n                if (this.isCompatEnabled('INSTANCE_SET')) {\n                    this.$set(this.currentCustomField, 'config', {});\n                } else {\n                    this.currentCustomField.config = {};\n                }\n            }\n\n            if (!this.currentCustomField.config.hasOwnProperty('customFieldType')) {\n                if (this.isCompatEnabled('INSTANCE_SET')) {\n                    this.$set(this.currentCustomField.config, 'customFieldType', '');\n                } else {\n                    this.currentCustomField.config.customFieldType = '';\n                }\n            }\n\n            if (!this.currentCustomField.name) {\n                this.currentCustomField.name = `${this.set.name.toLowerCase()}_`;\n            }\n\n            if (!this.currentCustomField.config.hasOwnProperty('customFieldPosition')) {\n                if (this.isCompatEnabled('INSTANCE_SET')) {\n                    this.$set(this.currentCustomField.config, 'customFieldPosition', 1);\n                } else {\n                    this.currentCustomField.config.customFieldPosition = 1;\n                }\n            }\n\n            if (!this.currentCustomField.allowCartExpose) {\n                this.disableCartExpose = false;\n\n                return;\n            }\n\n            const criteria = new Criteria(1, 1);\n            criteria.addFilter(\n                Criteria.multi('AND', [\n                    Criteria.equals('type', 'cartLineItemCustomField'),\n                    Criteria.equals('value.renderedField.name', this.currentCustomField.name),\n                ]),\n            );\n\n            this.ruleConditionRepository.search(criteria, Context.api).then((searchResult) => {\n                this.disableCartExpose = searchResult.length > 0;\n            });\n        },\n\n        onCancel() {\n            this.$emit('custom-field-edit-cancel', this.currentCustomField);\n        },\n\n        onSave() {\n            this.applyTypeConfiguration();\n\n            if (!this.currentCustomField._isNew) {\n                this.$emit('custom-field-edit-save', this.currentCustomField);\n\n                return;\n            }\n\n            if (this.currentCustomField.config.customFieldType === 'entity') {\n                if (!this.currentCustomField.config.entity) {\n                    this.createEntityTypeRequiredNotification();\n\n                    return;\n                }\n            }\n\n            this.SwCustomFieldListIsCustomFieldNameUnique(this.currentCustomField).then((isUnique) => {\n                if (isUnique) {\n                    this.$emit('custom-field-edit-save', this.currentCustomField);\n\n                    return;\n                }\n\n                this.createNameNotUniqueNotification();\n            });\n        },\n\n        createNameNotUniqueNotification() {\n            const notificationTitle = this.$tc('global.default.error');\n            const nameNotUniqueMessage = this.$tc('sw-settings-custom-field.set.detail.messageNameNotUnique');\n\n            this.createNotificationError({\n                title: notificationTitle,\n                message: nameNotUniqueMessage,\n            });\n        },\n\n        createEntityTypeRequiredNotification() {\n            const notificationTitle = this.$tc('global.default.error');\n            const entityTypeRequiredTitle = this.$tc('sw-settings-custom-field.set.detail.entityTypeRequired');\n\n            this.createNotificationError({\n                title: notificationTitle,\n                message: entityTypeRequiredTitle,\n            });\n        },\n\n        applyTypeConfiguration() {\n            const customFieldType = this.currentCustomField.config.customFieldType;\n\n            if (!this.currentCustomField.type) {\n                this.currentCustomField.type = this.fieldTypes[customFieldType].type || customFieldType;\n            }\n\n            this.currentCustomField.config = {\n                ...this.fieldTypes[customFieldType].config,\n                ...this.currentCustomField.config,\n            };\n        },\n\n        getCartExposeTooltipConfig() {\n            if (!this.disableCartExpose) {\n                return { message: '', disabled: true };\n            }\n\n            return {\n                disabled: false,\n                width: 260,\n                message: this.$t('sw-settings-custom-field.customField.detail.tooltipCartExposeDisabled'),\n            };\n        },\n    },\n};\n"],"names":["template","Mixin","Context","Criteria","index","_a","relation","criteria","searchResult","isUnique","notificationTitle","nameNotUniqueMessage","entityTypeRequiredTitle","customFieldType"],"mappings":"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"}