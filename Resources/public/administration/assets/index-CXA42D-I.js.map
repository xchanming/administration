{"version":3,"file":"index-CXA42D-I.js","sources":["../../../app/administration/src/module/sw-cms/elements/product-listing/config/components/sw-cms-el-config-product-listing-config-sorting-grid/sw-cms-el-config-product-listing-config-sorting-grid.html.twig","../../../app/administration/src/module/sw-cms/elements/product-listing/config/components/sw-cms-el-config-product-listing-config-sorting-grid/index.js"],"sourcesContent":["<div class=\"sw-cms-el-config-product-listing-config-sorting-grid\">\n\n    <sw-data-grid\n        class=\"sw-cms-el-config-product-listing-config-sorting-grid__grid\"\n        :data-source=\"visibleProductSortings\"\n        :columns=\"gridColumns\"\n        :compact-mode=\"false\"\n        :allow-inline-edit=\"true\"\n        :show-selection=\"false\"\n        plain-appearance\n    >\n\n        <template #actions=\"{ item }\">\n            <sw-context-menu-item\n                v-if=\"!item.locked\"\n                :class=\"'sw-cms-el-config-product-listing-config-sorting-grid__grid_item_' + item.id\"\n                variant=\"danger\"\n                :disabled=\"isDefaultSorting(item)\"\n                @click=\"onDelete(item)\"\n            >\n                {{ $tc('global.default.delete') }}\n            </sw-context-menu-item>\n        </template>\n\n        <template #column-fields=\"{ item }\">\n            <span\n                class=\"sw-cms-el-config-product-listing-config-sorting-grid__criteria\"\n                :title=\"formatProductSortingFields(item.fields)\"\n            >\n                {{ formatProductSortingFields(item.fields) }}\n            </span>\n        </template>\n\n        <template #pagination>\n            <sw-pagination\n                v-if=\"paginationVisible\"\n                :page=\"page\"\n                :limit=\"limit\"\n                :total=\"total\"\n                :steps=\"steps\"\n                :auto-hide=\"false\"\n                @page-change=\"onPageChange\"\n            />\n        </template>\n    </sw-data-grid>\n</div>\n","import template from './sw-cms-el-config-product-listing-config-sorting-grid.html.twig';\nimport './sw-cms-el-config-product-listing-config-sorting-grid.scss';\n\nconst { Criteria } = Cicada.Data;\n\n/**\n * @private\n * @package discovery\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['repositoryFactory'],\n\n    mixins: [\n        'sw-inline-snippet',\n    ],\n\n    props: {\n        productSortings: {\n            type: Array,\n            required: true,\n        },\n        defaultSorting: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            limit: 10,\n            page: 1,\n            customFields: [],\n        };\n    },\n\n    computed: {\n        visibleProductSortings() {\n            return this.productSortings.slice((this.page - 1) * this.limit, (this.page - 1) * this.limit + this.limit);\n        },\n\n        paginationVisible() {\n            return this.total > this.limit;\n        },\n\n        customFieldRepository() {\n            return this.repositoryFactory.create('custom_field');\n        },\n\n        customFieldCriteria() {\n            return new Criteria(1, 25);\n        },\n\n        total() {\n            return this.productSortings.length;\n        },\n\n        gridColumns() {\n            return [\n                {\n                    property: 'label',\n                    label: 'sw-cms.elements.productListing.config.sorting.gridHeaderName',\n                },\n                {\n                    property: 'fields',\n                    label: 'sw-cms.elements.productListing.config.sorting.gridHeaderFields',\n                    multiLine: true,\n                },\n                {\n                    property: 'priority',\n                    label: 'sw-cms.elements.productListing.config.sorting.gridHeaderPriority',\n                    inlineEdit: 'number',\n                },\n            ];\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchCustomFields();\n        },\n\n        fetchCustomFields() {\n            this.customFieldRepository.search(this.customFieldCriteria).then((response) => {\n                this.customFields = response;\n            });\n        },\n\n        formatProductSortingFields(fields) {\n            if (!Array.isArray(fields)) {\n                return '';\n            }\n\n            const labels = fields.map((currentField) => {\n                if (this.isItemACustomField(currentField.field)) {\n                    return this.getCustomFieldLabelByCriteriaName(currentField.field);\n                }\n\n                return this.$tc(\n                    `sw-settings-listing.general.productSortingCriteriaGrid.options.label.${currentField.field}`,\n                );\n            });\n\n            return labels.join(', ');\n        },\n\n        isItemACustomField(fieldName) {\n            const strippedFieldName = this.stripCustomFieldPath(fieldName);\n\n            return this.customFields.some((currentCustomField) => {\n                return currentCustomField.name === strippedFieldName;\n            });\n        },\n\n        stripCustomFieldPath(fieldName) {\n            return fieldName.replace(/customFields\\./, '');\n        },\n\n        getCustomFieldLabelByCriteriaName(criteriaName) {\n            const technicalName = this.stripCustomFieldPath(criteriaName);\n            const customField = this.getCustomFieldByName(technicalName);\n\n            const inlineSnippet = this.getInlineSnippet(customField.config.label);\n\n            if (inlineSnippet === null) {\n                return technicalName;\n            }\n\n            return inlineSnippet;\n        },\n\n        getCustomFieldByName(technicalName) {\n            return this.customFields.find((currentCustomField) => {\n                return currentCustomField.name === technicalName;\n            });\n        },\n\n        onDelete(productSorting) {\n            this.productSortings.remove(productSorting.id);\n        },\n\n        isDefaultSorting(productSorting) {\n            if (!this.defaultSorting) {\n                return false;\n            }\n\n            return productSorting.id === this.defaultSorting.id;\n        },\n\n        onPageChange({ page, limit }) {\n            this.page = page;\n            this.limit = limit;\n        },\n    },\n};\n"],"names":["template","Criteria","index","response","fields","currentField","fieldName","strippedFieldName","currentCustomField","criteriaName","technicalName","customField","inlineSnippet","productSorting","page","limit"],"mappings":"AAAA,MAAeA,EAAA,uhCCGT,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAMbC,EAAA,CACX,SAAAF,EAEA,aAAc,OAAO,aAErB,OAAQ,CAAC,mBAAmB,EAE5B,OAAQ,CACJ,mBACH,EAED,MAAO,CACH,gBAAiB,CACb,KAAM,MACN,SAAU,EACb,EACD,eAAgB,CACZ,KAAM,OACN,SAAU,EACb,CACJ,EAED,MAAO,CACH,MAAO,CACH,MAAO,GACP,KAAM,EACN,aAAc,CAAE,CAC5B,CACK,EAED,SAAU,CACN,wBAAyB,CACrB,OAAO,KAAK,gBAAgB,OAAO,KAAK,KAAO,GAAK,KAAK,OAAQ,KAAK,KAAO,GAAK,KAAK,MAAQ,KAAK,KAAK,CAC5G,EAED,mBAAoB,CAChB,OAAO,KAAK,MAAQ,KAAK,KAC5B,EAED,uBAAwB,CACpB,OAAO,KAAK,kBAAkB,OAAO,cAAc,CACtD,EAED,qBAAsB,CAClB,OAAO,IAAIC,EAAS,EAAG,EAAE,CAC5B,EAED,OAAQ,CACJ,OAAO,KAAK,gBAAgB,MAC/B,EAED,aAAc,CACV,MAAO,CACH,CACI,SAAU,QACV,MAAO,8DACV,EACD,CACI,SAAU,SACV,MAAO,iEACP,UAAW,EACd,EACD,CACI,SAAU,WACV,MAAO,mEACP,WAAY,QACf,CACjB,CACS,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,kBAAiB,CACzB,EAED,mBAAoB,CAChB,KAAK,sBAAsB,OAAO,KAAK,mBAAmB,EAAE,KAAME,GAAa,CAC3E,KAAK,aAAeA,CACpC,CAAa,CACJ,EAED,2BAA2BC,EAAQ,CAC/B,OAAK,MAAM,QAAQA,CAAM,EAIVA,EAAO,IAAKC,GACnB,KAAK,mBAAmBA,EAAa,KAAK,EACnC,KAAK,kCAAkCA,EAAa,KAAK,EAG7D,KAAK,IACR,wEAAwEA,EAAa,KAAK,EAC9G,CACa,EAEa,KAAK,IAAI,EAbZ,EAcd,EAED,mBAAmBC,EAAW,CAC1B,MAAMC,EAAoB,KAAK,qBAAqBD,CAAS,EAE7D,OAAO,KAAK,aAAa,KAAME,GACpBA,EAAmB,OAASD,CACtC,CACJ,EAED,qBAAqBD,EAAW,CAC5B,OAAOA,EAAU,QAAQ,iBAAkB,EAAE,CAChD,EAED,kCAAkCG,EAAc,CAC5C,MAAMC,EAAgB,KAAK,qBAAqBD,CAAY,EACtDE,EAAc,KAAK,qBAAqBD,CAAa,EAErDE,EAAgB,KAAK,iBAAiBD,EAAY,OAAO,KAAK,EAEpE,OAAIC,IAAkB,KACXF,EAGJE,CACV,EAED,qBAAqBF,EAAe,CAChC,OAAO,KAAK,aAAa,KAAMF,GACpBA,EAAmB,OAASE,CACtC,CACJ,EAED,SAASG,EAAgB,CACrB,KAAK,gBAAgB,OAAOA,EAAe,EAAE,CAChD,EAED,iBAAiBA,EAAgB,CAC7B,OAAK,KAAK,eAIHA,EAAe,KAAO,KAAK,eAAe,GAHtC,EAId,EAED,aAAa,CAAE,KAAAC,EAAM,MAAAC,GAAS,CAC1B,KAAK,KAAOD,EACZ,KAAK,MAAQC,CAChB,CACJ,CACL"}