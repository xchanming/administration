{"version":3,"file":"index-VzZ8_OJD.js","sources":["../../../app/administration/src/app/component/utils/sw-time-ago/sw-time-ago.html.twig","../../../app/administration/src/app/component/utils/sw-time-ago/index.ts"],"sourcesContent":["<span\n    v-tooltip=\"{\n        message: fullDatetime,\n        disabled: !isToday\n    }\"\n>{{ formattedRelativeTime }}</span>\n","import type { PropType } from 'vue';\nimport template from './sw-time-ago.html.twig';\n\nconst { Component } = Cicada;\n\n/**\n * @private\n * @package checkout\n * @description Render datetimes with relative values like \"13 minutes ago\" - works with dates in the past and future\n * @status ready\n * @example-type dynamic\n * @component-example\n * <sw-time-ago date=\"\"2021-08-25T11:08:48.940+00:00\"\"></sw-time-ago>\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nComponent.register('sw-time-ago', {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    props: {\n        date: {\n            type: [\n                Date,\n                String,\n            ] as PropType<Date | string>,\n            required: true,\n        },\n    },\n\n    data(): {\n        formattedRelativeTime: string | null;\n        interval: ReturnType<typeof setInterval> | null;\n        now: number;\n    } {\n        return {\n            formattedRelativeTime: null,\n            interval: null,\n            now: Date.now(),\n        };\n    },\n\n    computed: {\n        dateObject(): Date {\n            // when prop is string then convert it to date object\n            if (typeof this.date === 'string') {\n                return new Date(this.date);\n            }\n\n            return this.date;\n        },\n\n        dateFilter() {\n            return Cicada.Filter.getByName('date');\n        },\n\n        fullDatetime(): string {\n            return this.dateFilter(this.dateObject.toString());\n        },\n\n        lessThanOneMinute(): boolean {\n            const minute = 1000 * 60;\n            const minuteAgo = this.now - minute;\n\n            return this.dateObject.getTime() > minuteAgo;\n        },\n\n        lessThanOneHour(): boolean {\n            const hour = 1000 * 60 * 60;\n            const hourAgo = this.now - hour;\n\n            return this.dateObject.getTime() > hourAgo;\n        },\n\n        lessThanOneMinuteFromNow(): boolean {\n            const minute = 1000 * 60;\n            const minuteAfter = this.now + minute;\n\n            return this.dateObject.getTime() < minuteAfter;\n        },\n\n        lessThanOneHourFromNow(): boolean {\n            const hour = 1000 * 60 * 60;\n            const hourAfter = this.now + hour;\n\n            return this.dateObject.getTime() < hourAfter;\n        },\n\n        isToday(): boolean {\n            const today = new Date(Date.now());\n\n            return (\n                this.dateObject.getDate() === today.getDate() &&\n                this.dateObject.getMonth() === today.getMonth() &&\n                this.dateObject.getFullYear() === today.getFullYear()\n            );\n        },\n    },\n\n    mounted() {\n        this.formattedRelativeTime = this.formatRelativeTime();\n\n        // update the formatted date every 30 seconds\n        this.interval = setInterval(() => {\n            // we have to set a new date, as vue does not react to changes in the date object\n            // and does not invalidate the computed cache\n            // this would lead to a wrong time string, if the component is active for more than 1 minute e.g.\n            this.now = Date.now();\n            this.formattedRelativeTime = this.formatRelativeTime();\n        }, 30000);\n    },\n\n    beforeUnmount() {\n        if (this.interval) {\n            clearInterval(this.interval);\n        }\n    },\n\n    methods: {\n        formatRelativeTime(): string {\n            const diff = Date.now() - this.dateObject.getTime();\n\n            const secondsAgo = Math.round(diff / 1000);\n            const minutesAgo = Math.round(secondsAgo / 60);\n\n            if (diff >= 0) {\n                if (this.lessThanOneMinute) {\n                    return this.$tc('global.sw-time-ago.justNow');\n                }\n\n                if (this.lessThanOneHour) {\n                    return this.$tc('global.sw-time-ago.minutesAgo', minutesAgo, { minutesAgo });\n                }\n            } else {\n                if (this.lessThanOneMinuteFromNow) {\n                    return this.$tc('global.sw-time-ago.aboutNow');\n                }\n\n                if (this.lessThanOneHourFromNow) {\n                    const minutesFromNow = Math.abs(minutesAgo);\n                    return this.$tc('global.sw-time-ago.minutesFromNow', minutesFromNow, { minutesFromNow });\n                }\n            }\n\n            if (this.isToday) {\n                return this.dateFilter(this.dateObject.toString(), {\n                    year: undefined,\n                    month: undefined,\n                    day: undefined,\n                });\n            }\n\n            return this.dateFilter(this.dateObject.toString());\n        },\n    },\n});\n"],"names":["template","Component","minuteAgo","hourAgo","minuteAfter","hourAfter","today","diff","secondsAgo","minutesAgo","minutesFromNow"],"mappings":"AAAA,MAAeA,EAAA,sGCGT,CAAE,UAAAC,CAAc,EAAA,OAYtBA,EAAU,SAAS,cAAe,CAC9B,SAAAD,EAEA,aAAc,OAAO,aAErB,MAAO,CACH,KAAM,CACF,KAAM,CACF,KACA,MACJ,EACA,SAAU,EACd,CACJ,EAEA,MAIE,CACS,MAAA,CACH,sBAAuB,KACvB,SAAU,KACV,IAAK,KAAK,IAAI,CAAA,CAEtB,EAEA,SAAU,CACN,YAAmB,CAEX,OAAA,OAAO,KAAK,MAAS,SACd,IAAI,KAAK,KAAK,IAAI,EAGtB,KAAK,IAChB,EAEA,YAAa,CACF,OAAA,OAAO,OAAO,UAAU,MAAM,CACzC,EAEA,cAAuB,CACnB,OAAO,KAAK,WAAW,KAAK,WAAW,SAAU,CAAA,CACrD,EAEA,mBAA6B,CAEnB,MAAAE,EAAY,KAAK,IAAM,IAEtB,OAAA,KAAK,WAAW,QAAA,EAAYA,CACvC,EAEA,iBAA2B,CAEjB,MAAAC,EAAU,KAAK,IAAM,KAEpB,OAAA,KAAK,WAAW,QAAA,EAAYA,CACvC,EAEA,0BAAoC,CAE1B,MAAAC,EAAc,KAAK,IAAM,IAExB,OAAA,KAAK,WAAW,QAAA,EAAYA,CACvC,EAEA,wBAAkC,CAExB,MAAAC,EAAY,KAAK,IAAM,KAEtB,OAAA,KAAK,WAAW,QAAA,EAAYA,CACvC,EAEA,SAAmB,CACf,MAAMC,EAAQ,IAAI,KAAK,KAAK,IAAK,CAAA,EAEjC,OACI,KAAK,WAAW,YAAcA,EAAM,WACpC,KAAK,WAAW,SAAe,IAAAA,EAAM,SACrC,GAAA,KAAK,WAAW,gBAAkBA,EAAM,aAEhD,CACJ,EAEA,SAAU,CACD,KAAA,sBAAwB,KAAK,qBAG7B,KAAA,SAAW,YAAY,IAAM,CAIzB,KAAA,IAAM,KAAK,MACX,KAAA,sBAAwB,KAAK,sBACnC,GAAK,CACZ,EAEA,eAAgB,CACR,KAAK,UACL,cAAc,KAAK,QAAQ,CAEnC,EAEA,QAAS,CACL,oBAA6B,CACzB,MAAMC,EAAO,KAAK,IAAA,EAAQ,KAAK,WAAW,UAEpCC,EAAa,KAAK,MAAMD,EAAO,GAAI,EACnCE,EAAa,KAAK,MAAMD,EAAa,EAAE,EAE7C,GAAID,GAAQ,EAAG,CACX,GAAI,KAAK,kBACE,OAAA,KAAK,IAAI,4BAA4B,EAGhD,GAAI,KAAK,gBACL,OAAO,KAAK,IAAI,gCAAiCE,EAAY,CAAE,WAAAA,EAAY,CAC/E,KACG,CACH,GAAI,KAAK,yBACE,OAAA,KAAK,IAAI,6BAA6B,EAGjD,GAAI,KAAK,uBAAwB,CACvB,MAAAC,EAAiB,KAAK,IAAID,CAAU,EAC1C,OAAO,KAAK,IAAI,oCAAqCC,EAAgB,CAAE,eAAAA,EAAgB,CAC3F,CACJ,CAEA,OAAI,KAAK,QACE,KAAK,WAAW,KAAK,WAAW,WAAY,CAC/C,KAAM,OACN,MAAO,OACP,IAAK,MAAA,CACR,EAGE,KAAK,WAAW,KAAK,WAAW,SAAU,CAAA,CACrD,CACJ,CACJ,CAAC"}