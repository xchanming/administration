{"version":3,"file":"index-DxWvKgPd.js","sources":["../../../app/administration/src/module/sw-first-run-wizard/view/sw-first-run-wizard-store/sw-first-run-wizard-store.html.twig","../../../app/administration/src/module/sw-first-run-wizard/view/sw-first-run-wizard-store/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_first_run_wizard_store %}\n<div class=\"sw-first-run-wizard-store\">\n    <template v-if=\"loadStatus\">\n        <sw-loader />\n\n        <p class=\"message\">\n            {{ $tc('sw-first-run-wizard.store.loadStatusCollect') }}\n            <br>\n            {{ $tc('sw-first-run-wizard.store.takeMinutes') }}\n        </p>\n    </template>\n\n    <template v-else-if=\"extensionStatus && extensionStatus.active\">\n        <sw-label\n            class=\"sw-first-run-wizard-store__label\"\n            appearance=\"pill\"\n            variant=\"success\"\n        >\n            <sw-icon\n                name=\"regular-check-circle\"\n                size=\"30px\"\n            />\n        </sw-label>\n\n        <h2>\n            {{ $tc('sw-first-run-wizard.store.alreadyActivated') }}\n        </h2>\n    </template>\n\n    <template v-else-if=\"isActivating\">\n        <sw-loader />\n\n        <p class=\"message\">\n            {{ $tc('sw-first-run-wizard.store.enablingStore') }}\n            <br>\n            {{ $tc('sw-first-run-wizard.store.takeMinutes') }}\n        </p>\n    </template>\n\n    <template v-else-if=\"activationError\">\n        <sw-label\n            class=\"sw-first-run-wizard-store__label\"\n            appearance=\"pill\"\n            variant=\"danger\"\n        >\n            <sw-icon\n                name=\"regular-times-circle\"\n                size=\"30px\"\n            />\n        </sw-label>\n\n        <h2>\n            {{ error && error.title || $tc('sw-first-run-wizard.store.activationErrorTitle') }}\n        </h2>\n        <p>\n            {{ error && error.detail || $tc('sw-first-run-wizard.store.activationErrorDescription') }}\n        </p>\n    </template>\n\n    <template v-else>\n        <img\n            :src=\"assetFilter('/administration/static/img/extension-store/store_illustration.svg')\"\n            alt=\"\"\n        >\n\n        <h2 class=\"sw-first-run-wizard-store__heading\">\n            {{ $tc('sw-first-run-wizard.store.headingOne') }}\n            <br>\n            {{ $tc('sw-first-run-wizard.store.headingTwo') }}\n        </h2>\n\n        <p>\n            {{ $tc('sw-first-run-wizard.store.description') }}\n        </p>\n    </template>\n</div>\n{% endblock %}\n","import template from './sw-first-run-wizard-store.html.twig';\nimport './sw-first-run-wizard-store.scss';\n\n/**\n * @package checkout\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['extensionHelperService'],\n\n    emits: [\n        'frw-set-title',\n        'frw-redirect',\n        'extension-activated',\n        'buttons-update',\n    ],\n\n    data() {\n        return {\n            loadStatus: false,\n            isActivating: false,\n            activationError: null,\n            extensionStatus: null,\n            error: null,\n        };\n    },\n\n    computed: {\n        edition() {\n            const activeDomain = this.licenceDomains.find((domain) => domain.active);\n\n            if (!activeDomain) {\n                return '';\n            }\n\n            return activeDomain.edition;\n        },\n\n        buttonConfig() {\n            const backButton = {\n                key: 'back',\n                label: this.$tc('sw-first-run-wizard.general.buttonBack'),\n                position: 'left',\n                variant: null,\n                action: 'sw.first.run.wizard.index.cicada.account',\n                disabled: this.isActivating || this.loadStatus,\n            };\n\n            if (this.extensionStatus && this.extensionStatus.active) {\n                return [\n                    backButton,\n                    {\n                        key: 'next',\n                        label: this.$tc('sw-first-run-wizard.general.buttonNext'),\n                        position: 'right',\n                        variant: 'primary',\n                        action: 'sw.first.run.wizard.index.finish',\n                        disabled: false,\n                    },\n                ];\n            }\n\n            return [\n                backButton,\n                {\n                    key: 'skip',\n                    label: this.$tc('sw-first-run-wizard.general.buttonSkip'),\n                    position: 'right',\n                    variant: null,\n                    action: 'sw.first.run.wizard.index.finish',\n                    disabled: this.isActivating || this.loadStatus,\n                },\n                {\n                    key: 'activate',\n                    label: this.$tc('sw-first-run-wizard.general.buttonActivate'),\n                    position: 'right',\n                    variant: 'primary',\n                    action: this.activateStore.bind(this),\n                    disabled: this.isActivating || this.loadStatus,\n                },\n            ];\n        },\n\n        assetFilter() {\n            return Cicada.Filter.getByName('asset');\n        },\n    },\n\n    watch: {\n        buttonConfig: {\n            handler() {\n                this.updateButtons();\n            },\n            deep: true,\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.updateButtons();\n            this.setTitle();\n            this.updateExtensionStatus();\n        },\n\n        setTitle() {\n            this.$emit('frw-set-title', this.$tc('sw-first-run-wizard.store.modalTitle'));\n        },\n\n        async updateExtensionStatus() {\n            this.loadStatus = true;\n\n            try {\n                this.extensionStatus = await this.extensionHelperService.getStatusOfExtension('SwagExtensionStore');\n            } catch (error) {\n                Cicada.Utils.debug.error(error);\n            } finally {\n                this.loadStatus = false;\n            }\n        },\n\n        activateStore() {\n            this.isActivating = true;\n            this.activationError = null;\n\n            Promise.all([this.installExtensionStore()])\n                .then(() => {\n                    this.$emit('frw-redirect', 'sw.first.run.wizard.index.finish');\n                })\n                .catch((error) => {\n                    this.activationError = true;\n\n                    if (\n                        error?.response?.data &&\n                        Array.isArray(error.response.data.errors) &&\n                        error.response.data.errors[0]\n                    ) {\n                        this.error = error.response.data.errors[0];\n                    }\n\n                    Cicada.Utils.debug.error(error);\n                })\n                .finally(() => {\n                    this.isActivating = false;\n                });\n        },\n\n        async installExtensionStore() {\n            const response = await this.extensionHelperService.downloadAndActivateExtension('SwagExtensionStore');\n\n            this.$emit('extension-activated');\n\n            return response;\n        },\n\n        updateButtons() {\n            this.$emit('buttons-update', this.buttonConfig);\n        },\n    },\n};\n"],"names":["template","index","activeDomain","domain","backButton","error","_a","response"],"mappings":"AAAA,MAAeA,EAAA,igDCOAC,EAAA,CACX,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CAAC,wBAAwB,EAEjC,MAAO,CACH,gBACA,eACA,sBACA,gBACH,EAED,MAAO,CACH,MAAO,CACH,WAAY,GACZ,aAAc,GACd,gBAAiB,KACjB,gBAAiB,KACjB,MAAO,IACnB,CACK,EAED,SAAU,CACN,SAAU,CACN,MAAME,EAAe,KAAK,eAAe,KAAMC,GAAWA,EAAO,MAAM,EAEvE,OAAKD,EAIEA,EAAa,QAHT,EAId,EAED,cAAe,CACX,MAAME,EAAa,CACf,IAAK,OACL,MAAO,KAAK,IAAI,wCAAwC,EACxD,SAAU,OACV,QAAS,KACT,OAAQ,2CACR,SAAU,KAAK,cAAgB,KAAK,UACpD,EAEY,OAAI,KAAK,iBAAmB,KAAK,gBAAgB,OACtC,CACHA,EACA,CACI,IAAK,OACL,MAAO,KAAK,IAAI,wCAAwC,EACxD,SAAU,QACV,QAAS,UACT,OAAQ,mCACR,SAAU,EACb,CACrB,EAGmB,CACHA,EACA,CACI,IAAK,OACL,MAAO,KAAK,IAAI,wCAAwC,EACxD,SAAU,QACV,QAAS,KACT,OAAQ,mCACR,SAAU,KAAK,cAAgB,KAAK,UACvC,EACD,CACI,IAAK,WACL,MAAO,KAAK,IAAI,4CAA4C,EAC5D,SAAU,QACV,QAAS,UACT,OAAQ,KAAK,cAAc,KAAK,IAAI,EACpC,SAAU,KAAK,cAAgB,KAAK,UACvC,CACjB,CACS,EAED,aAAc,CACV,OAAO,OAAO,OAAO,UAAU,OAAO,CACzC,CACJ,EAED,MAAO,CACH,aAAc,CACV,SAAU,CACN,KAAK,cAAa,CACrB,EACD,KAAM,EACT,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,cAAa,EAClB,KAAK,SAAQ,EACb,KAAK,sBAAqB,CAC7B,EAED,UAAW,CACP,KAAK,MAAM,gBAAiB,KAAK,IAAI,sCAAsC,CAAC,CAC/E,EAED,MAAM,uBAAwB,CAC1B,KAAK,WAAa,GAElB,GAAI,CACA,KAAK,gBAAkB,MAAM,KAAK,uBAAuB,qBAAqB,oBAAoB,CACrG,OAAQC,EAAO,CACZ,OAAO,MAAM,MAAM,MAAMA,CAAK,CAC9C,QAAsB,CACN,KAAK,WAAa,EACrB,CACJ,EAED,eAAgB,CACZ,KAAK,aAAe,GACpB,KAAK,gBAAkB,KAEvB,QAAQ,IAAI,CAAC,KAAK,sBAAuB,CAAA,CAAC,EACrC,KAAK,IAAM,CACR,KAAK,MAAM,eAAgB,kCAAkC,CACjF,CAAiB,EACA,MAAOA,GAAU,CDxIlC,IAAAC,ECyIoB,KAAK,gBAAkB,IAGnBA,EAAAD,GAAA,YAAAA,EAAO,WAAP,MAAAC,EAAiB,MACjB,MAAM,QAAQD,EAAM,SAAS,KAAK,MAAM,GACxCA,EAAM,SAAS,KAAK,OAAO,CAAC,IAE5B,KAAK,MAAQA,EAAM,SAAS,KAAK,OAAO,CAAC,GAG7C,OAAO,MAAM,MAAM,MAAMA,CAAK,CAClD,CAAiB,EACA,QAAQ,IAAM,CACX,KAAK,aAAe,EACxC,CAAiB,CACR,EAED,MAAM,uBAAwB,CAC1B,MAAME,EAAW,MAAM,KAAK,uBAAuB,6BAA6B,oBAAoB,EAEpG,YAAK,MAAM,qBAAqB,EAEzBA,CACV,EAED,eAAgB,CACZ,KAAK,MAAM,iBAAkB,KAAK,YAAY,CACjD,CACJ,CACL"}