{"version":3,"file":"index-B4YaVIC9.js","sources":["../../../app/administration/src/module/sw-promotion-v2/component/sw-promotion-v2-rule-select/sw-promotion-v2-rule-select.html.twig","../../../app/administration/src/module/sw-promotion-v2/component/sw-promotion-v2-rule-select/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_promotion_rule_select_v2 %}\n<div class=\"sw-promotion-v2-rule-select\">\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_rule_select_v2_selection %}\n    <sw-entity-many-to-many-select\n        v-bind=\"$attrs\"\n        ref=\"ruleSelect\"\n        class=\"sw-promotion-v2-rule-select\"\n        :entity-collection=\"collection\"\n        :local-mode=\"localMode\"\n        advanced-selection-component=\"sw-advanced-selection-rule\"\n        :advanced-selection-parameters=\"advanceSelectionParameters\"\n        v-on=\"listeners\"\n        @update:entity-collection=\"onChange\"\n    >\n\n        <template #before-item-list>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_promotion_rule_select_v2_selection_before_list %}\n            <li\n                class=\"sw-select-result sw-promotion-v2-rule-select__add-new-rule\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"showRuleModal = true\"\n                @keydown.enter=\"showRuleModal = true\"\n            >\n                {{ $tc('sw-promotion-v2.ruleSelect.labelAddNewRule') }}\n            </li>\n            {% endblock %}\n\n        </template>\n\n        <template\n            #result-item=\"{ item, index, labelProperty, valueProperty, searchTerm, highlightSearchTerm, isSelected, addItem, getKey }\"\n        >\n            <sw-select-result\n                v-tooltip=\"tooltipConfig(item)\"\n                :selected=\"isSelected(item)\"\n                :disabled=\"isRuleRestricted(item)\"\n                v-bind=\"{ item, index }\"\n                @item-select=\"addItem\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_entity_many_to_many_select_base_results_list_result_label %}\n                <slot\n                    name=\"result-label-property\"\n                    v-bind=\"{ item, index, labelProperty, valueProperty: 'id', searchTerm, highlightSearchTerm, getKey }\"\n                >\n                    <sw-highlight-text\n                        v-if=\"highlightSearchTerm\"\n                        :text=\"getKey(item,labelProperty) || getKey(item, `translated.${labelProperty}`)\"\n                        :search-term=\"searchTerm\"\n                    />\n                    <template v-else>\n                        {{ getKey(item,labelProperty) || getKey(item, `translated.${labelProperty}`) }}\n                    </template>\n                </slot>\n                {% endblock %}\n            </sw-select-result>\n        </template>\n    </sw-entity-many-to-many-select>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_promotion_rule_select_v2_create_modal %}\n    <sw-rule-modal\n        v-if=\"showRuleModal\"\n        class=\"sw-promotion-v2-rule-select__create-modal\"\n        :rule-aware-group-key=\"ruleAwareGroupKey\"\n        @save=\"onSaveRule\"\n        @modal-close=\"showRuleModal = false\"\n    />\n    {% endblock %}\n\n</div>\n{% endblock %}\n","import template from './sw-promotion-v2-rule-select.html.twig';\nimport './sw-promotion-v2-rule-select.scss';\n\n/**\n * @private\n * @package checkout\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'ruleConditionDataProviderService',\n        'feature',\n    ],\n\n    emits: ['update:collection'],\n\n    props: {\n        collection: {\n            type: Array,\n            required: false,\n            default: null,\n        },\n\n        ruleScope: {\n            type: Array,\n            required: false,\n            default() {\n                return [];\n            },\n        },\n\n        localMode: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default() {\n                return false;\n            },\n        },\n\n        ruleAwareGroupKey: {\n            type: String,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            showRuleModal: false,\n        };\n    },\n\n    computed: {\n        advanceSelectionParameters() {\n            return {\n                ruleAwareGroupKey: this.ruleAwareGroupKey,\n            };\n        },\n\n        listeners() {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-call,@typescript-eslint/no-unsafe-member-access\n            if (this.isCompatEnabled('INSTANCE_LISTENERS')) {\n                return this.$listeners;\n            }\n\n            return {};\n        },\n    },\n\n    methods: {\n        onChange(collection) {\n            this.$emit('update:collection', collection);\n        },\n\n        onSaveRule(ruleId) {\n            const ruleRepository = this.repositoryFactory.create(this.collection.entity, this.collection.source);\n\n            ruleRepository.assign(ruleId, this.collection.context).then(() => {\n                ruleRepository.search(this.collection.criteria, this.collection.context).then((searchResult) => {\n                    this.$emit('update:collection', searchResult);\n                    this.$refs.ruleSelect.sendSearchRequest();\n                });\n            });\n        },\n\n        tooltipConfig(rule) {\n            return this.ruleConditionDataProviderService.getRestrictedRuleTooltipConfig(\n                rule.conditions,\n                this.ruleAwareGroupKey,\n            );\n        },\n\n        isRuleRestricted(rule) {\n            return this.ruleConditionDataProviderService.isRuleRestricted(rule.conditions, this.ruleAwareGroupKey);\n        },\n    },\n};\n"],"names":["template","index","collection","ruleId","ruleRepository","searchResult","rule"],"mappings":"AAAA,MAAeA,EAAA,s7DCOAC,EAAA,CACX,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,mCACA,SACH,EAED,MAAO,CAAC,mBAAmB,EAE3B,MAAO,CACH,WAAY,CACR,KAAM,MACN,SAAU,GACV,QAAS,IACZ,EAED,UAAW,CACP,KAAM,MACN,SAAU,GACV,SAAU,CACN,MAAO,EACV,CACJ,EAED,UAAW,CACP,KAAM,QACN,SAAU,GAEV,SAAU,CACN,MAAO,EACV,CACJ,EAED,kBAAmB,CACf,KAAM,OACN,SAAU,GACV,QAAS,IACZ,CACJ,EAED,MAAO,CACH,MAAO,CACH,cAAe,EAC3B,CACK,EAED,SAAU,CACN,4BAA6B,CACzB,MAAO,CACH,kBAAmB,KAAK,iBACxC,CACS,EAED,WAAY,CAER,OAAI,KAAK,gBAAgB,oBAAoB,EAClC,KAAK,WAGT,EACV,CACJ,EAED,QAAS,CACL,SAASE,EAAY,CACjB,KAAK,MAAM,oBAAqBA,CAAU,CAC7C,EAED,WAAWC,EAAQ,CACf,MAAMC,EAAiB,KAAK,kBAAkB,OAAO,KAAK,WAAW,OAAQ,KAAK,WAAW,MAAM,EAEnGA,EAAe,OAAOD,EAAQ,KAAK,WAAW,OAAO,EAAE,KAAK,IAAM,CAC9DC,EAAe,OAAO,KAAK,WAAW,SAAU,KAAK,WAAW,OAAO,EAAE,KAAMC,GAAiB,CAC5F,KAAK,MAAM,oBAAqBA,CAAY,EAC5C,KAAK,MAAM,WAAW,mBAC1C,CAAiB,CACjB,CAAa,CACJ,EAED,cAAcC,EAAM,CAChB,OAAO,KAAK,iCAAiC,+BACzCA,EAAK,WACL,KAAK,iBACrB,CACS,EAED,iBAAiBA,EAAM,CACnB,OAAO,KAAK,iCAAiC,iBAAiBA,EAAK,WAAY,KAAK,iBAAiB,CACxG,CACJ,CACL"}