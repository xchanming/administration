{"version":3,"file":"index-CDj_1R_A.js","sources":["../../../app/administration/src/module/sw-users-permissions/components/sw-users-permissions-role-listing/sw-users-permissions-role-listing.html.twig","../../../app/administration/src/module/sw-users-permissions/components/sw-users-permissions-role-listing/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_users_permissions_role_listing %}\n<sw-card\n    class=\"sw-users-permissions-role-listing\"\n    position-identifier=\"sw-users-permissions-role-listing\"\n    :title=\"$tc('sw-users-permissions.roles.general.cardLabel')\"\n>\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_users_permissions_role_listing_toolbar %}\n    <div class=\"sw-users-permissions-role-listing__toolbar\">\n        <sw-container\n            columns=\"1fr minmax(100px, 200px)\"\n            gap=\"0 10px\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_toolbar_search_field %}\n            <sw-simple-search-field\n                v-model:value=\"term\"\n                size=\"small\"\n                variant=\"form\"\n                @search-term-change=\"onSearch\"\n            />\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_toolbar_add_role_button %}\n            <sw-button\n                :router-link=\"{ name: 'sw.users.permissions.role.detail' }\"\n                variant=\"ghost\"\n                size=\"small\"\n                :disabled=\"!acl.can('users_and_permissions.creator') || undefined\"\n                class=\"sw-users-permissions-role-listing__add-role-button\"\n            >\n                {{ $tc('sw-users-permissions.roles.general.labelCreateNewRole') }}\n            </sw-button>\n            {% endblock %}\n        </sw-container>\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_users_permissions_role_listing_verify_modal %}\n    <sw-verify-user-modal\n        v-if=\"confirmPasswordModal\"\n        @verified=\"deleteRole\"\n        @close=\"onCloseConfirmPasswordModal\"\n    />\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_users_permissions_role_listing_grid %}\n    <sw-data-grid\n        v-if=\"showListingResults\"\n        :data-source=\"roles\"\n        :columns=\"rolesColumns\"\n        identifier=\"roles-grid\"\n        :show-settings=\"true\"\n        :show-selection=\"false\"\n        :is-loading=\"isLoading\"\n        @column-sort=\"onSortColumn\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_users_permissions_role_listing_grid_actions %}\n        <template #actions=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_grid_actions_edit %}\n            <sw-context-menu-item\n                :router-link=\"{ name: 'sw.users.permissions.role.detail', params: { id: item.id } }\"\n                class=\"sw-users-permissions-role-listing__context-menu-edit\"\n                :disabled=\"!acl.can('users_and_permissions.editor') || undefined\"\n            >\n                {{ $tc('sw-users-permissions.roles.role-grid.contextMenuEdit') }}\n            </sw-context-menu-item>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_grid_actions_delete %}\n            <sw-context-menu-item\n                variant=\"danger\"\n                class=\"sw-users-permissions-role-listing__context-menu-delete\"\n                :disabled=\"!acl.can('users_and_permissions.deleter') || undefined\"\n                @click=\"onDelete(item)\"\n            >\n                {{ $tc('sw-users-permissions.roles.role-grid.contextMenuDelete') }}\n            </sw-context-menu-item>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_users_permissions_role_listing_grid_columns %}\n        <template #column-name=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_grid_columns_name %}\n            <router-link :to=\"{ name: 'sw.users.permissions.role.detail', params: { id: item.id } }\">\n                {{ item.name }}\n            </router-link>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_users_permissions_role_listing_grid_action_modals %}\n        <template #action-modals=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_grid_actions_modals_modal %}\n            <sw-modal\n                v-if=\"getItemToDelete(item)\"\n                :title=\"$tc('sw-users-permissions.roles.role-grid.titleModalDelete')\"\n                variant=\"small\"\n                @modal-close=\"onCloseDeleteModal\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_users_permissions_role_listing_grid_actions_modals_modal_delete_text %}\n                <p class=\"sw-users-permissions-role-listing__confirm-delete-text\">\n                    {{ $tc('sw-users-permissions.roles.role-grid.textModalDelete', 0, { name: item.name }) }}\n                </p>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_users_permissions_role_listing_grid_actions_modals_modal_footer %}\n                <template #modal-footer>\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_users_permissions_role_listing_grid_actions_modals_modal_close_delete %}\n                    <sw-button\n                        size=\"small\"\n                        @click=\"onCloseDeleteModal\"\n                    >\n                        {{ $tc('global.default.cancel') }}\n                    </sw-button>\n                    {% endblock %}\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_users_permissions_role_listing_grid_actions_modals_modal_confirm_delete %}\n                    <sw-button\n                        variant=\"danger\"\n                        size=\"small\"\n                        @click=\"onConfirmDelete(item)\"\n                    >\n                        {{ $tc('sw-users-permissions.roles.role-grid.labelButtonDelete') }}\n                    </sw-button>\n                    {% endblock %}\n                </template>\n                {% endblock %}\n            </sw-modal>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        <template #pagination>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_users_permissions_role_listing_grid_pagination %}\n            <sw-pagination\n                :page=\"page\"\n                :limit=\"limit\"\n                :total=\"total\"\n                :auto-hide=\"true\"\n                @page-change=\"onPageChange\"\n            />\n            {% endblock %}\n        </template>\n    </sw-data-grid>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_users_permissions_role_listing_empty_state %}\n    <sw-empty-state\n        v-else\n        :absolute=\"false\"\n        :title=\"$tc('sw-users-permissions.roles.role-grid.messageEmptyTitle')\"\n        :subline=\"$tc('sw-users-permissions.roles.role-grid.messageEmptySubline')\"\n    />\n    {% endblock %}\n\n</sw-card>\n{% endblock %}\n","/**\n * @package services-settings\n */\nimport template from './sw-users-permissions-role-listing.html.twig';\nimport './sw-users-permissions-role-listing.scss';\n\nconst { Data, Mixin } = Cicada;\nconst { Criteria } = Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    emits: ['get-list'],\n\n    mixins: [\n        Mixin.getByName('listing'),\n        Mixin.getByName('notification'),\n    ],\n\n    data() {\n        return {\n            roles: [],\n            isLoading: false,\n            itemToDelete: null,\n            confirmDelete: null,\n            disableRouteParams: true,\n            confirmPasswordModal: false,\n        };\n    },\n\n    computed: {\n        rolesColumns() {\n            return [\n                {\n                    property: 'name',\n                    label: this.$tc('sw-users-permissions.roles.role-grid.labelName'),\n                },\n                {\n                    property: 'description',\n                    label: this.$tc('sw-users-permissions.roles.role-grid.labelDescription'),\n                },\n            ];\n        },\n\n        roleRepository() {\n            return this.repositoryFactory.create('acl_role');\n        },\n\n        roleCriteria() {\n            const criteria = new Criteria(this.page, this.limit);\n            // Roles created by apps should not be visible and editable in the admin\n            criteria.addFilter(Criteria.equals('app.id', null));\n            criteria.addFilter(Criteria.equals('deletedAt', null));\n\n            if (this.term) {\n                criteria.setTerm(this.term);\n            }\n\n            if (this.sortBy) {\n                criteria.addSorting(Criteria.sort(this.sortBy, this.sortDirection || 'ASC'));\n            }\n\n            return criteria;\n        },\n\n        showListingResults() {\n            if (this.isLoading) {\n                return false;\n            }\n\n            return (this.roles && this.roles.length > 0) || (this.term && this.term.length <= 0);\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.$emit('get-list');\n        },\n\n        getList() {\n            this.isLoading = true;\n            this.roles = [];\n\n            return this.roleRepository\n                .search(this.roleCriteria)\n                .then((roles) => {\n                    this.total = roles.total;\n                    this.roles = roles;\n                })\n                .finally(() => {\n                    this.isLoading = false;\n                });\n        },\n\n        onSearch(searchTerm) {\n            this.term = searchTerm;\n\n            this.$emit('get-list');\n        },\n\n        getItemToDelete(item) {\n            if (!this.itemToDelete) {\n                return false;\n            }\n            return this.itemToDelete.id === item.id;\n        },\n\n        onDelete(role) {\n            this.itemToDelete = role;\n        },\n\n        onCloseDeleteModal() {\n            this.itemToDelete = null;\n        },\n\n        onConfirmDelete() {\n            this.confirmDelete = this.itemToDelete;\n\n            this.onCloseDeleteModal();\n\n            this.confirmPasswordModal = true;\n        },\n\n        deleteRole(context) {\n            this.confirmPasswordModal = false;\n            const role = this.confirmDelete;\n            this.confirmDelete = null;\n\n            this.roleRepository\n                .delete(role.id, context)\n                .then(() => {\n                    this.createNotificationSuccess({\n                        message: this.$tc('sw-users-permissions.roles.role-grid.notification.deleteSuccess.message', 0, {\n                            name: role.name,\n                        }),\n                    });\n\n                    this.$emit('get-list');\n                })\n                .catch(() => {\n                    this.createNotificationError({\n                        message: this.$tc('sw-users-permissions.roles.role-grid.notification.deleteError.message', 0, {\n                            name: role.name,\n                        }),\n                    });\n                });\n        },\n\n        onCloseConfirmPasswordModal() {\n            this.confirmPasswordModal = false;\n        },\n    },\n};\n"],"names":["template","Data","Mixin","Criteria","index","criteria","roles","searchTerm","item","role","context"],"mappings":"AAAA,MAAeA,EAAA,k2ICMT,CAAE,KAAAC,EAAM,MAAAC,CAAO,EAAG,OAClB,CAAE,SAAAC,CAAU,EAAGF,EAGNG,EAAA,CACX,SAAAJ,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,KACH,EAED,MAAO,CAAC,UAAU,EAElB,OAAQ,CACJE,EAAM,UAAU,SAAS,EACzBA,EAAM,UAAU,cAAc,CACjC,EAED,MAAO,CACH,MAAO,CACH,MAAO,CAAE,EACT,UAAW,GACX,aAAc,KACd,cAAe,KACf,mBAAoB,GACpB,qBAAsB,EAClC,CACK,EAED,SAAU,CACN,cAAe,CACX,MAAO,CACH,CACI,SAAU,OACV,MAAO,KAAK,IAAI,gDAAgD,CACnE,EACD,CACI,SAAU,cACV,MAAO,KAAK,IAAI,uDAAuD,CAC1E,CACjB,CACS,EAED,gBAAiB,CACb,OAAO,KAAK,kBAAkB,OAAO,UAAU,CAClD,EAED,cAAe,CACX,MAAMG,EAAW,IAAIF,EAAS,KAAK,KAAM,KAAK,KAAK,EAEnD,OAAAE,EAAS,UAAUF,EAAS,OAAO,SAAU,IAAI,CAAC,EAClDE,EAAS,UAAUF,EAAS,OAAO,YAAa,IAAI,CAAC,EAEjD,KAAK,MACLE,EAAS,QAAQ,KAAK,IAAI,EAG1B,KAAK,QACLA,EAAS,WAAWF,EAAS,KAAK,KAAK,OAAQ,KAAK,eAAiB,KAAK,CAAC,EAGxEE,CACV,EAED,oBAAqB,CACjB,OAAI,KAAK,UACE,GAGH,KAAK,OAAS,KAAK,MAAM,OAAS,GAAO,KAAK,MAAQ,KAAK,KAAK,QAAU,CACrF,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,MAAM,UAAU,CACxB,EAED,SAAU,CACN,YAAK,UAAY,GACjB,KAAK,MAAQ,GAEN,KAAK,eACP,OAAO,KAAK,YAAY,EACxB,KAAMC,GAAU,CACb,KAAK,MAAQA,EAAM,MACnB,KAAK,MAAQA,CACjC,CAAiB,EACA,QAAQ,IAAM,CACX,KAAK,UAAY,EACrC,CAAiB,CACR,EAED,SAASC,EAAY,CACjB,KAAK,KAAOA,EAEZ,KAAK,MAAM,UAAU,CACxB,EAED,gBAAgBC,EAAM,CAClB,OAAK,KAAK,aAGH,KAAK,aAAa,KAAOA,EAAK,GAF1B,EAGd,EAED,SAASC,EAAM,CACX,KAAK,aAAeA,CACvB,EAED,oBAAqB,CACjB,KAAK,aAAe,IACvB,EAED,iBAAkB,CACd,KAAK,cAAgB,KAAK,aAE1B,KAAK,mBAAkB,EAEvB,KAAK,qBAAuB,EAC/B,EAED,WAAWC,EAAS,CAChB,KAAK,qBAAuB,GAC5B,MAAMD,EAAO,KAAK,cAClB,KAAK,cAAgB,KAErB,KAAK,eACA,OAAOA,EAAK,GAAIC,CAAO,EACvB,KAAK,IAAM,CACR,KAAK,0BAA0B,CAC3B,QAAS,KAAK,IAAI,0EAA2E,EAAG,CAC5F,KAAMD,EAAK,IACvC,CAAyB,CACzB,CAAqB,EAED,KAAK,MAAM,UAAU,CACzC,CAAiB,EACA,MAAM,IAAM,CACT,KAAK,wBAAwB,CACzB,QAAS,KAAK,IAAI,wEAAyE,EAAG,CAC1F,KAAMA,EAAK,IACvC,CAAyB,CACzB,CAAqB,CACrB,CAAiB,CACR,EAED,6BAA8B,CAC1B,KAAK,qBAAuB,EAC/B,CACJ,CACL"}