const C=`{% block sw_desktop %} <div class="sw-desktop" :class="desktopClasses" > <div v-if="isStaging" class="sw-staging-bar" > {{ $tc('global.sw-desktop.stagingBarText') }} </div> {% block sw_desktop_sidebar %} <sw-admin-menu v-if="!noNavigation" /> {% endblock %} {% block sw_desktop_content %} <div class="sw-desktop__content"> {% block sw_desktop_content_view %} <sw-error-boundary> <router-view /> </sw-error-boundary> {% endblock %} </div> <sw-app-app-url-changed-modal v-if="urlDiff !== null" :url-diff="urlDiff" @modal-close="closeModal" /> {% endblock %} </div> {% endblock %}`,{Component:M}=Cicada,{hasOwnProperty:b}=Cicada.Utils.object;M.register("sw-desktop",{template:C,compatConfig:Cicada.compatConfig,inject:["feature","appUrlChangeService","userActivityApiService"],data(){return{noNavigation:!1,urlDiff:null}},computed:{desktopClasses(){return{"sw-desktop--no-nav":this.noNavigation,"sw-desktop--staging":this.isStaging}},currentUser(){return Cicada.State.get("session").currentUser},isStaging(){return Cicada.State.get("context").app.config.settings.enableStagingMode===!0}},watch:{$route(){this.checkRouteSettings()},"$route.name":{handler(e,n){n===void 0||e===n||this.onUpdateSearchFrequently()},immediate:!0}},created(){this.createdComponent()},methods:{createdComponent(){this.checkRouteSettings(),this.updateShowUrlChangedModal()},checkRouteSettings(){this.$route.meta&&b(this.$route.meta,"noNav")?this.noNavigation=this.$route.meta.noNav:this.noNavigation=!1},updateShowUrlChangedModal(){if(!Cicada.State.get("context").app.config.settings.appsRequireAppUrl){this.urlDiff=null;return}this.appUrlChangeService.getUrlDiff().then(e=>{this.urlDiff=e})},closeModal(){this.urlDiff=null},onUpdateSearchFrequently(){var a;const e=this.getModuleMetadata();if(!e||!((a=e==null?void 0:e.route)!=null&&a.name))return!1;const n={key:`${e.name}@${e.route.name}`,cluster:this.currentUser.id};return this.userActivityApiService.increment(n)},getModuleMetadata(){var h,p,g,f,m,v,k;const{$module:e}=this.$route.meta,n=(h=this.$route)==null?void 0:h.name;if(!e)return!1;const{name:a,icon:l,color:s,entity:o,routes:t,title:d}=e;if(!this.$te(d)||!(t!=null&&t.index))return!1;const u=this.getModuleMetadataWithSearchMatcher(e,n);if(u){const{components:r,children:w,meta:i,props:S,...c}=u.route;return{...u,route:c}}if(((p=t==null?void 0:t.index)==null?void 0:p.name)===n||(f=(g=t.index)==null?void 0:g.children)!=null&&f.some(r=>r.name===n)){const{components:r,children:w,meta:i,props:S,...c}=t.index;return{name:a,icon:l,color:s,title:d,entity:o,privilege:i==null?void 0:i.privilege,route:c}}if(((m=t==null?void 0:t.create)==null?void 0:m.name)===n||(k=(v=t.create)==null?void 0:v.children)!=null&&k.some(r=>r.name===n)){const{components:r,children:w,meta:i,props:S,...c}=t.create;return{name:a,icon:l,color:s,entity:o,privilege:i==null?void 0:i.privilege,route:c,action:!0}}return!1},getModuleMetadataWithSearchMatcher(e,n){if(typeof e.searchMatcher!="function")return!1;const{title:a}=e;return e.searchMatcher(new RegExp(`^${this.$tc(a).toLowerCase()}(.*)`),this.$tc(a,2),e).find(s=>{var o,t;return s.route.name===n||((t=(o=s.route)==null?void 0:o.children)==null?void 0:t.some(d=>d.name===n))})}}});
//# sourceMappingURL=index-6GTRJ3XM.js.map
