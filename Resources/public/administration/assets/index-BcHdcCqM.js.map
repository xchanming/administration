{"version":3,"file":"index-BcHdcCqM.js","sources":["../../../app/administration/src/module/sw-cms/component/sw-cms-create-wizard/sw-cms-create-wizard.html.twig","../../../app/administration/src/module/sw-cms/component/sw-cms-create-wizard/index.ts"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_cms_create_wizard %}\n<div class=\"sw-cms-create-wizard\">\n    <div class=\"sw-cms-create-wizard__inner\">\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_create_wizard_first_step %}\n        <div\n            v-if=\"step === 1\"\n            class=\"sw-cms-create-wizard__step-1\"\n        >\n            <h2 class=\"sw-cms-create-wizard__title\">\n                {{ $tc('sw-cms.createWizard.choosePageTypeTitle') }}\n            </h2>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_page_type %}\n            <div class=\"sw-cms-create-wizard__page-type-selection\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_cms_create_wizard_page_type_options %}\n                <div\n                    v-for=\"pageType in visiblePageTypes\"\n                    :key=\"pageType.name\"\n                    class=\"sw-cms-create-wizard__page-type\"\n                    :class=\"pageType.class\"\n                    role=\"button\"\n                    tabindex=\"0\"\n                    @click=\"onPageTypeSelect(pageType.name)\"\n                    @keyup.enter=\"onPageTypeSelect(pageType.name)\"\n                >\n                    <sw-icon\n                        :name=\"pageType.icon\"\n                        size=\"24\"\n                    />\n                    <p>{{ $tc(pageType.title) }}</p>\n                </div>\n                {% endblock %}\n            </div>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_first_step_abort %}\n            <router-link\n                class=\"sw-cms-create-wizard__back\"\n                :to=\"{ name: 'sw.cms.index' }\"\n            >\n                <sw-icon\n                    name=\"regular-times-s\"\n                    small\n                /> {{ $tc('global.default.cancel') }}\n            </router-link>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_first_step_helptext %}\n            <p class=\"sw-cms-create-wizard__step1-helptext\">\n                {{ $tc('sw-cms.createWizard.choosePageTypeHelpText') }}\n            </p>\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_create_wizard_second_step %}\n        <div\n            v-if=\"step === 2\"\n            class=\"sw-cms-create-wizard__step-2\"\n        >\n            <h2 class=\"sw-cms-create-wizard__title\">\n                {{ $tc('sw-cms.createWizard.chooseSectionTitle') }}\n            </h2>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_section %}\n            <div class=\"sw-cms-create-wizard__section-selection\">\n                <sw-cms-stage-section-selection @section-select=\"onSectionSelect\" />\n            </div>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_second_step_back %}\n            <div\n                class=\"sw-cms-create-wizard__back\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"goToStep('pageType')\"\n                @keydown.enter=\"goToStep('pageType')\"\n            >\n                <sw-icon\n                    name=\"regular-long-arrow-left\"\n                    small\n                /> {{ $tc('sw-cms.createWizard.stepBack') }}\n            </div>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_second_step_helptext %}\n            <p class=\"sw-cms-create-wizard__step2-helptext\">\n                {{ $tc('sw-cms.createWizard.chooseSectionHelpText') }}\n            </p>\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_create_wizard_third_step %}\n        <div\n            v-if=\"step === 3\"\n            class=\"sw-cms-create-wizard__step-3\"\n        >\n            <h2 class=\"sw-cms-create-wizard__title\">\n                {{ $tc('sw-cms.createWizard.chooseNameTitle') }}\n            </h2>\n\n            <div class=\"sw-cms-create-wizard__name-select\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_cms_create_wizard_page_preview %}\n                <div class=\"sw-cms-create-wizard__page-preview\">\n                    <div\n                        class=\"sw-cms-create-wizard__preview_image\"\n                        :style=\"pagePreviewStyle\"\n                    ></div>\n                    <div class=\"sw-cms-create-wizard__preview_info\">\n                        <sw-icon\n                            :name=\"currentPageType?.icon\"\n                            size=\"16\"\n                        />\n                        <p>{{ $tc((currentPageType?.title ?? \"\")) }}</p>\n                    </div>\n                </div>\n                {% endblock %}\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_cms_create_wizard_page_completion %}\n                <div class=\"sw-cms-create-wizard__page-completion\">\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_cms_create_wizard_page_name %}\n                    <sw-text-field\n                        v-model:value=\"page.name\"\n                        class=\"sw-cms-create-wizard__page-completion-name\"\n                        :label=\"$tc('sw-cms.detail.label.pageName')\"\n                        :placeholder=\"$tc('sw-cms.detail.label.pageNamePlaceholder')\"\n                        @keypress.enter=\"onCompletePageCreation\"\n                    />\n                    {% endblock %}\n\n                    <sw-single-select\n                        v-if=\"isCustomEntityType\"\n                        v-model:value=\"page.entity\"\n                        class=\"sw-cms-create-wizard__page-completion-custom-entity\"\n                        :label=\"$tc('sw-cms.detail.label.pageEntity')\"\n                        :placeholder=\"$tc('sw-cms.detail.label.pageEntityPlaceholder')\"\n                        :options=\"customEntities\"\n                        require\n                    />\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_cms_create_wizard_page_completion_buttons %}\n                    <div class=\"sw-cms-create-wizard__page-completion-buttons\">\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_cms_create_wizard_page_completion_save_button %}\n                        <sw-button\n                            variant=\"primary\"\n                            :disabled=\"!isCompletable\"\n                            @click=\"onCompletePageCreation\"\n                        >\n                            {{ $tc('sw-cms.createWizard.createLayout') }}\n                        </sw-button>\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n                </div>\n                {% endblock %}\n            </div>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_create_wizard_third_step_back %}\n            <div\n                class=\"sw-cms-create-wizard__back\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"goToStep('sectionType')\"\n                @keydown.enter=\"goToStep('sectionType')\"\n            >\n                <sw-icon\n                    name=\"regular-long-arrow-left\"\n                    small\n                /> {{ $tc('sw-cms.createWizard.stepBack') }}\n            </div>\n            {% endblock %}\n        </div>\n        {% endblock %}\n    </div>\n</div>\n{% endblock %}\n","import { type PropType } from 'vue';\nimport template from './sw-cms-create-wizard.html.twig';\nimport './sw-cms-create-wizard.scss';\n\nconst { Filter } = Cicada;\n\n/**\n * @package discovery\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default Cicada.Component.wrapComponentConfig({\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'feature',\n        'cmsPageTypeService',\n        'customEntityDefinitionService',\n    ],\n\n    emits: [\n        'on-section-select',\n        'wizard-complete',\n    ],\n\n    props: {\n        page: {\n            type: Object as PropType<EntitySchema.Entity<'cms_page'>>,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            step: 1,\n            steps: {\n                pageType: 1,\n                sectionType: 2,\n                pageName: 3,\n            },\n        } as {\n            step: number;\n            steps: {\n                pageType: number;\n                sectionType: number;\n                pageName: number;\n                [key: string]: number;\n            };\n        };\n    },\n\n    computed: {\n        visiblePageTypes() {\n            return this.cmsPageTypeService.getVisibleTypes();\n        },\n\n        currentPageType() {\n            return this.cmsPageTypeService.getType(this.page.type);\n        },\n\n        isCustomEntityType() {\n            return this.page.type.startsWith('custom_entity_');\n        },\n\n        isCompletable() {\n            return [\n                this.page.name,\n                !this.isCustomEntityType || this.page.entity,\n            ].every((condition) => condition);\n        },\n\n        customEntities() {\n            return this.customEntityDefinitionService.getCmsAwareDefinitions().map((entity) => {\n                const snippetKey = `${entity.entity}.moduleTitle`;\n                const value = entity.entity;\n\n                return {\n                    value,\n                    label: this.$te(snippetKey) ? this.$tc(snippetKey) : value,\n                };\n            });\n        },\n\n        pagePreviewMedia() {\n            const sections = this.page.sections ?? [];\n            if (sections.length < 1) {\n                return '';\n            }\n\n            const imgPath = 'administration/static/img/cms';\n\n            return `url(${this.assetFilter(`${imgPath}/preview_${this.page.type}_${sections[0].type}.png`)})`;\n        },\n\n        pagePreviewStyle() {\n            return {\n                'background-image': this.pagePreviewMedia,\n                'background-size': 'cover',\n            };\n        },\n\n        assetFilter() {\n            return Filter.getByName('asset');\n        },\n\n        cmsPageStore() {\n            return Cicada.Store.get('cmsPage');\n        },\n    },\n\n    watch: {\n        step(newStep: number) {\n            if (this.getStepName(newStep) === 'sectionType') {\n                this.page.sections = new Cicada.Data.EntityCollection(\n                    `/cms-page/${this.page.id}/sections`,\n                    'cms_section',\n                    Cicada.Context.api,\n                );\n            }\n        },\n    },\n\n    methods: {\n        goToStep(stepName: string) {\n            this.step = this.steps[stepName];\n        },\n\n        getStepName(stepValue: number) {\n            const find = Object.entries(this.steps).find((step) => {\n                return stepValue === step[1];\n            });\n\n            if (!find) {\n                return '';\n            }\n\n            return find[0];\n        },\n\n        onPageTypeSelect(type: string) {\n            this.cmsPageStore.setCurrentPageType(type);\n\n            this.page.type = type;\n\n            this.goToStep('sectionType');\n        },\n\n        onSectionSelect(section: EntitySchema.Entity<'cms_section'>) {\n            this.goToStep('pageName');\n\n            this.$emit('on-section-select', section);\n        },\n\n        onCompletePageCreation() {\n            if (!this.page.name) {\n                return;\n            }\n\n            this.$emit('wizard-complete');\n        },\n    },\n});\n"],"names":["template","Filter","index","condition","entity","snippetKey","value","sections","newStep","stepName","stepValue","find","step","type","section"],"mappings":"AAAA,MAAeA,EAAA,wmICIT,CAAE,OAAAC,CAAW,EAAA,OAMnBC,EAAe,OAAO,UAAU,oBAAoB,CAChD,SAAAF,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,UACA,qBACA,+BACJ,EAEA,MAAO,CACH,oBACA,iBACJ,EAEA,MAAO,CACH,KAAM,CACF,KAAM,OACN,SAAU,EACd,CACJ,EAEA,MAAO,CACI,MAAA,CACH,KAAM,EACN,MAAO,CACH,SAAU,EACV,YAAa,EACb,SAAU,CACd,CAAA,CAUR,EAEA,SAAU,CACN,kBAAmB,CACR,OAAA,KAAK,mBAAmB,iBACnC,EAEA,iBAAkB,CACd,OAAO,KAAK,mBAAmB,QAAQ,KAAK,KAAK,IAAI,CACzD,EAEA,oBAAqB,CACjB,OAAO,KAAK,KAAK,KAAK,WAAW,gBAAgB,CACrD,EAEA,eAAgB,CACL,MAAA,CACH,KAAK,KAAK,KACV,CAAC,KAAK,oBAAsB,KAAK,KAAK,MACxC,EAAA,MAAOG,GAAcA,CAAS,CACpC,EAEA,gBAAiB,CACb,OAAO,KAAK,8BAA8B,uBAAyB,EAAA,IAAKC,GAAW,CACzE,MAAAC,EAAa,GAAGD,EAAO,MAAM,eAC7BE,EAAQF,EAAO,OAEd,MAAA,CACH,MAAAE,EACA,MAAO,KAAK,IAAID,CAAU,EAAI,KAAK,IAAIA,CAAU,EAAIC,CAAA,CACzD,CACH,CACL,EAEA,kBAAmB,CACf,MAAMC,EAAW,KAAK,KAAK,UAAY,CAAA,EACnC,OAAAA,EAAS,OAAS,EACX,GAKJ,OAAO,KAAK,YAAY,yCAAsB,KAAK,KAAK,IAAI,IAAIA,EAAS,CAAC,EAAE,IAAI,MAAM,CAAC,GAClG,EAEA,kBAAmB,CACR,MAAA,CACH,mBAAoB,KAAK,iBACzB,kBAAmB,OAAA,CAE3B,EAEA,aAAc,CACH,OAAAN,EAAO,UAAU,OAAO,CACnC,EAEA,cAAe,CACJ,OAAA,OAAO,MAAM,IAAI,SAAS,CACrC,CACJ,EAEA,MAAO,CACH,KAAKO,EAAiB,CACd,KAAK,YAAYA,CAAO,IAAM,gBAC9B,KAAK,KAAK,SAAW,IAAI,OAAO,KAAK,iBACjC,aAAa,KAAK,KAAK,EAAE,YACzB,cACA,OAAO,QAAQ,GAAA,EAG3B,CACJ,EAEA,QAAS,CACL,SAASC,EAAkB,CAClB,KAAA,KAAO,KAAK,MAAMA,CAAQ,CACnC,EAEA,YAAYC,EAAmB,CACrB,MAAAC,EAAO,OAAO,QAAQ,KAAK,KAAK,EAAE,KAAMC,GACnCF,IAAcE,EAAK,CAAC,CAC9B,EAED,OAAKD,EAIEA,EAAK,CAAC,EAHF,EAIf,EAEA,iBAAiBE,EAAc,CACtB,KAAA,aAAa,mBAAmBA,CAAI,EAEzC,KAAK,KAAK,KAAOA,EAEjB,KAAK,SAAS,aAAa,CAC/B,EAEA,gBAAgBC,EAA6C,CACzD,KAAK,SAAS,UAAU,EAEnB,KAAA,MAAM,oBAAqBA,CAAO,CAC3C,EAEA,wBAAyB,CAChB,KAAK,KAAK,MAIf,KAAK,MAAM,iBAAiB,CAChC,CACJ,CACJ,CAAC"}