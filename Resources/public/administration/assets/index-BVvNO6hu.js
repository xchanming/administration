const i=`{% block sw_flow_app_action_modal %} <sw-modal class="sw-flow-app-action-modal" @modal-close="onClose" > <template #modal-header> {% block sw_flow_app_action_modal_header %} <div class="sw-flow-app-action-modal__header"> {{ actionLabel }} <span class="sw-flow-app-action-modal__app-badge"> {{ appBadge }} </span> </div> {% endblock %} </template> {% block sw_flow_app_action_modal_content %} {% block sw_flow_app_action_modal_headcontent %} <div v-if="headline || paragraph" class="sw-flow-app-action-modal__headcontent" > {% block sw_flow_app_action_modal_headline %} <div v-if="headline" class="sw-flow-app-action-modal__headline" > {{ headline }} </div> {% endblock %} {% block sw_flow_app_action_modal_paragraph %} <div v-if="paragraph" class="sw-flow-app-action-modal__paragraph" > {{ paragraph }} </div> {% endblock %} </div> {% endblock %} <sw-form-field-renderer v-for="field in fields" :key="field.name" v-model:value="config[field.name]" :type="field.type" :config="getConfig(field)" :error="errors[field.name]" @update:value="onChange($event, field)" /> {% endblock %} <template #modal-footer> {% block sw_flow_app_action_modal_footer_cancel_button %} <sw-button class="sw-flow-app-action-modal__cancel-button" size="small" @click="onClose" > {{ $tc('global.default.cancel') }} </sw-button> {% endblock %} {% block sw_flow_app_action_modal_footer_save_button %} <sw-button class="sw-flow-app-action-modal__save-button" variant="primary" size="small" @click="onSave" > {{ $tc('sw-flow.modals.buttonSaveAction') }} </sw-button> {% endblock %} </template> </sw-modal> {% endblock %}`,{Mixin:s,Classes:{CicadaError:l}}=Cicada,c={template:i,compatConfig:Cicada.compatConfig,inject:["acl"],emits:["process-finish","modal-close"],mixins:[s.getByName("placeholder"),s.getByName("notification")],props:{sequence:{type:Object,required:!0}},data(){return{config:{},fields:[],errors:{}}},computed:{actionLabel(){var e,t,o,a,n;return((o=(t=(e=this.sequence)==null?void 0:e.propsAppFlowAction)==null?void 0:t.translated)==null?void 0:o.label)||((n=(a=this.sequence)==null?void 0:a.propsAppFlowAction)==null?void 0:n.label)},appBadge(){var e,t,o;return(o=(t=(e=this.sequence)==null?void 0:e.propsAppFlowAction)==null?void 0:t.app)==null?void 0:o.label},currentLocale(){return Cicada.State.get("session").currentLocale},headline(){var e,t,o,a,n;return((o=(t=(e=this.sequence)==null?void 0:e.propsAppFlowAction)==null?void 0:t.translated)==null?void 0:o.headline)||((n=(a=this.sequence)==null?void 0:a.propsAppFlowAction)==null?void 0:n.headline)},paragraph(){var e,t,o,a,n;return((o=(t=(e=this.sequence)==null?void 0:e.propsAppFlowAction)==null?void 0:t.translated)==null?void 0:o.description)||((n=(a=this.sequence)==null?void 0:a.propsAppFlowAction)==null?void 0:n.description)}},created(){this.createdComponent()},methods:{createdComponent(){var e;this.getFields(),(e=this.sequence)!=null&&e.config&&Object.entries({...this.sequence.config}).forEach(([t,o])=>{this.config[t]=typeof o=="object"&&o.value!==void 0?o.value:o})},onChange(e,t){this.handleValid(t,e)},isValid(){return this.errors={},this.fields.forEach(e=>{const t=this.config[e.name]??null;this.handleValid(e,t)}),Object.keys(this.errors).length===0},handleValid(e,t){var a;let o=t;if(typeof o=="object"&&((o==null?void 0:o.length)===0||((a=o==null?void 0:o.value)==null?void 0:a.length)===0)&&(o=null),e.required&&!o&&typeof o!="boolean"){this.isCompatEnabled("INSTANCE_DELETE")?this.$delete(this.config,[e.name]):delete this.config[e.name],this.isCompatEnabled("INSTANCE_SET")?this.$set(this.errors,e.name,new l({code:"c1051bb4-d103-4f74-8988-acbcafc7fdc3"})):this.errors[e.name]=new l({code:"c1051bb4-d103-4f74-8988-acbcafc7fdc3"});return}this.isCompatEnabled("INSTANCE_DELETE")?this.$delete(this.errors,[e.name]):delete this.errors[e.name]},onSave(){var o,a,n;if(!this.isValid()||!((n=(a=(o=this.sequence)==null?void 0:o.propsAppFlowAction)==null?void 0:a.app)!=null&&n.active))return;const e=this.buildConfig(),t={...this.sequence,config:e};this.$emit("process-finish",t),this.onClose()},buildConfig(){const e={};return this.fields.forEach(t=>{var o;((o=this.config[t.name])==null?void 0:o.length)!==0&&this.config[t.name]!==null&&(e[t.name]=this.config[t.name])}),e},onClose(){this.$emit("modal-close")},getFields(){var e;(e=this.sequence.propsAppFlowAction)==null||e.config.forEach(t=>{this.config[t.name]=this.convertDefaultValue(t.type,t.defaultValue),this.fields.push(t),this.isCompatEnabled("INSTANCE_DELETE")?this.$delete(this.errors,t.name):delete this.errors[t.name]})},convertDefaultValue(e,t){return t===void 0?null:["int","float"].includes(e)?parseInt(t,10):["bool","checkbox"].includes(e)?!!t:["date","datetime","time"].includes(e)?null:t},getConfig(e){const t={label:e.label,placeholder:e.placeHolder,disabled:e.disabled,required:e.required,helpText:this.helpText(e)};return e.type==="colorpicker"?(t.componentName="sw-colorpicker",t.zIndex=1e3,t.colorOutput="hex",t):e.type==="text-editor"?(t.componentName="sw-text-editor",t):(["single-select","multi-select"].includes(e.type)&&(t.componentName=`sw-${e.type}`,t.options=e.options),t)},helpText(e){if(e.helpText===void 0)return null;const t=JSON.parse(JSON.stringify(e.helpText));return t[this.currentLocale]??t[Cicada.Context.app.fallbackLocale]??null}}};export{c as default};
//# sourceMappingURL=index-BVvNO6hu.js.map
