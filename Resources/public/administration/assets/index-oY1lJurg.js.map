{"version":3,"file":"index-oY1lJurg.js","sources":["../../../app/administration/src/app/component/entity/sw-entity-listing/sw-entity-listing.html.twig","../../../app/administration/src/app/component/entity/sw-entity-listing/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_slot_pagination %}\n<sw-pagination\n    v-bind=\"{ page, limit, total, steps }\"\n    :total-visible=\"7\"\n    @page-change=\"paginate\"\n/>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_bulk_selected_actions_content %}\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_bulk_edit_content %}\n<a\n    v-if=\"allowBulkEdit\"\n    class=\"link link-primary\"\n    role=\"button\"\n    tabindex=\"0\"\n    @click=\"onClickBulkEdit\"\n    @keydown.enter=\"onClickBulkEdit\"\n>\n    {{ $tc('global.sw-bulk-edit-modal.bulkEdit') }}\n</a>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_bulk_delete_content %}\n<a\n    v-if=\"allowDelete\"\n    class=\"link link-danger\"\n    role=\"button\"\n    tabindex=\"0\"\n    @click=\"showBulkDeleteModal = true\"\n    @keydown.enter=\"showBulkDeleteModal = true\"\n>\n    {{ $tc('global.default.delete') }}\n</a>\n{% endblock %}\n\n<slot\n    name=\"bulk-additional\"\n    v-bind=\"{ selectionCount }\"\n></slot>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_slot_bulk_modals %}\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_bulk_edit_modal %}\n<slot\n    name=\"bulk-edit-modal\"\n    v-bind=\"{ selection }\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_data_grid_slot_bulk_edit_modal %}\n    <sw-bulk-edit-modal\n        v-if=\"showBulkEditModal\"\n        :selection=\"selection\"\n        :bulk-grid-edit-columns=\"bulkGridEditColumns\"\n        @modal-close=\"onCloseBulkEditModal\"\n    />\n    {% endblock %}\n</slot>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_bulk_delete_modal %}\n<sw-modal\n    v-if=\"showBulkDeleteModal\"\n    class=\"sw-entity-listing__confirm-bulk-delete-modal\"\n    variant=\"small\"\n    :title=\"$tc('global.default.warning')\"\n    @modal-close=\"showBulkDeleteModal = false\"\n>\n    <p class=\"sw-data-grid__confirm-bulk-delete-text\">\n        <slot\n            name=\"bulk-modal-delete-confirm-text\"\n            v-bind=\"{ selectionCount }\"\n        >\n            {{ $tc('global.entity-components.deleteMessage', selectionCount, { count: selectionCount }) }}\n        </slot>\n    </p>\n\n    <template #modal-footer>\n        <slot name=\"bulk-modal-cancel\">\n            <sw-button\n                size=\"small\"\n                @click=\"showBulkDeleteModal = false\"\n            >\n                {{ $tc('global.default.cancel') }}\n            </sw-button>\n        </slot>\n\n        <slot\n            name=\"bulk-modal-delete-items\"\n            v-bind=\"{ isBulkLoading, deleteItems }\"\n        >\n            <sw-button\n                variant=\"danger\"\n                size=\"small\"\n                :is-loading=\"isBulkLoading\"\n                @click=\"deleteItems\"\n            >\n                {{ $tc('global.default.delete') }}\n            </sw-button>\n        </slot>\n    </template>\n</sw-modal>\n{% endblock %}\n\n<slot\n    name=\"bulk-modals-additional\"\n    v-bind=\"{ selection, ids: Object.keys(selection) }\"\n></slot>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_slot_actions %}\n<slot\n    name=\"detail-action\"\n    v-bind=\"{ item }\"\n>\n    <sw-context-menu-item\n        v-if=\"detailRoute\"\n        v-tooltip=\"{\n            message: $tc('sw-privileges.tooltip.warning'),\n            disabled: allowEdit || allowView,\n            showOnDisabledElements: true,\n            zIndex: 9050,\n        }\"\n        class=\"sw-entity-listing__context-menu-edit-action\"\n        :disabled=\"(!allowEdit && !allowView) || undefined\"\n        :router-link=\"{ name: detailRoute, params: { id: item.id } }\"\n    >\n        {{ detailPageLinkText }}\n    </sw-context-menu-item>\n</slot>\n\n<slot\n    name=\"more-actions\"\n    v-bind=\"{ item }\"\n></slot>\n\n<slot\n    name=\"delete-action\"\n    v-bind=\"{ item, showDelete, allowDelete }\"\n>\n    <sw-context-menu-item\n        v-tooltip.bottom=\"{\n            message: $tc('sw-privileges.tooltip.warning'),\n            disabled: allowDelete,\n            showOnDisabledElements: true,\n            zIndex: 9050,\n        }\"\n        :disabled=\"!allowDelete || undefined\"\n        class=\"sw-entity-listing__context-menu-edit-delete\"\n        variant=\"danger\"\n        @click=\"showDelete(item.id)\"\n    >\n        {{ $tc('global.default.delete') }}\n    </sw-context-menu-item>\n</slot>\n{% endblock %}\n\n<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_data_grid_slot_action_modals %}\n<sw-modal\n    v-if=\"deleteId === item.id\"\n    :title=\"$tc('global.default.warning')\"\n    variant=\"small\"\n    @modal-close=\"closeModal\"\n>\n    <p class=\"sw-listing__confirm-delete-text\">\n        <slot\n            name=\"delete-confirm-text\"\n            v-bind=\"{ item }\"\n        >\n            {{ $tc('global.entity-components.deleteMessage') }}\n        </slot>\n    </p>\n\n    <template #modal-footer>\n        <slot\n            name=\"delete-modal-footer\"\n            v-bind=\"{ item }\"\n        >\n            <slot\n                name=\"delete-modal-cancel\"\n                v-bind=\"{ item }\"\n            >\n                <sw-button\n                    size=\"small\"\n                    @click=\"closeModal\"\n                >\n                    {{ $tc('global.default.cancel') }}\n                </sw-button>\n            </slot>\n\n            <slot\n                name=\"delete-modal-delete-item\"\n                v-bind=\"{ item }\"\n            >\n                <sw-button\n                    variant=\"danger\"\n                    size=\"small\"\n                    @click=\"deleteItem(item.id)\"\n                >\n                    {{ $tc('global.default.delete') }}\n                </sw-button>\n            </slot>\n        </slot>\n    </template>\n</sw-modal>\n{% endblock %}\n","/**\n * @package admin\n */\n\nimport template from './sw-entity-listing.html.twig';\n\nconst { Component } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @private\n */\nComponent.extend('sw-entity-listing', 'sw-data-grid', {\n    template,\n\n    inject: ['feature'],\n\n    emits: [\n        'update-records',\n        'delete-item-finish',\n        'delete-item-failed',\n        'delete-items-failed',\n        'items-delete-finish',\n        'inline-edit-save',\n        'inline-edit-cancel',\n        'column-sort',\n        'page-change',\n        'bulk-edit-modal-open',\n        'bulk-edit-modal-close',\n    ],\n\n    props: {\n        detailRoute: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        repository: {\n            type: Object,\n            required: true,\n        },\n\n        items: {\n            type: Array,\n            required: false,\n            default: null,\n        },\n\n        // eslint-disable-next-line vue/require-default-prop\n        dataSource: {\n            type: [\n                Array,\n                Object,\n            ],\n            required: false,\n        },\n\n        showSettings: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        steps: {\n            type: Array,\n            required: false,\n            default() {\n                return [\n                    10,\n                    25,\n                    50,\n                    75,\n                    100,\n                ];\n            },\n        },\n\n        fullPage: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        allowInlineEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        allowColumnEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        criteriaLimit: {\n            type: Number,\n            required: false,\n            default: 25,\n        },\n\n        allowEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        allowView: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        allowDelete: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n\n        disableDataFetching: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        naturalSorting: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        allowBulkEdit: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        showBulkEditModal: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        bulkGridEditColumns: {\n            type: Array,\n            required: false,\n            default() {\n                return [];\n            },\n        },\n\n        maximumSelectItems: {\n            type: Number,\n            required: false,\n            default: 1000,\n        },\n    },\n\n    data() {\n        return {\n            deleteId: null,\n            showBulkDeleteModal: false,\n            isBulkLoading: false,\n            page: 1,\n            limit: this.criteriaLimit,\n            total: 10,\n            lastSortedColumn: null,\n        };\n    },\n    computed: {\n        detailPageLinkText() {\n            if (!this.allowEdit && this.allowView) {\n                return this.$tc('global.default.view');\n            }\n\n            return this.$tc('global.default.edit');\n        },\n    },\n\n    watch: {\n        items() {\n            this.applyResult(this.items);\n        },\n    },\n\n    methods: {\n        createdComponent() {\n            this.$super('createdComponent');\n\n            if (this.items) {\n                this.applyResult(this.items);\n            }\n        },\n\n        applyResult(result) {\n            this.records = result;\n            const { total, criteria } = result;\n            this.total = total;\n            this.page = criteria.page || 1;\n            this.limit = criteria.limit || this.criteriaLimit;\n            this.loading = false;\n\n            if (criteria?.sortings?.[0]?.field) {\n                this.currentSortBy = criteria.sortings[0].field;\n            }\n\n            this.$emit('update-records', result);\n        },\n\n        deleteItem(id) {\n            this.deleteId = null;\n\n            // send delete request to the server, immediately\n            return this.repository\n                .delete(id, this.items.context)\n                .then(() => {\n                    this.resetSelection();\n                    this.$emit('delete-item-finish', id);\n                    return this.doSearch();\n                })\n                .catch((errorResponse) => {\n                    this.$emit('delete-item-failed', { id, errorResponse });\n                });\n        },\n\n        deleteItems() {\n            this.isBulkLoading = true;\n\n            let selectedIds = null;\n\n            selectedIds = Object.keys(this.selection);\n\n            return this.repository\n                .syncDeleted(selectedIds, this.items.context)\n                .then(() => {\n                    return this.deleteItemsFinish();\n                })\n                .catch((errorResponse) => {\n                    this.$emit('delete-items-failed', {\n                        selectedIds,\n                        errorResponse,\n                    });\n                    return this.deleteItemsFinish();\n                });\n        },\n\n        deleteItemsFinish() {\n            this.resetSelection();\n            this.isBulkLoading = false;\n            this.showBulkDeleteModal = false;\n            this.$emit('items-delete-finish');\n\n            return this.doSearch();\n        },\n\n        doSearch() {\n            this.loading = true;\n            return this.repository.search(this.items.criteria, this.items.context).then(this.applyResult);\n        },\n\n        save(record) {\n            // send save request to the server, immediately\n            const promise = this.repository.save(record, this.items.context).then(() => {\n                return this.doSearch();\n            });\n            this.$emit('inline-edit-save', promise, record);\n\n            return promise;\n        },\n\n        revert() {\n            // reloads the grid to revert all changes\n            const promise = this.doSearch();\n            this.$emit('inline-edit-cancel', promise);\n\n            return promise;\n        },\n\n        sort(column) {\n            this.lastSortedColumn = column;\n            this.items.criteria.resetSorting();\n\n            let direction = 'ASC';\n            if (this.currentSortBy === this.lastSortedColumn.dataIndex) {\n                if (this.currentSortDirection === direction) {\n                    direction = 'DESC';\n                }\n            }\n\n            this.lastSortedColumn.dataIndex.split(',').forEach((field) => {\n                this.items.criteria.addSorting(Criteria.sort(field, direction, this.lastSortedColumn.naturalSorting));\n            });\n\n            this.currentSortBy = this.lastSortedColumn.dataIndex;\n            this.currentSortDirection = direction;\n            this.currentNaturalSorting = this.lastSortedColumn.naturalSorting;\n\n            this.$emit('column-sort', this.lastSortedColumn, this.currentSortDirection);\n\n            if (this.lastSortedColumn.useCustomSort) {\n                return false;\n            }\n\n            if (this.disableDataFetching) {\n                return false;\n            }\n\n            return this.doSearch();\n        },\n\n        paginate({ page = 1, limit = 25 }) {\n            this.items.criteria.setPage(page);\n            this.items.criteria.setLimit(limit);\n\n            this.$emit('page-change', { page, limit });\n\n            if (this.lastSortedColumn && this.lastSortedColumn.useCustomSort) {\n                return false;\n            }\n\n            if (this.disableDataFetching) {\n                return false;\n            }\n\n            return this.doSearch();\n        },\n\n        showDelete(id) {\n            this.deleteId = id;\n        },\n\n        closeModal() {\n            this.deleteId = null;\n        },\n\n        onClickBulkEdit() {\n            this.$emit('bulk-edit-modal-open');\n        },\n\n        onCloseBulkEditModal() {\n            this.$emit('bulk-edit-modal-close');\n        },\n    },\n});\n"],"names":["template","Component","Criteria","result","_a","_b","total","criteria","id","errorResponse","selectedIds","record","promise","column","direction","field","page","limit"],"mappings":"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"}