{"version":3,"file":"index-DCPh_Ayx.js","sources":["../../../app/administration/src/module/sw-settings-listing/component/sw-settings-listing-default-sales-channel/sw-settings-listing-default-sales-channel.html.twig","../../../app/administration/src/module/sw-settings-listing/component/sw-settings-listing-default-sales-channel/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_listing_default_sales_channel %}\n<div class=\"sw-settings-listing-default-sales-channel\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_listing_default_sales_channel_loader %}\n    <sw-loader v-if=\"isLoading || isDefaultSalesChannelLoading\" />\n    {% endblock %}\n\n    <template v-else>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_listing_default_sales_channel_description %}\n        <p class=\"sw-settings-listing-default-sales-channel__description\">\n            {{ $tc('sw-settings-listing.index.defaultSalesChannel.description') }}\n        </p>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_listing_default_sales_channel_select %}\n        <sw-entity-multi-id-select\n            v-model:value=\"configData[null]['core.defaultSalesChannel.salesChannel']\"\n            :repository=\"salesChannelRepository\"\n            :label=\"$tc('sw-settings.system-config.labelSalesChannelSelect')\"\n            :placeholder=\"$tc('sw-product.visibility.placeholderVisibility')\"\n            @update:value=\"updateSalesChannel\"\n        />\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_listing_default_sales_channeld_setting %}\n        <div class=\"sw-settings-listing-default-sales-channel__options-container\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_listing_default_sales_channel_setting_active %}\n            <sw-switch-field\n                v-model:value=\"configData[null]['core.defaultSalesChannel.active']\"\n                class=\"sw-settings-listing-default-sales-channel__active-switch\"\n                :label=\"$tc('sw-product.settingsForm.labelActive')\"\n            />\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_listing_default_sales_channel_setting_visibility %}\n            <a\n                v-if=\"salesChannel.length > 0\"\n                class=\"sw-settings-listing-default-sales-channel__quick-link\"\n                role=\"button\"\n                tabindex=\"0\"\n                @click=\"displayAdvancedVisibility\"\n                @keydown.enter=\"displayAdvancedVisibility\"\n            >\n                {{ $tc('sw-settings-listing.index.defaultSalesChannel.linkAdvancedVisibility') }}\n                <sw-icon\n                    class=\"sw-settings-listing-default-sales-channel__link-icon\"\n                    name=\"regular-long-arrow-right\"\n                    small\n                />\n            </a>\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_listing_default_sales_channel_select_visibiliy_modal %}\n        <sw-modal\n            v-if=\"displayVisibilityDetail\"\n            variant=\"large\"\n            class=\"sw-settings-listing-default-sales-channel__visibility-modal\"\n            :title=\"$tc('sw-product.visibility.textHeadline')\"\n            @modal-close=\"closeAdvancedVisibility\"\n        >\n            <p>{{ $tc('sw-product.visibility.visibilityModalDescription') }}</p>\n\n            <sw-settings-listing-visibility-detail\n                ref=\"visibilityConfig\"\n                :config=\"visibilityConfig\"\n            />\n\n            <template #modal-footer>\n                <sw-button\n                    variant=\"primary\"\n                    size=\"small\"\n                    @click=\"closeAdvancedVisibility\"\n                >\n                    {{ $tc('global.default.apply') }}\n                </sw-button>\n            </template>\n        </sw-modal>\n        {% endblock %}\n    </template>\n</div>\n{% endblock %}\n","import template from './sw-settings-listing-default-sales-channel.html.twig';\nimport './sw-settings-listing-default-sales-channel.scss';\n\n/**\n * @package inventory\n */\n\nconst { EntityCollection } = Cicada.Data;\nconst { isEmpty } = Cicada.Utils.types;\nconst { cloneDeep } = Cicada.Utils.object;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'systemConfigApiService',\n    ],\n\n    props: {\n        isLoading: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default() {\n                return false;\n            },\n        },\n    },\n\n    data() {\n        return {\n            isDefaultSalesChannelLoading: false,\n            displayVisibilityDetail: false,\n            configData: {\n                null: {\n                    'core.defaultSalesChannel.active': true,\n                    'core.defaultSalesChannel.salesChannel': [],\n                    'core.defaultSalesChannel.visibility': {},\n                },\n            },\n            visibilityConfig: [],\n        };\n    },\n\n    computed: {\n        salesChannelRepository() {\n            return this.repositoryFactory.create('sales_channel');\n        },\n\n        salesChannel: {\n            get() {\n                return this.configData?.null?.['core.defaultSalesChannel.salesChannel'];\n            },\n            set(salesChannel) {\n                this.configData.null['core.defaultSalesChannel.salesChannel'] = salesChannel;\n            },\n        },\n    },\n\n    watch: {\n        salesChannel: {\n            handler() {\n                if (!this.salesChannel.length) {\n                    this.visibilityConfig = [];\n                    return;\n                }\n\n                const salesChannelIds = this.salesChannel.map((salesChannel) => salesChannel.id);\n                this.visibilityConfig = this.visibilityConfig.filter((entry) => salesChannelIds.includes(entry.id));\n\n                const configData = new Map();\n                this.visibilityConfig.forEach((entry) => configData.set(entry.id, { ...entry }));\n\n                this.salesChannel.forEach((salesChannel) => {\n                    configData.set(salesChannel, {\n                        id: salesChannel,\n                        visibility: this.configData.null?.['core.defaultSalesChannel.visibility'][salesChannel] || 30,\n                    });\n                });\n\n                this.visibilityConfig = [...configData.values()];\n            },\n            deep: true,\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchSalesChannelsSystemConfig();\n        },\n\n        fetchSalesChannelsSystemConfig() {\n            this.isDefaultSalesChannelLoading = true;\n\n            const salesChannelEntity = new EntityCollection(\n                this.salesChannelRepository.route,\n                this.salesChannelRepository.entityName,\n                Cicada.Context.api,\n            );\n\n            this.systemConfigApiService.getValues('core.defaultSalesChannel').then((configData) => {\n                this.isDefaultSalesChannelLoading = false;\n\n                if (!isEmpty(configData)) {\n                    this.configData.null = configData;\n                    this.salesChannel.forEach((salesChannel) => salesChannelEntity.add(salesChannel));\n                    this.salesChannel = salesChannelEntity;\n\n                    return;\n                }\n\n                this.salesChannel = salesChannelEntity;\n            });\n        },\n\n        displayAdvancedVisibility() {\n            this.displayVisibilityDetail = true;\n        },\n\n        closeAdvancedVisibility() {\n            this.displayVisibilityDetail = false;\n\n            this.visibilityConfig = cloneDeep(this.$refs.visibilityConfig.items);\n\n            this.configData.null['core.defaultSalesChannel.visibility'] = {};\n            this.visibilityConfig.forEach((entry) => {\n                this.configData.null['core.defaultSalesChannel.visibility'][entry.id] = entry.visibility;\n            });\n        },\n\n        saveSalesChannelVisibilityConfig() {\n            return this.systemConfigApiService.batchSave(this.configData);\n        },\n\n        updateSalesChannel(salesChannel) {\n            this.salesChannel = salesChannel;\n        },\n    },\n};\n"],"names":["template","EntityCollection","isEmpty","cloneDeep","index","_a","_b","salesChannel","salesChannelIds","entry","configData","salesChannelEntity"],"mappings":"AAAA,MAAeA,EAAA,47ECOT,CAAE,iBAAAC,CAAgB,EAAK,OAAO,KAC9B,CAAE,QAAAC,CAAS,EAAG,OAAO,MAAM,MAC3B,CAAE,UAAAC,CAAW,EAAG,OAAO,MAAM,OAGpBC,EAAA,CACX,SAAAJ,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,wBACH,EAED,MAAO,CACH,UAAW,CACP,KAAM,QACN,SAAU,GAEV,SAAU,CACN,MAAO,EACV,CACJ,CACJ,EAED,MAAO,CACH,MAAO,CACH,6BAA8B,GAC9B,wBAAyB,GACzB,WAAY,CACR,KAAM,CACF,kCAAmC,GACnC,wCAAyC,CAAE,EAC3C,sCAAuC,CAAE,CAC5C,CACJ,EACD,iBAAkB,CAAE,CAChC,CACK,EAED,SAAU,CACN,wBAAyB,CACrB,OAAO,KAAK,kBAAkB,OAAO,eAAe,CACvD,EAED,aAAc,CACV,KAAM,CDtDlB,IAAAK,EAAAC,ECuDgB,OAAOA,GAAAD,EAAA,KAAK,aAAL,YAAAA,EAAiB,OAAjB,YAAAC,EAAwB,wCAClC,EACD,IAAIC,EAAc,CACd,KAAK,WAAW,KAAK,uCAAuC,EAAIA,CACnE,CACJ,CACJ,EAED,MAAO,CACH,aAAc,CACV,SAAU,CACN,GAAI,CAAC,KAAK,aAAa,OAAQ,CAC3B,KAAK,iBAAmB,GACxB,MACH,CAED,MAAMC,EAAkB,KAAK,aAAa,IAAKD,GAAiBA,EAAa,EAAE,EAC/E,KAAK,iBAAmB,KAAK,iBAAiB,OAAQE,GAAUD,EAAgB,SAASC,EAAM,EAAE,CAAC,EAElG,MAAMC,EAAa,IAAI,IACvB,KAAK,iBAAiB,QAASD,GAAUC,EAAW,IAAID,EAAM,GAAI,CAAE,GAAGA,CAAK,CAAE,CAAC,EAE/E,KAAK,aAAa,QAASF,GAAiB,CD7E5D,IAAAF,EC8EoBK,EAAW,IAAIH,EAAc,CACzB,GAAIA,EACJ,aAAYF,EAAA,KAAK,WAAW,OAAhB,YAAAA,EAAuB,uCAAuCE,KAAiB,EACnH,CAAqB,CACrB,CAAiB,EAED,KAAK,iBAAmB,CAAC,GAAGG,EAAW,OAAQ,CAAA,CAClD,EACD,KAAM,EACT,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,+BAA8B,CACtC,EAED,gCAAiC,CAC7B,KAAK,6BAA+B,GAEpC,MAAMC,EAAqB,IAAIV,EAC3B,KAAK,uBAAuB,MAC5B,KAAK,uBAAuB,WAC5B,OAAO,QAAQ,GAC/B,EAEY,KAAK,uBAAuB,UAAU,0BAA0B,EAAE,KAAMS,GAAe,CAGnF,GAFA,KAAK,6BAA+B,GAEhC,CAACR,EAAQQ,CAAU,EAAG,CACtB,KAAK,WAAW,KAAOA,EACvB,KAAK,aAAa,QAASH,GAAiBI,EAAmB,IAAIJ,CAAY,CAAC,EAChF,KAAK,aAAeI,EAEpB,MACH,CAED,KAAK,aAAeA,CACpC,CAAa,CACJ,EAED,2BAA4B,CACxB,KAAK,wBAA0B,EAClC,EAED,yBAA0B,CACtB,KAAK,wBAA0B,GAE/B,KAAK,iBAAmBR,EAAU,KAAK,MAAM,iBAAiB,KAAK,EAEnE,KAAK,WAAW,KAAK,qCAAqC,EAAI,CAAA,EAC9D,KAAK,iBAAiB,QAASM,GAAU,CACrC,KAAK,WAAW,KAAK,qCAAqC,EAAEA,EAAM,EAAE,EAAIA,EAAM,UAC9F,CAAa,CACJ,EAED,kCAAmC,CAC/B,OAAO,KAAK,uBAAuB,UAAU,KAAK,UAAU,CAC/D,EAED,mBAAmBF,EAAc,CAC7B,KAAK,aAAeA,CACvB,CACJ,CACL"}