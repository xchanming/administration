{"version":3,"file":"index-ChWYW93r.js","sources":["../../../app/administration/src/module/sw-cms/component/sw-cms-product-assignment/sw-cms-product-assignment.html.twig","../../../app/administration/src/module/sw-cms/component/sw-cms-product-assignment/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_entity_many_to_many_assignment_card %}\n<div\n    class=\"sw-cms-product-assignment\"\n    v-bind=\"$attrs\"\n>\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_product_assignment_content %}\n    <div class=\"sw-cms-product-assignment__select-container\">\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_product_assignment_select %}\n        <slot name=\"select\">\n            <sw-select-base\n                v-bind=\"$attrs\"\n                ref=\"selectBase\"\n                class=\"sw-cms-product-assignment-select\"\n                :disabled=\"disabled\"\n                :label=\"selectLabel\"\n                :is-loading=\"isLoadingResults\"\n                @select-expanded=\"onSelectExpanded\"\n                @select-collapsed=\"onSelectCollapsed\"\n            >\n\n                <template #sw-select-selection=\"{ identification, error, disabled, size, expand, collapse }\">\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_cms_product_assignment_search_field %}\n                    <input\n                        ref=\"searchInput\"\n                        tabindex=\"-1\"\n                        :placeholder=\"placeholder\"\n                        :value=\"searchTerm\"\n                        :disabled=\"disabled\"\n                        @input=\"onSearchTermChange\"\n                    >\n                    {% endblock %}\n                </template>\n\n                <template #results-list>\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_cms_product_assignment_results_list %}\n                    <sw-select-result-list\n                        ref=\"swSelectResultList\"\n                        :options=\"resultCollection\"\n                        :is-loading=\"isLoadingResults\"\n                        :empty-message=\"$tc('global.sw-entity-many-to-many-select.messageNoResults', 0, { term: searchTerm })\"\n                        :focus-el=\"$refs.searchInput\"\n                        @paginate=\"paginateResult\"\n                        @item-select=\"onItemSelect\"\n                    >\n\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_cms_product_assignment_results_list_before %}\n                        <template #before-item-list>\n                            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                            {% block sw_cms_product_assignment_results_list_before_content %}\n                            <slot name=\"before-item-list\"></slot>\n                        {% endblock %}\n                        </template>\n                        {% endblock %}\n\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_cms_product_assignment_results_list_result %}\n                        <template #result-item=\"{ item, index }\">\n                            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                            {% block sw_cms_product_assignment_results_list_result_content %}\n                            <slot\n                                name=\"result-item\"\n                                v-bind=\"{ item, index, labelProperty, valueProperty: 'id', searchTerm, highlightSearchTerm, isSelected, onItemSelect, getKey }\"\n                            >\n\n                                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                {% block sw_cms_product_assignment_results_list_list_item %}\n                                <sw-select-result\n                                    :selected=\"isSelected(item)\"\n                                    v-bind=\"{ item, index }\"\n                                    @item-select=\"onItemSelect\"\n                                >\n\n                                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                                    {% block sw_cms_product_assignment_results_list_list_item_label %}\n                                    <slot\n                                        name=\"result-label-property\"\n                                        v-bind=\"{ item, index, labelProperty, valueProperty: 'id', searchTerm, highlightSearchTerm, getKey }\"\n                                    >\n\n                                        <sw-highlight-text\n                                            v-if=\"highlightSearchTerm\"\n                                            :text=\"getKey(item, `translated.${labelProperty}`)\"\n                                            :search-term=\"searchTerm\"\n                                        />\n\n                                        <template v-else>\n                                            {{ getKey(item, `translated.${labelProperty}`) }}\n                                        </template>\n                                    </slot>\n                                {% endblock %}\n                                </sw-select-result>\n                            {% endblock %}\n                            </slot>\n                        {% endblock %}\n                        </template>\n                        {% endblock %}\n\n                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                        {% block sw_cms_product_assignment_results_list_after %}\n                        <template #after-item-list>\n                            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                            {% block sw_cms_product_assignment_results_list_after_content %}\n                            <slot name=\"after-item-list\"></slot>\n                        {% endblock %}\n                        </template>\n                    {% endblock %}\n                    </sw-select-result-list>\n                    {% endblock %}\n                </template>\n            </sw-select-base>\n        </slot>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_cms_product_assignment_grid %}\n    <sw-data-grid\n        class=\"sw-cms-product-assignment__grid\"\n        :data-source=\"gridData\"\n        :is-loading=\"isLoadingGrid\"\n        :columns=\"columns\"\n        :v-bind=\"$attrs\"\n        :show-selection=\"false\"\n        :plain-appearance=\"true\"\n    >\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_product_assignment_grid_column %}\n        <template\n            v-for=\"column in columns\"\n            #[`column-${column.property}`]=\"columnProps\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_product_assignment_grid_column_content %}\n            <slot\n                :name=\"`column-${column.property}`\"\n                v-bind=\"{ ...columnProps, searchTerm, highlightSearchTerm }\"\n            ></slot>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_product_assignment_grid_column_actions %}\n        <template #actions=\"{ item }\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_product_assignment_grid_column_actions_content %}\n            <sw-context-menu-item\n                variant=\"danger\"\n                :disabled=\"disabled\"\n                @click=\"removeFromGrid(item)\"\n            >\n                {{ $tc('global.entity-components.labelRemoveAssociation') }}\n            </sw-context-menu-item>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_cms_product_assignment_grid_footer %}\n        <template #pagination>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_cms_product_assignment_grid_footer_content %}\n            <sw-pagination\n                v-if=\"total > 0\"\n                v-bind=\"{ limit, page, total }\"\n                :steps=\"steps\"\n                :auto-hide=\"false\"\n                @page-change=\"paginateGrid\"\n            />\n\n            <div\n                v-else\n                class=\"sw-cms-product-assignment__empty-state\"\n            >\n                <slot name=\"empty-state\"></slot>\n            </div>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-data-grid>\n    {% endblock %}\n</div>\n{% endblock %}\n","import template from './sw-cms-product-assignment.html.twig';\nimport './sw-cms-product-assignment.scss';\n\nconst { Criteria } = Cicada.Data;\n\n/**\n * @private\n * @package discovery\n */\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    emits: [\n        'change',\n        'paginate',\n    ],\n\n    data() {\n        return {\n            steps: [5],\n        };\n    },\n\n    computed: {\n        listeners() {\n            if (this.isCompatEnabled('INSTANCE_LISTENERS')) {\n                return this.$listeners;\n            }\n\n            return {};\n        },\n    },\n\n    watch: {\n        criteria: {\n            immediate: true,\n            handler() {\n                this.gridCriteria = Criteria.fromCriteria(this.criteria);\n                this.searchCriteria = Criteria.fromCriteria(this.criteria);\n\n                this.paginateGrid();\n            },\n        },\n\n        entityCollection() {\n            this.selectedIds = this.entityCollection.getIds();\n\n            this.paginateGrid();\n        },\n\n        languageId() {\n            this.paginateGrid();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.initData();\n        },\n\n        initData() {\n            this.page = 1;\n            this.selectedIds = this.entityCollection.getIds();\n        },\n\n        searchItems() {\n            return this.searchRepository.search(this.searchCriteria, this.context).then((result) => {\n                const criteria = new Criteria(1, this.searchCriteria.limit);\n                criteria.setIds(result.getIds());\n\n                return result;\n            });\n        },\n\n        onItemSelect(item) {\n            if (this.isSelected(item)) {\n                this.removeItem(item);\n                return;\n            }\n\n            this.entityCollection.add(item);\n\n            this.selectedIds = this.entityCollection.getIds();\n            this.gridData = this.entityCollection;\n\n            this.$emit('change', this.entityCollection);\n        },\n\n        removeItem(item) {\n            this.entityCollection.remove(item.id);\n\n            this.selectedIds = this.entityCollection.getIds();\n            this.gridData = this.entityCollection;\n            this.$emit('change', this.entityCollection);\n\n            return Promise.resolve();\n        },\n\n        onSelectCollapsed() {\n            this.resultCollection = null;\n            this.focusEl.blur();\n\n            this.paginateGrid();\n        },\n\n        paginateGrid({ page, limit } = this.gridCriteria) {\n            this.gridCriteria.page = page;\n            this.gridCriteria.limit = limit;\n            this.isLoadingGrid = true;\n            const currentPaginateCollection = this.entityCollection.slice((page - 1) * limit, (page - 1) * limit + limit);\n            this.gridData = currentPaginateCollection;\n            this.isLoadingGrid = false;\n            this.$emit('paginate', this.gridData);\n        },\n\n        removeFromGrid(item) {\n            this.removeItem(item).then(() => {\n                this.paginateGrid();\n            });\n        },\n    },\n};\n"],"names":["template","Criteria","index","result","item","page","limit","currentPaginateCollection"],"mappings":"AAAA,MAAeA,EAAA,0mICGT,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAMbC,EAAA,CACX,SAAAF,EAEA,aAAc,OAAO,aAErB,MAAO,CACH,SACA,UACH,EAED,MAAO,CACH,MAAO,CACH,MAAO,CAAC,CAAC,CACrB,CACK,EAED,SAAU,CACN,WAAY,CACR,OAAI,KAAK,gBAAgB,oBAAoB,EAClC,KAAK,WAGT,EACV,CACJ,EAED,MAAO,CACH,SAAU,CACN,UAAW,GACX,SAAU,CACN,KAAK,aAAeC,EAAS,aAAa,KAAK,QAAQ,EACvD,KAAK,eAAiBA,EAAS,aAAa,KAAK,QAAQ,EAEzD,KAAK,aAAY,CACpB,CACJ,EAED,kBAAmB,CACf,KAAK,YAAc,KAAK,iBAAiB,OAAM,EAE/C,KAAK,aAAY,CACpB,EAED,YAAa,CACT,KAAK,aAAY,CACpB,CACJ,EAED,SAAU,CACN,KAAK,iBAAgB,CACxB,EAED,QAAS,CACL,kBAAmB,CACf,KAAK,SAAQ,CAChB,EAED,UAAW,CACP,KAAK,KAAO,EACZ,KAAK,YAAc,KAAK,iBAAiB,OAAM,CAClD,EAED,aAAc,CACV,OAAO,KAAK,iBAAiB,OAAO,KAAK,eAAgB,KAAK,OAAO,EAAE,KAAME,IACxD,IAAIF,EAAS,EAAG,KAAK,eAAe,KAAK,EACjD,OAAOE,EAAO,OAAQ,CAAA,EAExBA,EACV,CACJ,EAED,aAAaC,EAAM,CACf,GAAI,KAAK,WAAWA,CAAI,EAAG,CACvB,KAAK,WAAWA,CAAI,EACpB,MACH,CAED,KAAK,iBAAiB,IAAIA,CAAI,EAE9B,KAAK,YAAc,KAAK,iBAAiB,OAAM,EAC/C,KAAK,SAAW,KAAK,iBAErB,KAAK,MAAM,SAAU,KAAK,gBAAgB,CAC7C,EAED,WAAWA,EAAM,CACb,YAAK,iBAAiB,OAAOA,EAAK,EAAE,EAEpC,KAAK,YAAc,KAAK,iBAAiB,OAAM,EAC/C,KAAK,SAAW,KAAK,iBACrB,KAAK,MAAM,SAAU,KAAK,gBAAgB,EAEnC,QAAQ,SAClB,EAED,mBAAoB,CAChB,KAAK,iBAAmB,KACxB,KAAK,QAAQ,OAEb,KAAK,aAAY,CACpB,EAED,aAAa,CAAE,KAAAC,EAAM,MAAAC,CAAK,EAAK,KAAK,aAAc,CAC9C,KAAK,aAAa,KAAOD,EACzB,KAAK,aAAa,MAAQC,EAC1B,KAAK,cAAgB,GACrB,MAAMC,EAA4B,KAAK,iBAAiB,OAAOF,EAAO,GAAKC,GAAQD,EAAO,GAAKC,EAAQA,CAAK,EAC5G,KAAK,SAAWC,EAChB,KAAK,cAAgB,GACrB,KAAK,MAAM,WAAY,KAAK,QAAQ,CACvC,EAED,eAAeH,EAAM,CACjB,KAAK,WAAWA,CAAI,EAAE,KAAK,IAAM,CAC7B,KAAK,aAAY,CACjC,CAAa,CACJ,CACJ,CACL"}