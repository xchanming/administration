{"version":3,"file":"index-BUGRojRK.js","sources":["../../../app/administration/src/module/sw-settings-logging/page/sw-settings-logging-list/sw-settings-logging-list.html.twig","../../../app/administration/src/module/sw-settings-logging/page/sw-settings-logging-list/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_list %}\n<sw-page class=\"sw-settings-logging-list\">\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_logging_list_search_bar %}\n    <template #search-bar>\n        <sw-search-bar\n            initial-search-type=\"Logs\"\n            :placeholder=\"$tc('sw-settings-logging.general.placeholderSearchBar')\"\n            :initial-search=\"term\"\n            @search=\"onSearch\"\n        />\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_logging_list_smart_bar_header %}\n    <template #smart-bar-header>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_logging_list_smart_bar_header_title %}\n        <h2>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_logging_list_smart_bar_header_title_text %}\n            {{ $tc('sw-settings.index.title') }}\n            <sw-icon\n                name=\"regular-chevron-right-xs\"\n                small\n            />\n            {{ $tc('sw-settings-logging.list.title') }}\n            {% endblock %}\n        </h2>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_logging_list_smart_bar_actions %}\n    <template #smart-bar-actions></template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_logging_list_content %}\n    <template #content>\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_logging_list_content_listing %}\n        <sw-entity-listing\n            :data-source=\"logs\"\n            :columns=\"logColumns\"\n            :full-page=\"true\"\n            :show-settings=\"true\"\n            :show-selection=\"undefined\"\n            :show-actions=\"true\"\n            :sort-by=\"sortBy\"\n            :sort-direction=\"sortDirection\"\n            :is-loading=\"isLoading\"\n            :allow-column-edit=\"true\"\n            :repository=\"logEntryRepository\"\n            identifier=\"sw-log-entry-list\"\n        >\n\n            <template\n                #column-createdAt=\"{ item }\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_settings_logging_list_column_created_at %}\n                {{ dateFilter(item.createdAt, { hour: '2-digit', minute: '2-digit' }) }}\n                {% endblock %}\n            </template>\n\n            <template\n                #column-level=\"{ item }\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_settings_logging_list_column_level %}\n                {{ logLevelToString(item.level) }} ({{ item.level }})\n                {% endblock %}\n            </template>\n\n            <template\n                #column-context=\"{ item }\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_settings_logging_list_column_context %}\n                <a\n                    role=\"button\"\n                    tabindex=\"0\"\n                    @click=\"showInfoModal(item)\"\n                    @keydown.enter=\"showInfoModal(item)\"\n                >\n                    {{ item.context }}\n                </a>\n                {% endblock %}\n            </template>\n\n            <template #pagination>\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_settings_logging_list_content_listing_pagination %}\n                <sw-pagination\n                    :page=\"page\"\n                    :limit=\"limit\"\n                    :total=\"total\"\n                    :total-visible=\"7\"\n                    @page-change=\"onPageChange\"\n                />\n                {% endblock %}\n            </template>\n\n            <template\n                #actions=\"{ item }\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_settings_logging_list_content_listing_actions %}\n                <sw-context-menu-item @click=\"showInfoModal(item)\">\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_settings_logging_list_content_listing_action_show_label %}\n                    {{ $tc('sw-settings-logging.list.actionShowInfo') }}\n                    {% endblock %}\n                </sw-context-menu-item>\n                {% endblock %}\n            </template>\n\n        </sw-entity-listing>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_settings_logging_list_content_info_modal %}\n        <component\n            :is=\"modalNameFromLogEntry\"\n            v-if=\"displayedLog !== null\"\n            class=\"sw-settings-logging-list__custom-content\"\n            :log-entry=\"displayedLog\"\n            @close=\"closeInfoModal\"\n        />\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_settings_logging_list_sidebar %}\n    <template #sidebar>\n        <sw-sidebar class=\"sw-settings-logging-list__sidebar\">\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_settings_logging_list_sidebar_refresh %}\n            <sw-sidebar-item\n                icon=\"regular-undo\"\n                :title=\"$tc('sw-settings-logging.list.titleSidebarItemRefresh')\"\n                @click=\"onRefresh\"\n            />\n            {% endblock %}\n        </sw-sidebar>\n    </template>\n    {% endblock %}\n</sw-page>\n{% endblock %}\n","/**\n * @package services-settings\n */\n\nimport './sw-settings-logging-list.scss';\nimport template from './sw-settings-logging-list.html.twig';\n\nconst { Mixin, Component } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: ['repositoryFactory'],\n\n    mixins: [\n        Mixin.getByName('sw-settings-list'),\n        Mixin.getByName('placeholder'),\n    ],\n\n    data() {\n        return {\n            entityName: 'log_entry',\n            sortBy: 'log_entry.createdAt',\n            sortDirection: 'DESC',\n            isLoading: true,\n            logs: [],\n            displayedLog: null,\n            logLevels: {\n                Debug: 100,\n                Info: 200,\n                Notice: 250,\n                Warning: 300,\n                Error: 400,\n                Critical: 500,\n                Alert: 550,\n                Emergency: 600,\n            },\n        };\n    },\n\n    metaInfo() {\n        return {\n            title: this.$createTitle(),\n        };\n    },\n\n    computed: {\n        logEntryRepository() {\n            return this.repositoryFactory.create('log_entry');\n        },\n\n        logColumns() {\n            return this.getLogColumns();\n        },\n\n        modalNameFromLogEntry() {\n            const eventName = this.displayedLog.message;\n            const subComponentName = eventName.replace(/[._]/g, '-');\n\n            if (Component.getComponentRegistry().has(`sw-settings-logging-${subComponentName}-info`)) {\n                return `sw-settings-logging-${subComponentName}-info`;\n            }\n\n            return 'sw-settings-logging-entry-info';\n        },\n\n        dateFilter() {\n            return Cicada.Filter.getByName('date');\n        },\n    },\n\n    methods: {\n        showInfoModal(entryContents) {\n            this.displayedLog = entryContents;\n        },\n\n        closeInfoModal() {\n            this.displayedLog = null;\n        },\n\n        getList() {\n            this.isLoading = true;\n\n            const criteria = new Criteria(this.page, this.limit);\n\n            criteria.setTerm(this.term);\n            criteria.addSorting(Criteria.sort(this.sortBy, this.sortDirection));\n\n            return this.logEntryRepository\n                .search(criteria)\n                .then((response) => {\n                    this.total = response.total;\n                    this.logs = response;\n                    this.isLoading = false;\n\n                    return response;\n                })\n                .catch(() => {\n                    this.isLoading = false;\n                });\n        },\n\n        logLevelToString(level) {\n            const distances = Object.values(this.logLevels).map((x) => {\n                return Math.abs(x - level);\n            });\n\n            const stringLevel = Object.keys(this.logLevels)[\n                distances.findIndex((x) => {\n                    return x === Math.min(...distances);\n                })\n            ];\n\n            return this.$tc(`sw-settings-logging.list.level${stringLevel}`);\n        },\n\n        getLogColumns() {\n            return [\n                {\n                    property: 'createdAt',\n                    dataIndex: 'createdAt',\n                    label: 'sw-settings-logging.list.columnDate',\n                    allowResize: true,\n                    primary: true,\n                },\n                {\n                    property: 'message',\n                    dataIndex: 'message',\n                    label: 'sw-settings-logging.list.columnMessage',\n                    allowResize: true,\n                },\n                {\n                    property: 'level',\n                    dataIndex: 'level',\n                    label: 'sw-settings-logging.list.columnLevel',\n                    allowResize: true,\n                },\n                {\n                    property: 'context',\n                    dataIndex: 'context',\n                    label: 'sw-settings-logging.list.columnContent',\n                    allowResize: true,\n                },\n            ];\n        },\n    },\n};\n"],"names":["template","Mixin","Component","Criteria","index","subComponentName","entryContents","criteria","response","level","distances","x","stringLevel"],"mappings":"AAAA,MAAeA,EAAA,sjGCOT,CAAE,MAAAC,EAAO,UAAAC,CAAW,EAAG,OACvB,CAAE,SAAAC,CAAQ,EAAK,OAAO,KAGbC,EAAA,CACX,SAAAJ,EAEA,aAAc,OAAO,aAErB,OAAQ,CAAC,mBAAmB,EAE5B,OAAQ,CACJC,EAAM,UAAU,kBAAkB,EAClCA,EAAM,UAAU,aAAa,CAChC,EAED,MAAO,CACH,MAAO,CACH,WAAY,YACZ,OAAQ,sBACR,cAAe,OACf,UAAW,GACX,KAAM,CAAE,EACR,aAAc,KACd,UAAW,CACP,MAAO,IACP,KAAM,IACN,OAAQ,IACR,QAAS,IACT,MAAO,IACP,SAAU,IACV,MAAO,IACP,UAAW,GACd,CACb,CACK,EAED,UAAW,CACP,MAAO,CACH,MAAO,KAAK,aAAc,CACtC,CACK,EAED,SAAU,CACN,oBAAqB,CACjB,OAAO,KAAK,kBAAkB,OAAO,WAAW,CACnD,EAED,YAAa,CACT,OAAO,KAAK,eACf,EAED,uBAAwB,CAEpB,MAAMI,EADY,KAAK,aAAa,QACD,QAAQ,QAAS,GAAG,EAEvD,OAAIH,EAAU,qBAAoB,EAAG,IAAI,uBAAuBG,CAAgB,OAAO,EAC5E,uBAAuBA,CAAgB,QAG3C,gCACV,EAED,YAAa,CACT,OAAO,OAAO,OAAO,UAAU,MAAM,CACxC,CACJ,EAED,QAAS,CACL,cAAcC,EAAe,CACzB,KAAK,aAAeA,CACvB,EAED,gBAAiB,CACb,KAAK,aAAe,IACvB,EAED,SAAU,CACN,KAAK,UAAY,GAEjB,MAAMC,EAAW,IAAIJ,EAAS,KAAK,KAAM,KAAK,KAAK,EAEnD,OAAAI,EAAS,QAAQ,KAAK,IAAI,EAC1BA,EAAS,WAAWJ,EAAS,KAAK,KAAK,OAAQ,KAAK,aAAa,CAAC,EAE3D,KAAK,mBACP,OAAOI,CAAQ,EACf,KAAMC,IACH,KAAK,MAAQA,EAAS,MACtB,KAAK,KAAOA,EACZ,KAAK,UAAY,GAEVA,EACV,EACA,MAAM,IAAM,CACT,KAAK,UAAY,EACrC,CAAiB,CACR,EAED,iBAAiBC,EAAO,CACpB,MAAMC,EAAY,OAAO,OAAO,KAAK,SAAS,EAAE,IAAKC,GAC1C,KAAK,IAAIA,EAAIF,CAAK,CAC5B,EAEKG,EAAc,OAAO,KAAK,KAAK,SAAS,EAC1CF,EAAU,UAAWC,GACVA,IAAM,KAAK,IAAI,GAAGD,CAAS,CACrC,CACjB,EAEY,OAAO,KAAK,IAAI,iCAAiCE,CAAW,EAAE,CACjE,EAED,eAAgB,CACZ,MAAO,CACH,CACI,SAAU,YACV,UAAW,YACX,MAAO,sCACP,YAAa,GACb,QAAS,EACZ,EACD,CACI,SAAU,UACV,UAAW,UACX,MAAO,yCACP,YAAa,EAChB,EACD,CACI,SAAU,QACV,UAAW,QACX,MAAO,uCACP,YAAa,EAChB,EACD,CACI,SAAU,UACV,UAAW,UACX,MAAO,yCACP,YAAa,EAChB,CACjB,CACS,CACJ,CACL"}