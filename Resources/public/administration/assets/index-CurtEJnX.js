const l=`{% block sw_import_export_edit_profile_modal %} <div class="sw-import-export-edit-profile-modal"> <sw-modal v-if="show && profile" class="sw-import-export-edit-profile-modal" :title="modalTitle" variant="full" @modal-close="$emit('profile-close')" > {% block sw_import_export_edit_profile_modal_alert %} <sw-alert v-if="profile.systemDefault" variant="info" > {{ $tc('sw-import-export.profile.systemDefaultInfoText') }} </sw-alert> {% endblock %} {% block sw_import_export_edit_profile_modal_tabs %} <sw-tabs position-identifier="sw-import-export-edit-profile-modal" :small="false" default-item="general" > <template #default="{ active }"> {% block sw_import_export_edit_profile_modal_tabs_general %} <sw-tabs-item :title="$tc('sw-import-export.profile.generalTab')" :active-tab="active" name="general" > {{ $tc('sw-import-export.profile.generalTab') }} </sw-tabs-item> {% endblock %} {% block sw_import_export_edit_profile_modal_tabs_field_mappings %} <sw-tabs-item :title="$tc('sw-import-export.profile.mappingsTab')" :active-tab="active" name="mappings" > {{ $tc('sw-import-export.profile.mappingsTab') }} </sw-tabs-item> {% endblock %} {% block sw_import_export_edit_profile_modal_tabs_field_advanced %} <sw-tabs-item v-if="profile.type !== 'export' && profile.config.updateEntities !== false" :title="$tc('sw-import-export.profile.advancedTab')" :active-tab="active" name="advanced" > {{ $tc('sw-import-export.profile.advancedTab') }} </sw-tabs-item> {% endblock %} </template> <template #content="{ active }"> <template v-if="active === 'general'"> <sw-import-export-edit-profile-general :profile="profile" /> <sw-import-export-edit-profile-field-indicators :profile="profile" /> {% block sw_import_export_edit_profile_modal_tabs_general_import_settings %} <sw-import-export-edit-profile-import-settings :profile="profile" /> {% endblock %} </template> <template v-if="active === 'mappings'"> {% block sw_import_export_edit_profile_modal_tabs_mappings %} {% block sw_import_export_edit_profile_modal_tabs_mappings_text %} <p class="sw-import-export-edit-profile-modal__text"> {{ $tc('sw-import-export.profile.mappingDescription') }} </p> {% endblock %} {% block sw_import_export_edit_profile_modal_tabs_mappings_mapping %} <sw-import-export-edit-profile-modal-mapping :profile="profile" :system-required-fields="systemRequiredFields" @update-mapping="updateMapping" /> {% endblock %} {% endblock %} </template> <template v-if="active === 'advanced' && profile.type !== 'export' && profile.config.updateEntities !== false"> {% block sw_import_export_edit_profile_modal_tabs_advanced %} {% block sw_import_export_edit_profile_modal_tabs_advanced_text %} <p class="sw-import-export-edit-profile-modal__text"> {{ $tc('sw-import-export.profile.advancedDescription') }} </p> {% endblock %} {% block sw_import_export_edit_profile_modal_tabs_advanced_identifiers %} <sw-import-export-edit-profile-modal-identifiers :profile="profile" /> {% endblock %} {% endblock %} </template> <template v-if="active === 'fieldIndicators'"> <p class="sw-import-export-edit-profile-modal__text"> {{ $tc('sw-import-export.profile.csvDescriptionBlock') }} </p> </template> </template> </sw-tabs> {% endblock %} {% block sw_import_export_edit_profile_modal_footer %} <template #modal-footer> <sw-button size="small" @click="$emit('profile-close')" > {{ $tc('global.default.cancel') }} </sw-button> <template v-if="profile.systemDefault"> <sw-button class="sw-import-export-edit-profile-modal__save-action" size="small" variant="primary" @click="$emit('profile-close')" > {{ $tc('sw-import-export.profile.closeProfileLabel') }} </sw-button> </template> <template v-else> <sw-button class="sw-import-export-edit-profile-modal__save-action" size="small" :disabled="!profile.sourceEntity || profile.sourceEntity.length <= 0 || !profile.type" variant="primary" @click="saveProfile" > {{ saveLabelSnippet }} </sw-button> </template> </template> {% endblock %} </sw-modal> {% block sw_import_export_edit_profile_violation_modal %} <sw-modal v-if="showValidationError" :title="$tc('global.default.error')" class="sw-import-export-edit-profile-modal__violation-modal" @modal-close="resetViolations" > {% block sw_import_export_edit_profile_violation_modal_message %} <p>{{ $tc('sw-import-export.profile.violationMessage') }}</p> {% endblock %} {% block sw_import_export_edit_profile_violation_modal_required_fields %} <ul> {% block sw_import_export_edit_profile_violation_modal_required_field %} <li v-for="requiredField in missingRequiredFields" :key="requiredField" > {{ requiredField }} </li> {% endblock %} </ul> {% endblock %} {% block sw_import_export_edit_profile_violation_modal_footer %} <template #modal-footer> <sw-button size="small" @click="resetViolations" > {{ $tc('sw-import-export.profile.closeViolation') }} </sw-button> </template> {% endblock %} </sw-modal> {% endblock %} </div> {% endblock %}`,{Mixin:p}=Shopware,{Criteria:i}=Shopware.Data,{mapPropertyErrors:s}=Shopware.Component.getComponentHelper(),a={template:l,inject:["repositoryFactory","feature","importExportProfileMapping","importExportUpdateByMapping"],emits:["profile-close","profile-save"],mixins:[p.getByName("notification")],props:{profile:{type:Object,required:!1,default(){return{}}},show:{type:Boolean,required:!1,default(){return!0}}},data(){return{missingRequiredFields:[],systemRequiredFields:{}}},computed:{...s("profile",["name","sourceEntity","delimiter","enclosure","type"]),isNew(){return!this.profile||!this.profile.isNew?!1:this.profile.isNew()},modalTitle(){return this.isNew?this.$tc("sw-import-export.profile.newProfileLabel"):this.$tc("sw-import-export.profile.editProfileLabel")},saveLabelSnippet(){return this.isNew?this.$tc("sw-import-export.profile.addProfileLabel"):this.$tc("sw-import-export.profile.saveProfileLabel")},showValidationError(){return this.missingRequiredFields.length>0},profileRepository(){return this.repositoryFactory.create("import_export_profile")}},watch:{"profile.sourceEntity":{handler(e){e&&this.loadSystemRequiredFieldsForEntity(e)}},"profile.mapping":{handler(){this.importExportUpdateByMapping.removeUnusedMappings(this.profile)}}},methods:{saveProfile(){this.getParentProfileSelected().then(e=>{this.checkValidation(e),this.missingRequiredFields.length===0&&this.$emit("profile-save")})},updateMapping(e){this.profile.mapping=e},getParentProfileSelected(){const e=new i(1,25);return e.addFilter(i.equals("sourceEntity",this.profile.sourceEntity)),e.addFilter(i.equals("systemDefault",!0)),this.profileRepository.search(e).then(t=>t.total>0?t[0]:null).catch(()=>{this.createNotificationError({message:this.$tc("sw-import-export.profile.messageSearchParentProfileError")})})},checkValidation(e){if(this.profile.type==="export")return;const t=e?e.mapping:[],r=this.profile.config.createEntities===!1&&this.profile.config.updateEntities===!0,o=this.importExportProfileMapping.validate(this.profile.sourceEntity,this.profile.mapping,t,r);o.missingRequiredFields.length>0&&(this.missingRequiredFields=o.missingRequiredFields)},resetViolations(){this.missingRequiredFields=[]},loadSystemRequiredFieldsForEntity(e){this.systemRequiredFields=this.importExportProfileMapping.getSystemRequiredFields(e)}}};export{a as default};
