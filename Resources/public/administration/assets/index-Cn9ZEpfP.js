const m=`{% block sw_settings_user_list %} <sw-card class="sw-users-permissions-user-listing sw-settings-user-list" position-identifier="sw-users-permissions-user-listing" :title="$tc('sw-users-permissions.users.general.cardLabel')" > <div class="sw-users-permissions-user-listing__toolbar"> <sw-container columns="1fr minmax(100px, 200px)" gap="0 10px" > {% block sw_settings_user_list_smart_bar_actions %} {% block sw_settings_user_list_search_bar %} <sw-simple-search-field v-model:value="term" size="small" variant="form" @search-term-change="onSearch" /> {% endblock %} {% block sw_settings_user_list_actions_create_user %} <sw-button :router-link="{ name: 'sw.users.permissions.user.create' }" variant="ghost" size="small" :disabled="!acl.can('users_and_permissions.creator') || undefined" class="sw-users-permissions-user-listing__add-user-button" > {{ $tc('sw-users-permissions.users.general.labelCreateNewUser') }} </sw-button> {% endblock %} {% endblock %} </sw-container> </div> {% block sw_settings_user_list_content %} {% block sw_settings_user_list_content_grid %} <sw-data-grid :data-source="user" :columns="userColumns" identifier="user-grid" :show-settings="true" :show-selection="false" :is-loading="isLoading" @column-sort="onSortColumn" > {% block sw_settings_user_list_content_grid_actions %} <template #actions="{ item }"> {% block sw_settings_user_list_actions_edit %} <sw-context-menu-item class="sw-settings-user-list__user-view-action" :disabled="!acl.can('users_and_permissions.editor') || undefined" :router-link="{ name: 'sw.users.permissions.user.detail', params: { id: item.id } }" > {{ $tc('sw-users-permissions.users.user-grid.contextMenuEdit') }} </sw-context-menu-item> {% endblock %} {% block sw_settings_user_list_actions_delete %} <sw-context-menu-item class="sw-settings-user-list__user-delete-action" variant="danger" :disabled="!acl.can('users_and_permissions.deleter') || undefined" @click="onDelete(item)" > {{ $tc('sw-users-permissions.users.user-grid.contextMenuDelete') }} </sw-context-menu-item> {% endblock %} </template> {% endblock %} {% block sw_settings_user_list_column_username_preview %} <template #preview-username="{ item, compact }"> <sw-avatar :size="compact ? '32px' : '48px'" :name="item.name" variant="square" :source-context="item" /> </template> {% endblock %} {% block sw_settings_user_list_column_username %} <template #column-username="{ item }"> {% block sw_settings_user_list_column_username_content %} <router-link class="sw-settings-user-list__columns" :to="{ name: 'sw.users.permissions.user.detail', params: { id: item.id } }" > {{ item.username }} </router-link> {% endblock %} </template> {% endblock %} {% block sw_settings_user_list_column_username_acl_roles %} <template #column-aclRoles="{ item, compact }"> <template v-if="item.aclRoles && item.aclRoles.length > 0"> <span v-for="(role, index) in item.aclRoles" :key="index" > {{ role.name }}<template v-if="index + 1 < item.aclRoles.length">,&nbsp;</template> </span> </template> <span v-else-if="item.admin"> {{ $tc('sw-users-permissions.users.user-detail.labelAdministrator') }} </span> <span v-else></span> </template> {% endblock %} <template #pagination> {% block sw_settings_user_list_grid_pagination %} <sw-pagination :page="page" :limit="limit" :total="total" :auto-hide="true" @page-change="onPageChange" /> {% endblock %} </template> <template #action-modals="{ item }"> {% block sw_settings_user_list_delete_modal %} <sw-modal v-if="getItemToDelete(item)" :title="$tc('global.default.warning')" variant="small" @modal-close="onCloseDeleteModal" > {% block sw_settings_user_list_delete_modal_confirm_delete_text %} <p class="sw-settings-user-list__confirm-delete-text"> {{ $tc('sw-users-permissions.users.user-grid.textModalDelete', 0, { name: salutation(item) }) }} </p> {% endblock %} {% block sw_settings_user_list_delete_modal_input__confirm_password %} <sw-password-field v-model:value="confirmPassword" class="sw-settings-user-detail__confirm-password" required name="sw-field--confirm-password" :password-toggle-able="true" :label="$tc('sw-users-permissions.users.user-detail.passwordConfirmation.labelConfirmPassword')" :placeholder="$tc('sw-users-permissions.users.user-detail.passwordConfirmation.placeholderConfirmPassword')" autocomplete="off" @keypress.enter="onConfirmDelete(item)" /> {% endblock %} {% block sw_settings_user_list_delete_modal_footer %} <template #modal-footer> {% block sw_settings_user_list_delete_modal_cancel %} <sw-button size="small" @click="onCloseDeleteModal" > {{ $tc('global.default.cancel') }} </sw-button> {% endblock %} {% block sw_settings_user_list_delete_modal_confirm %} <sw-button :disabled="!confirmPassword || undefined" :is-loading="isConfirmingPassword" variant="danger" size="small" @click="onConfirmDelete(item)" > {{ $tc('sw-users-permissions.users.user-grid.labelButtonDelete') }} </sw-button> {% endblock %} </template> {% endblock %} </sw-modal> {% endblock %} </template> </sw-data-grid> {% endblock %} {% endblock %} </sw-card> {% endblock %}`,{Data:u,Mixin:t,State:d}=Cicada,{Criteria:o}=u,g={template:m,compatConfig:Cicada.compatConfig,inject:["userService","loginService","repositoryFactory","acl"],emits:["get-list"],mixins:[t.getByName("listing"),t.getByName("notification"),t.getByName("salutation")],data(){return{user:[],isLoading:!1,itemToDelete:null,disableRouteParams:!0,confirmPassword:"",sortBy:"username",isConfirmingPassword:!1}},metaInfo(){return{title:this.$createTitle()}},computed:{userRepository(){return this.repositoryFactory.create("user")},currentUser:{get(){return d.get("session").currentUser}},userCriteria(){const e=new o(this.page,this.limit);return this.term&&e.setTerm(this.term),this.sortBy&&e.addSorting(o.sort(this.sortBy,this.sortDirection||"ASC")),e.addAssociation("aclRoles"),e.addAssociation("avatarMedia"),e},userColumns(){return[{property:"username",label:this.$tc("sw-users-permissions.users.user-grid.labelUsername")},{property:"name",label:this.$tc("sw-users-permissions.users.user-grid.labelName")},{property:"phone",label:this.$tc("sw-users-permissions.users.user-grid.labelPhone")},{property:"aclRoles",sortable:!1,label:this.$tc("sw-users-permissions.users.user-grid.labelRoles")},{property:"email",label:this.$tc("sw-users-permissions.users.user-grid.labelEmail")}]}},methods:{getItemToDelete(e){return this.itemToDelete?this.itemToDelete.id===e.id:!1},onSearch(e){this.term=e,this.getList()},getList(){return this.isLoading=!0,this.user=[],this.$emit("get-list"),this.userRepository.search(this.userCriteria).then(e=>{this.total=e.total,this.user=e}).finally(()=>{this.isLoading=!1})},onDelete(e){this.itemToDelete=e},async onConfirmDelete(e){const i=`${e.name}`,a=this.$tc("global.default.success"),n=this.$tc("sw-users-permissions.users.user-grid.notification.deleteSuccess.message",0,{name:i}),l=this.$tc("global.default.error"),c=this.$tc("sw-users-permissions.users.user-grid.notification.deleteError.message",0,{name:i});if(e.id===this.currentUser.id){this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("sw-users-permissions.users.user-grid.notification.deleteUserLoggedInError.message")});return}let s;try{this.isConfirmingPassword=!0,s=await this.loginService.verifyUserToken(this.confirmPassword)}catch{this.createNotificationError({title:this.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorTitle"),message:this.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorMessage")})}finally{this.confirmPassword="",this.isConfirmingPassword=!1}if(!s)return;this.confirmPasswordModal=!1;const r={...Cicada.Context.api};r.authToken.access=s,this.userRepository.delete(e.id,r).then(()=>{this.createNotificationSuccess({title:a,message:n}),this.getList()}).catch(()=>{this.createNotificationError({title:l,message:c})}),this.onCloseDeleteModal()},onCloseDeleteModal(){this.itemToDelete=null}}};export{g as default};
//# sourceMappingURL=index-Cn9ZEpfP.js.map
