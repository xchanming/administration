{"version":3,"file":"index-CoSjA14n.js","sources":["../../../app/administration/src/module/sw-product/component/sw-product-cross-selling-form/sw-product-cross-selling-form.html.twig","../../../app/administration/src/module/sw-product/component/sw-product-cross-selling-form/index.js"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_product_cross_selling_form %}\n<div class=\"product-detail-cross-selling-form\">\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_prduct_cross_selling_form_card %}\n    <sw-card\n        :title=\"crossSelling.name\"\n        position-identifier=\"sw-product-cross-selling-form\"\n    >\n        <div\n            v-if=\"!isLoading && crossSelling\"\n            class=\"product-detail-cross-selling-form__card-container\"\n        >\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_prduct_cross_selling_form_context_menu %}\n            <div class=\"sw-product-detail-cross-selling__context-button\">\n                <sw-context-button>\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_product_cross_selling_form_context_button_delete %}\n                    <sw-context-menu-item\n                        variant=\"danger\"\n                        class=\"sw-product-cross_selling-context-item__delete-action\"\n                        :disabled=\"!allowEdit\"\n                        @click=\"onShowDeleteModal\"\n                    >\n                        {{ $tc('sw-product.crossselling.buttonDeleteCrossSelling') }}\n                    </sw-context-menu-item>\n                    {% endblock %}\n                </sw-context-button>\n            </div>\n            {% endblock %}\n\n            <sw-container\n                columns=\"2fr 1fr\"\n                gap=\"0px 30px\"\n                align=\"start\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_title_field %}\n                <sw-text-field\n                    v-model:value=\"crossSelling.name\"\n                    name=\"sw-field--crossSelling-name\"\n                    :label=\"$tc('sw-product.crossselling.inputCrossSellingTitle')\"\n                    required\n                    :placeholder=\"placeholder(crossSelling, 'name', $tc('sw-product.crossselling.inputCrossSellingTitlePlaceholder'))\"\n                    :error=\"crossSellingNameError\"\n                    :disabled=\"!allowEdit\"\n                />\n                {% endblock %}\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_active_field %}\n                <sw-switch-field\n                    v-model:value=\"crossSelling.active\"\n                    class=\"sw-product-detail-cross-selling__active-switch\"\n                    :label=\"$tc('sw-product.crossselling.inputCrossSellingActive')\"\n                    :disabled=\"!allowEdit\"\n                    name=\"sw-field--crossSelling-active\"\n                />\n                {% endblock %}\n            </sw-container>\n\n            <sw-container\n                columns=\"2fr 1fr\"\n                gap=\"0px 30px\"\n            >\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_type %}\n                <sw-select-field\n                    v-model:value=\"crossSelling.type\"\n                    :label=\"$tc('sw-product.crossselling.inputCrossSellingType')\"\n                    :error=\"crossSellingTypeError\"\n                    :disabled=\"!allowEdit\"\n                    @update:value=\"onTypeChanged\"\n                >\n                    <option\n                        v-for=\"option in crossSellingTypes\"\n                        :key=\"option.value\"\n                        :value=\"option.value\"\n                    >\n                        {{ option.label }}\n                    </option>\n                </sw-select-field>\n                {% endblock %}\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_position_field %}\n                <sw-number-field\n                    v-model:value=\"crossSelling.position\"\n                    number-type=\"int\"\n                    :min=\"1\"\n                    :label=\"$tc('sw-product.crossselling.inputCrossSellingPosition')\"\n                    :error=\"crossSellingPositionError\"\n                    :placeholder=\"$tc('sw-product.crossselling.inputCrossSellingPositionPlaceholder')\"\n                    :disabled=\"!allowEdit\"\n                />\n                {% endblock %}\n            </sw-container>\n\n            <div v-if=\"!useManualAssignment\">\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_product_stream_field %}\n                <sw-entity-single-select\n                    id=\"sw-field--crossSelling-product-group\"\n                    v-model:value=\"crossSelling.productStreamId\"\n                    entity=\"product_stream\"\n                    class=\"sw-select-cross-selling__select-product-stream\"\n                    :label=\"$tc('sw-product.crossselling.inputCrossSellingProductStream')\"\n                    :placeholder=\"$tc('sw-product.crossselling.inputCrossSellingProductStreamPlaceholder')\"\n                    :disabled=\"!allowEdit\"\n                    show-clearable-button\n                />\n                {% endblock %}\n\n                <sw-container\n                    columns=\"1fr 1fr\"\n                    gap=\"0px 30px\"\n                >\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_prduct_cross_selling_form_sort_field %}\n                    <sw-select-field\n                        :label=\"$tc('sw-product.crossselling.inputCrossSellingSorting')\"\n                        :value=\"sortingConCat\"\n                        :disabled=\"!allowEdit\"\n                        @update:value=\"onSortingChanged\"\n                    >\n                        <option\n                            v-for=\"option in sortingTypes\"\n                            :key=\"option.value\"\n                            :value=\"option.value\"\n                        >\n                            {{ option.label }}\n                        </option>\n                    </sw-select-field>\n                    {% endblock %}\n\n                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                    {% block sw_prduct_cross_selling_form_limit_field %}\n                    <sw-number-field\n                        v-model:value=\"crossSelling.limit\"\n                        number-type=\"int\"\n                        :label=\"$tc('sw-product.crossselling.inputCrossSellingLimit')\"\n                        :disabled=\"!allowEdit\"\n                    />\n                    {% endblock %}\n                </sw-container>\n\n                <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n                {% block sw_prduct_cross_selling_form_preview_link %}\n                <sw-container\n                    columns=\"1fr\"\n                    justify=\"end\"\n                    class=\"sw-product-cross-selling-form__links\"\n                >\n                    <a\n                        class=\"sw-card__quick-link\"\n                        :class=\"{ 'is--disabled': previewDisabled }\"\n                        role=\"button\"\n                        tabindex=\"0\"\n                        @click=\"openModalPreview\"\n                        @keydown.enter=\"openModalPreview\"\n                    >\n                        {{ $tc('sw-product.crossselling.linkOpenStreamPreview') }}\n                        <sw-icon\n                            name=\"regular-long-arrow-right\"\n                            small\n                        />\n                    </a>\n                </sw-container>\n                {% endblock %}\n            </div>\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_cross_selling_assignment %}\n            <sw-product-cross-selling-assignment\n                v-else\n                :assigned-products=\"crossSelling.assignedProducts\"\n                :cross-selling-id=\"crossSelling.id\"\n                :searchable-fields=\"['name', 'productNumber']\"\n                :allow-edit=\"allowEdit\"\n            />\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_cross_selling_modal_preview_modal %}\n            <sw-product-stream-modal-preview\n                v-if=\"showModalPreview\"\n                ref=\"modalPreview\"\n                :filters=\"productStreamFilterTree\"\n                @modal-close=\"closeModalPreview\"\n            />\n            {% endblock %}\n        </div>\n    </sw-card>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_detail_cross_selling_form_modal_delete %}\n    <sw-modal\n        v-if=\"showDeleteModal\"\n        variant=\"small\"\n        :title=\"$tc('sw-product.crossselling.deleteConfirmTitle')\"\n        class=\"sw-product-detail-cross-selling__delete-modal\"\n        @modal-close=\"onCloseDeleteModal\"\n    >\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_detail_cross_selling_form_delete_text %}\n        <p>\n            {{ $tc('sw-product.crossselling.deleteConfirmText') }}\n        </p>\n        {% endblock %}\n\n        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n        {% block sw_product_detail_cross_selling_form_modal_delete_footer %}\n        <template #modal-footer>\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_cross_selling_modal_delete_action_cancel %}\n            <sw-button\n                size=\"small\"\n                @click=\"onCloseDeleteModal\"\n            >\n                {{ $tc('global.default.cancel') }}\n            </sw-button>\n            {% endblock %}\n\n            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n            {% block sw_product_detail_cross_selling_form_modal_delete_action_delete %}\n            <sw-button\n                class=\"sw-product-detail-cross-selling__delete-button\"\n                size=\"small\"\n                variant=\"danger\"\n                @click=\"onConfirmDelete\"\n            >\n                {{ $tc('sw-product.crossselling.deleteButtonDelete') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n\n    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n    {% block sw_product_cross_selling_form_condition_tree_invisibly %}\n    <sw-condition-tree\n        v-if=\"productStreamFilterRepository\"\n        v-show=\"false\"\n        association-field=\"productStreamId\"\n        child-association-field=\"queries\"\n        :initial-conditions=\"productStreamFilter\"\n        :condition-repository=\"productStreamFilterRepository\"\n        :condition-data-provider-service=\"productStreamConditionService\"\n        :association-value=\"associationValue\"\n        :root-condition=\"null\"\n        @conditions-changed=\"updateProductStreamFilterTree\"\n    />\n    {% endblock %}\n</div>\n{% endblock %}\n","import template from './sw-product-cross-selling-form.html.twig';\nimport './sw-product-cross-selling-form.scss';\n\nconst { Criteria } = Cicada.Data;\nconst { Component, Mixin } = Cicada;\nconst { mapPropertyErrors, mapGetters, mapState } = Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'productStreamConditionService',\n    ],\n\n    provide() {\n        return {\n            productCustomFields: {},\n        };\n    },\n\n    mixins: [\n        Mixin.getByName('placeholder'),\n    ],\n\n    props: {\n        crossSelling: {\n            type: Object,\n            required: true,\n        },\n\n        allowEdit: {\n            type: Boolean,\n            required: false,\n            // eslint-disable-next-line vue/no-boolean-default\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            showDeleteModal: false,\n            showModalPreview: false,\n            productStream: null,\n            productStreamFilter: [],\n            productStreamFilterTree: null,\n            optionSearchTerm: '',\n            useManualAssignment: false,\n            sortBy: 'name',\n            sortDirection: 'ASC',\n            assignmentKey: 0,\n        };\n    },\n\n    computed: {\n        ...mapPropertyErrors('crossSelling', [\n            'name',\n            'type',\n            'position',\n        ]),\n\n        ...mapState('swProductDetail', [\n            'product',\n        ]),\n\n        ...mapGetters('swProductDetail', [\n            'isLoading',\n        ]),\n\n        productCrossSellingRepository() {\n            return this.repositoryFactory.create('product_cross_selling');\n        },\n\n        productStreamRepository() {\n            return this.repositoryFactory.create('product_stream');\n        },\n\n        productStreamFilterRepository() {\n            if (!this.productStream || !this.productStream.filters) {\n                return null;\n            }\n\n            const { entity, source } = this.productStream.filters;\n\n            return this.repositoryFactory.create(entity, source);\n        },\n\n        productStreamFilterCriteria() {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addFilter(Criteria.equals('productStreamId', this.crossSelling.productStreamId));\n\n            return criteria;\n        },\n\n        crossSellingAssigmentRepository() {\n            return this.repositoryFactory.create('product_cross_selling_assigned_products');\n        },\n\n        sortingTypes() {\n            return [\n                {\n                    label: this.$tc('sw-product.crossselling.priceDescendingSortingType'),\n                    value: 'cheapestPrice:DESC',\n                },\n                {\n                    label: this.$tc('sw-product.crossselling.priceAscendingSortingType'),\n                    value: 'cheapestPrice:ASC',\n                },\n                {\n                    label: this.$tc('sw-product.crossselling.nameSortingType'),\n                    value: 'name:ASC',\n                },\n                {\n                    label: this.$tc('sw-product.crossselling.releaseDateDescendingSortingType'),\n                    value: 'releaseDate:DESC',\n                },\n                {\n                    label: this.$tc('sw-product.crossselling.releaseDateAscendingSortingType'),\n                    value: 'releaseDate:ASC',\n                },\n            ];\n        },\n\n        crossSellingTypes() {\n            return [\n                {\n                    label: this.$tc('sw-product.crossselling.productStreamType'),\n                    value: 'productStream',\n                },\n                {\n                    label: this.$tc('sw-product.crossselling.productListType'),\n                    value: 'productList',\n                },\n            ];\n        },\n\n        previewDisabled() {\n            return !this.productStream;\n        },\n\n        sortingConCat() {\n            return `${this.crossSelling.sortBy}:${this.crossSelling.sortDirection}`;\n        },\n\n        disablePositioning() {\n            return !!this.term || this.sortBy !== 'position';\n        },\n\n        associationValue() {\n            return this.crossSelling?.productStreamId || '';\n        },\n    },\n\n    watch: {\n        'crossSelling.productStreamId'() {\n            if (!this.useManualAssignment) {\n                this.loadStreamPreview();\n            }\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.useManualAssignment = this.crossSelling.type === 'productList';\n            if (!this.useManualAssignment && this.crossSelling.productStreamId !== null) {\n                this.loadStreamPreview();\n            }\n        },\n\n        onShowDeleteModal() {\n            this.showDeleteModal = true;\n        },\n\n        onCloseDeleteModal() {\n            this.showDeleteModal = false;\n        },\n\n        onConfirmDelete() {\n            this.onCloseDeleteModal();\n            this.$nextTick(() => {\n                this.product.crossSellings.remove(this.crossSelling.id);\n            });\n        },\n\n        openModalPreview() {\n            if (this.previewDisabled) {\n                return;\n            }\n\n            this.showModalPreview = true;\n        },\n\n        closeModalPreview() {\n            this.showModalPreview = false;\n        },\n\n        loadStreamPreview() {\n            this.productStreamRepository.get(this.crossSelling.productStreamId).then((productStream) => {\n                this.productStream = productStream;\n                this.getProductStreamFilter();\n            });\n        },\n\n        getProductStreamFilter() {\n            if (this.productStreamFilterRepository === null) {\n                return [];\n            }\n            return this.productStreamFilterRepository\n                .search(this.productStreamFilterCriteria)\n                .then((productStreamFilter) => {\n                    this.productStreamFilter = productStreamFilter;\n                });\n        },\n\n        updateProductStreamFilterTree({ conditions }) {\n            this.productStreamFilterTree = conditions;\n        },\n\n        onSortingChanged(value) {\n            [\n                this.crossSelling.sortBy,\n                this.crossSelling.sortDirection,\n            ] = value.split(':');\n        },\n\n        onTypeChanged(value) {\n            this.useManualAssignment = value === 'productList';\n        },\n    },\n};\n"],"names":["template","Criteria","Component","Mixin","mapPropertyErrors","mapGetters","mapState","index","entity","source","criteria","_a","productStream","productStreamFilter","conditions","value"],"mappings":"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"}