const s=`{% block sw_import_export_new_profile_wizard_csv_page %} <div class="sw-import-export-new-profile-wizard-csv-page"> {% block sw_import_export_new_profile_wizard_csv_page_text %} <p class="sw-import-export-new-profile-wizard-csv-page__text"> {{ $tc('sw-import-export.profile.csvUploadText') }} </p> {% endblock %} {% block sw_import_export_new_profile_wizard_csv_page_csv_upload %} <sw-file-input v-model:value="csvFile" :allowed-mime-types="['text/csv']" class="sw-import-export-new-profile-wizard-csv-page__file-upload" @update:value="onFileChange" > <template #caption-label> {{ $tc('sw-import-export.importer.labelUploadCaption') }} </template> </sw-file-input> {% endblock %} </div> {% endblock %}`,{Mixin:a}=Shopware,n={template:s,inject:["repositoryFactory","importExport"],emits:["next-disable","next-allow"],mixins:[a.getByName("notification")],props:{profile:{type:Object,required:!0}},data(){return{csvFile:null}},created(){this.createdComponent()},methods:{createdComponent(){this.$emit("next-disable")},onFileChange(){return this.csvFile===null?(this.profile.mapping=[],this.$emit("next-disable"),Promise.resolve()):this.importExport.getMappingFromTemplate(this.csvFile,this.profile.sourceEntity,this.profile.delimiter,this.profile.enclosure).then(t=>{const e=this.transformMapping(t);this.profile.mapping=e,this.$emit("next-allow"),e.length===1&&this.createNotificationWarning({message:this.$tc("sw-import-export.profile.messageCsvTemplateUploadWarning"),duration:1e4})}).catch(t=>{var i,r,o,p;this.profile.mapping=[],this.$emit("next-disable");let e=this.$tc("sw-import-export.profile.messageCsvTemplateUploadError");((p=(o=(r=(i=t.response)==null?void 0:i.data)==null?void 0:r.errors)==null?void 0:o[0])==null?void 0:p.code)==="CONTENT__IMPORT_EXPORT_FILE_EMPTY"&&(e=this.$tc("sw-import-export.profile.messageCsvTemplateUploadEmptyError")),this.createNotificationError({message:e})})},transformMapping(t){return t.map(e=>({key:e.key,mappedKey:e.mappedKey}))}}};export{n as default};
