{"version":3,"file":"index-CFqhdzGe.js","sources":["../../../app/administration/src/module/sw-settings-tax/page/sw-settings-tax-provider-detail/sw-settings-tax-provider-detail.html.twig","../../../app/administration/src/module/sw-settings-tax/page/sw-settings-tax-provider-detail/index.ts"],"sourcesContent":["<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->\n{% block sw_settings_tax_provider %}\n<sw-page class=\"sw-settings-tax-tax-provider-detail\">\n    <template #smart-bar-header>\n        <h2 v-if=\"label\">\n            {{ label }}\n        </h2>\n        <h2 v-else>\n            {{ $tc('sw-settings-tax.taxProviderDetail.textHeadline') }}\n        </h2>\n    </template>\n\n    <template #smart-bar-actions>\n        <sw-button\n            v-tooltip.bottom=\"{ message: 'ESC', appearance: 'light' }\"\n            :disabled=\"isLoading\"\n            @click=\"onCancel\"\n        >\n            {{ $tc('global.default.cancel') }}\n        </sw-button>\n\n        <sw-button-process\n            v-model:processSuccess=\"isSaveSuccessful\"\n            class=\"sw-settings-tax-tax-provider-detail__save-action\"\n            variant=\"primary\"\n            :is-loading=\"isLoading\"\n            :disabled=\"isLoading || !allowSave || undefined\"\n            @click.prevent=\"onSave\"\n        >\n            {{ $tc('global.default.save') }}\n        </sw-button-process>\n    </template>\n\n    <template #content>\n        <sw-card-view>\n            <template v-if=\"isLoading\">\n                <sw-skeleton />\n                <sw-skeleton />\n            </template>\n\n            <template v-else>\n                <sw-alert\n                    class=\"sw-settings-tax-tax-provider-detail-info\"\n                    :title=\"$tc('sw-settings-tax.taxProviderDetail.infoTitle')\"\n                    variant=\"info\"\n                >\n                    {{ $tc('sw-settings-tax.taxProviderDetail.infoText') }}\n                </sw-alert>\n\n                <sw-card\n                    position-identifier=\"sw-settings-tax-tax-provider-detail-settings\"\n                    :title=\"$tc('sw-settings-tax.taxProviderDetail.cardTitleSettings')\"\n                    :is-loading=\"isLoading\"\n                >\n                    <sw-container\n                        columns=\"5fr 1fr\"\n                        gap=\"0px 30px\"\n                    >\n                        <sw-number-field\n                            v-model:value=\"taxProvider.priority\"\n                            class=\"sw-settings-tax-tax-provider-detail__field-priority\"\n                            :disabled=\"true\"\n                            :label=\"$tc('sw-settings-tax.taxProviderDetail.labelPriority')\"\n                        />\n\n                        <sw-switch-field\n                            v-model:value=\"taxProvider.active\"\n                            class=\"sw-settings-tax-tax-provider-detail__field-active\"\n                            :disabled=\"!acl.can('tax.editor') || undefined\"\n                            :label=\"$tc('sw-settings-tax.taxProviderDetail.labelActive')\"\n                        />\n                    </sw-container>\n                </sw-card>\n\n                <sw-card\n                    position-identifier=\"sw-settings-tax-tax-provider-detail-availability\"\n                    :title=\"$tc('sw-settings-tax.taxProviderDetail.cardTitleAvailability')\"\n                    :is-loading=\"isLoading\"\n                >\n                    <sw-select-rule-create\n                        v-if=\"!isLoading\"\n                        class=\"sw-settings-tax-tax-provider-detail__field-availability-rule\"\n                        :disabled=\"!acl.can('tax.editor') || undefined\"\n                        :rule-id=\"taxProvider.availabilityRuleId\"\n                        :rule-filter=\"ruleFilter\"\n                        :placeholder=\"$tc('sw-settings-tax.taxProviderDetail.placeholderAvailabilityRule')\"\n                        rule-aware-group-key=\"taxProvider\"\n                        @save-rule=\"onSaveRule\"\n                        @dismiss-rule=\"onDismissRule\"\n                    />\n                </sw-card>\n\n                <sw-extension-component-section\n                    v-if=\"hasIdentifier\"\n                    :position-identifier=\"positionIdentifier\"\n                />\n            </template>\n        </sw-card-view>\n    </template>\n</sw-page>\n{% endblock %}\n","import type { Entity } from '@cicada-ag/meteor-admin-sdk/es/_internals/data/Entity';\nimport type Repository from 'src/core/data/repository.data';\nimport type CriteriaType from 'src/core/data/criteria.data';\nimport template from './sw-settings-tax-provider-detail.html.twig';\nimport './sw-settings-tax-provider-detail.scss';\n\nconst { Component, Mixin } = Cicada;\nconst { Criteria } = Cicada.Data;\n\n/**\n * @package checkout\n *\n * @private\n */\nexport default Component.wrapComponentConfig({\n    template,\n\n    compatConfig: Cicada.compatConfig,\n\n    inject: [\n        'repositoryFactory',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        taxProviderId: {\n            type: String,\n            required: false,\n            default: '',\n        },\n    },\n\n    data(): {\n        isLoading: boolean;\n        isSaveSuccessful: boolean;\n        taxProvider?: Entity<'tax_provider'> | undefined;\n    } {\n        return {\n            taxProvider: undefined,\n            isLoading: false,\n            isSaveSuccessful: false,\n        };\n    },\n\n    metaInfo() {\n        return {\n            title: this.$createTitle(),\n        };\n    },\n\n    computed: {\n        label(): string {\n            return this.taxProvider?.translated?.name || '';\n        },\n\n        taxProviderRepository(): Repository<'tax_provider'> {\n            return this.repositoryFactory.create('tax_provider');\n        },\n\n        allowSave(): boolean {\n            return this.acl.can('tax.editor');\n        },\n\n        ruleFilter(): CriteriaType {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addFilter(\n                Criteria.multi('OR', [\n                    Criteria.contains('rule.moduleTypes.types', 'tax_provider'),\n                    Criteria.equals('rule.moduleTypes', null),\n                ]),\n            );\n\n            criteria.addSorting(Criteria.sort('name', 'ASC', false));\n\n            return criteria;\n        },\n\n        hasIdentifier(): boolean {\n            return !!this.taxProvider?.identifier;\n        },\n\n        positionIdentifier(): string | undefined {\n            if (!this.hasIdentifier) {\n                return '';\n            }\n\n            const identifier = this.taxProvider?.identifier || '';\n\n            return `sw-settings-tax-tax-provider-detail-custom-${identifier}`;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent(): void {\n            void this.loadTaxProvider();\n        },\n\n        loadTaxProvider(): Promise<void> {\n            this.isLoading = true;\n\n            if (this.taxProviderId) {\n                return this.taxProviderRepository.get(this.taxProviderId).then((taxProvider) => {\n                    this.taxProvider = taxProvider as Entity<'tax_provider'>;\n                    this.isLoading = false;\n                });\n            }\n\n            this.isLoading = false;\n\n            return Promise.resolve();\n        },\n\n        onSave(): Promise<void> {\n            this.isSaveSuccessful = false;\n            this.isLoading = true;\n\n            if (!this.taxProvider) {\n                return Promise.resolve();\n            }\n\n            return this.taxProviderRepository\n                .save(this.taxProvider)\n                .then(() => {\n                    this.isSaveSuccessful = true;\n\n                    return this.loadTaxProvider();\n                })\n                .catch(() => {\n                    // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n                    this.createNotificationError({\n                        message: this.$tc('sw-settings-tax.detail.messageSaveError'),\n                    });\n\n                    this.isLoading = false;\n                });\n        },\n\n        onCancel(): void {\n            void this.$router.push({ name: 'sw.settings.tax.index' });\n        },\n\n        onSaveRule(ruleId: string): void {\n            if (!this.taxProvider) {\n                return;\n            }\n\n            this.taxProvider.availabilityRuleId = ruleId;\n        },\n\n        onDismissRule(): void {\n            if (!this.taxProvider) {\n                return;\n            }\n\n            this.taxProvider.availabilityRuleId = undefined;\n        },\n    },\n});\n"],"names":["template","Component","Mixin","Criteria","index","_a","_b","criteria","taxProvider","ruleId"],"mappings":"AAAA,MAAeA,EAAA,07ECMT,CAAE,UAAAC,EAAW,MAAAC,CAAU,EAAA,OACvB,CAAE,SAAAC,CAAS,EAAI,OAAO,KAObC,EAAAH,EAAU,oBAAoB,CACzC,SAAAD,EAEA,aAAc,OAAO,aAErB,OAAQ,CACJ,oBACA,KACJ,EAEA,OAAQ,CACJE,EAAM,UAAU,cAAc,CAClC,EAEA,MAAO,CACH,cAAe,CACX,KAAM,OACN,SAAU,GACV,QAAS,EACb,CACJ,EAEA,MAIE,CACS,MAAA,CACH,YAAa,OACb,UAAW,GACX,iBAAkB,EAAA,CAE1B,EAEA,UAAW,CACA,MAAA,CACH,MAAO,KAAK,aAAa,CAAA,CAEjC,EAEA,SAAU,CACN,OAAgB,CDvDxB,IAAAG,EAAAC,ECwDmB,QAAAA,GAAAD,EAAA,KAAK,cAAL,YAAAA,EAAkB,aAAlB,YAAAC,EAA8B,OAAQ,EACjD,EAEA,uBAAoD,CACzC,OAAA,KAAK,kBAAkB,OAAO,cAAc,CACvD,EAEA,WAAqB,CACV,OAAA,KAAK,IAAI,IAAI,YAAY,CACpC,EAEA,YAA2B,CACvB,MAAMC,EAAW,IAAIJ,EAAS,EAAG,EAAE,EAE1B,OAAAI,EAAA,UACLJ,EAAS,MAAM,KAAM,CACjBA,EAAS,SAAS,yBAA0B,cAAc,EAC1DA,EAAS,OAAO,mBAAoB,IAAI,CAAA,CAC3C,CAAA,EAGLI,EAAS,WAAWJ,EAAS,KAAK,OAAQ,MAAO,EAAK,CAAC,EAEhDI,CACX,EAEA,eAAyB,CDlFjC,IAAAF,ECmFmB,MAAA,CAAC,GAACA,EAAA,KAAK,cAAL,MAAAA,EAAkB,WAC/B,EAEA,oBAAyC,CDtFjD,IAAAA,ECuFgB,OAAC,KAAK,cAMH,gDAFYA,EAAA,KAAK,cAAL,YAAAA,EAAkB,aAAc,EAEY,GALpD,EAMf,CACJ,EAEA,SAAU,CACN,KAAK,iBAAiB,CAC1B,EAEA,QAAS,CACL,kBAAyB,CAChB,KAAK,iBACd,EAEA,iBAAiC,CAG7B,OAFA,KAAK,UAAY,GAEb,KAAK,cACE,KAAK,sBAAsB,IAAI,KAAK,aAAa,EAAE,KAAMG,GAAgB,CAC5E,KAAK,YAAcA,EACnB,KAAK,UAAY,EAAA,CACpB,GAGL,KAAK,UAAY,GAEV,QAAQ,UACnB,EAEA,QAAwB,CAIhB,OAHJ,KAAK,iBAAmB,GACxB,KAAK,UAAY,GAEZ,KAAK,YAIH,KAAK,sBACP,KAAK,KAAK,WAAW,EACrB,KAAK,KACF,KAAK,iBAAmB,GAEjB,KAAK,kBACf,EACA,MAAM,IAAM,CAET,KAAK,wBAAwB,CACzB,QAAS,KAAK,IAAI,yCAAyC,CAAA,CAC9D,EAED,KAAK,UAAY,EAAA,CACpB,EAjBM,QAAQ,SAkBvB,EAEA,UAAiB,CACR,KAAK,QAAQ,KAAK,CAAE,KAAM,wBAAyB,CAC5D,EAEA,WAAWC,EAAsB,CACxB,KAAK,cAIV,KAAK,YAAY,mBAAqBA,EAC1C,EAEA,eAAsB,CACb,KAAK,cAIV,KAAK,YAAY,mBAAqB,OAC1C,CACJ,CACJ,CAAC"}